{
  "exitcode": 1,
  "summary": {
    "passed": 20,
    "failed": 1,
    "total": 21,
    "collected": 21
  },
  "collectors": [
    {
      "nodeid": "",
      "outcome": "passed",
      "result": [
        {
          "nodeid": ".",
          "type": "Dir"
        }
      ]
    },
    {
      "nodeid": "kling",
      "outcome": "passed",
      "result": []
    },
    {
      "nodeid": "kling_creator.egg-info",
      "outcome": "passed",
      "result": []
    },
    {
      "nodeid": "tests/test_kling.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "tests/test_kling.py::test_base_gen_init",
          "type": "Function",
          "lineno": 32
        },
        {
          "nodeid": "tests/test_kling.py::test_image_gen_init",
          "type": "Function",
          "lineno": 37
        },
        {
          "nodeid": "tests/test_kling.py::test_video_gen_init",
          "type": "Function",
          "lineno": 42
        },
        {
          "nodeid": "tests/test_kling.py::test_parse_cookie_string",
          "type": "Function",
          "lineno": 47
        },
        {
          "nodeid": "tests/test_kling.py::test_get_account_point[ImageGen]",
          "type": "Function",
          "lineno": 58
        },
        {
          "nodeid": "tests/test_kling.py::test_get_account_point[VideoGen]",
          "type": "Function",
          "lineno": 58
        },
        {
          "nodeid": "tests/test_kling.py::test_image_uploader",
          "type": "Function",
          "lineno": 68
        },
        {
          "nodeid": "tests/test_kling.py::test_fetch_metadata",
          "type": "Function",
          "lineno": 82
        },
        {
          "nodeid": "tests/test_kling.py::test_get_content[ImageGen-get_images]",
          "type": "Function",
          "lineno": 101
        },
        {
          "nodeid": "tests/test_kling.py::test_get_content[VideoGen-get_video]",
          "type": "Function",
          "lineno": 101
        },
        {
          "nodeid": "tests/test_kling.py::test_save_content[ImageGen-save_images]",
          "type": "Function",
          "lineno": 118
        },
        {
          "nodeid": "tests/test_kling.py::test_save_content[VideoGen-save_video]",
          "type": "Function",
          "lineno": 118
        },
        {
          "nodeid": "tests/test_kling.py::test_call_for_daily_check",
          "type": "Function",
          "lineno": 141
        },
        {
          "nodeid": "tests/test_kling.py::test_video_gen_get_video",
          "type": "Function",
          "lineno": 154
        },
        {
          "nodeid": "tests/test_kling.py::test_video_gen_save_video",
          "type": "Function",
          "lineno": 177
        },
        {
          "nodeid": "tests/test_kling.py::test_image_gen_get_images",
          "type": "Function",
          "lineno": 199
        },
        {
          "nodeid": "tests/test_kling.py::test_image_gen_save_images",
          "type": "Function",
          "lineno": 219
        },
        {
          "nodeid": "tests/test_kling.py::test_extend_video_completed",
          "type": "Function",
          "lineno": 242
        },
        {
          "nodeid": "tests/test_kling.py::test_extend_video_pending",
          "type": "Function",
          "lineno": 254
        },
        {
          "nodeid": "tests/test_kling.py::test_extend_video_failed",
          "type": "Function",
          "lineno": 265
        },
        {
          "nodeid": "tests/test_kling.py::test_extend_video_no_works",
          "type": "Function",
          "lineno": 276
        }
      ]
    },
    {
      "nodeid": "tests",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "tests/test_kling.py",
          "type": "Module"
        }
      ]
    },
    {
      "nodeid": ".",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "kling",
          "type": "Package"
        },
        {
          "nodeid": "kling_creator.egg-info",
          "type": "Dir"
        },
        {
          "nodeid": "tests",
          "type": "Dir"
        }
      ]
    }
  ],
  "tests": [
    {
      "nodeid": "tests/test_kling.py::test_base_gen_init",
      "lineno": 32,
      "outcome": "passed",
      "keywords": [
        "test_base_gen_init",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__urllib3",
        ""
      ],
      "setup": {
        "outcome": "passed",
        "stdout": "Call daily login success with False:\n<MagicMock name='Session().get().json()' id='1450994089712'>\n\n"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_image_gen_init",
      "lineno": 37,
      "outcome": "passed",
      "keywords": [
        "test_image_gen_init",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__urllib3",
        ""
      ],
      "setup": {
        "outcome": "passed",
        "stdout": "Call daily login success with False:\n<MagicMock name='Session().get().json()' id='1451008418224'>\n\n"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_video_gen_init",
      "lineno": 42,
      "outcome": "passed",
      "keywords": [
        "test_video_gen_init",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__urllib3",
        ""
      ],
      "setup": {
        "outcome": "passed",
        "stdout": "Call daily login success with False:\n<MagicMock name='Session().get().json()' id='1450989560336'>\n\n"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_parse_cookie_string",
      "lineno": 47,
      "outcome": "passed",
      "keywords": [
        "test_parse_cookie_string",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__urllib3",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_get_account_point[ImageGen]",
      "lineno": 58,
      "outcome": "passed",
      "keywords": [
        "test_get_account_point[ImageGen]",
        "parametrize",
        "pytestmark",
        "ImageGen",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__urllib3",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed",
        "stdout": "Call daily login success with False:\n<MagicMock name='Session().get().json()' id='1450976517568'>\n\n"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_get_account_point[VideoGen]",
      "lineno": 58,
      "outcome": "passed",
      "keywords": [
        "test_get_account_point[VideoGen]",
        "parametrize",
        "pytestmark",
        "VideoGen",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__urllib3",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed",
        "stdout": "Call daily login success with False:\n<MagicMock name='Session().get().json()' id='1451008669360'>\n\n"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_image_uploader",
      "lineno": 68,
      "outcome": "passed",
      "keywords": [
        "test_image_uploader",
        "__wrapped__",
        "patchings",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__urllib3",
        ""
      ],
      "setup": {
        "outcome": "passed",
        "stdout": "Call daily login success with False:\n<MagicMock name='Session().get().json()' id='1451008581296'>\n\n"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_fetch_metadata",
      "lineno": 82,
      "outcome": "passed",
      "keywords": [
        "test_fetch_metadata",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__urllib3",
        ""
      ],
      "setup": {
        "outcome": "passed",
        "stdout": "Call daily login success with False:\n<MagicMock name='Session().get().json()' id='1451008841616'>\n\n"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_get_content[ImageGen-get_images]",
      "lineno": 101,
      "outcome": "passed",
      "keywords": [
        "test_get_content[ImageGen-get_images]",
        "parametrize",
        "pytestmark",
        "ImageGen-get_images",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__urllib3",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed",
        "stdout": "Call daily login success with False:\n<MagicMock name='Session().get().json()' id='1451009002864'>\n\nWaiting for results...\n"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_get_content[VideoGen-get_video]",
      "lineno": 101,
      "outcome": "passed",
      "keywords": [
        "test_get_content[VideoGen-get_video]",
        "parametrize",
        "pytestmark",
        "VideoGen-get_video",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__urllib3",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed",
        "stdout": "Call daily login success with False:\n<MagicMock name='Session().get().json()' id='1451009166560'>\n\nWaiting for results... will take 2mins to 5mins\n"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_save_content[ImageGen-save_images]",
      "lineno": 118,
      "outcome": "passed",
      "keywords": [
        "test_save_content[ImageGen-save_images]",
        "parametrize",
        "__wrapped__",
        "patchings",
        "pytestmark",
        "ImageGen-save_images",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__urllib3",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed",
        "stdout": "Call daily login success with False:\n<MagicMock name='Session().get().json()' id='1451009331072'>\n\nWaiting for results...\n\nmock_resource\n"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_save_content[VideoGen-save_video]",
      "lineno": 118,
      "outcome": "passed",
      "keywords": [
        "test_save_content[VideoGen-save_video]",
        "parametrize",
        "__wrapped__",
        "patchings",
        "pytestmark",
        "VideoGen-save_video",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__urllib3",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed",
        "stdout": "Call daily login success with False:\n<MagicMock name='Session().get().json()' id='1451009034960'>\n\nWaiting for results... will take 2mins to 5mins\n\n"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_call_for_daily_check",
      "lineno": 141,
      "outcome": "passed",
      "keywords": [
        "test_call_for_daily_check",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__urllib3",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed",
        "stdout": "Call daily login success with True:\n{'status': 'success'}\n\n"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_video_gen_get_video",
      "lineno": 154,
      "outcome": "passed",
      "keywords": [
        "test_video_gen_get_video",
        "__wrapped__",
        "patchings",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__urllib3",
        ""
      ],
      "setup": {
        "outcome": "passed",
        "stdout": "Call daily login success with False:\n<MagicMock name='Session().get().json()' id='1451008634768'>\n\n"
      },
      "call": {
        "outcome": "passed",
        "stdout": "Waiting for results... will take 2mins to 5mins\nWaiting for results... will take 2mins to 5mins\nWaiting for results... will take 2mins to 5mins\nWaiting for results... will take 2mins to 5mins\n"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_video_gen_save_video",
      "lineno": 177,
      "outcome": "failed",
      "keywords": [
        "test_video_gen_save_video",
        "__wrapped__",
        "patchings",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__urllib3",
        ""
      ],
      "setup": {
        "outcome": "passed",
        "stdout": "Call daily login success with False:\n<MagicMock name='Session().get().json()' id='1451008663744'>\n\n"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "C:\\Users\\Mohay\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\unittest\\mock.py",
          "lineno": 944,
          "message": "AssertionError: expected call not found.\nExpected: open('mock_output_dir/0.mp4', 'wb')\n  Actual: open('mock_output_dir\\\\0.mp4', 'wb')"
        },
        "traceback": [
          {
            "path": "tests\\test_kling.py",
            "lineno": 196,
            "message": ""
          },
          {
            "path": "C:\\Users\\Mohay\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\unittest\\mock.py",
            "lineno": 956,
            "message": "in assert_called_once_with"
          },
          {
            "path": "C:\\Users\\Mohay\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\unittest\\mock.py",
            "lineno": 944,
            "message": "AssertionError"
          }
        ],
        "stdout": "Waiting for results... will take 2mins to 5mins\n\n",
        "longrepr": "mock_file = <MagicMock name='open' id='1451008422544'>\nmock_mkdir = <MagicMock name='mkdir' id='1451008421152'>\nmock_exists = <MagicMock name='exists' id='1451008635632'>\nvideo_gen = <kling.kling.VideoGen object at 0x00000151D6D9EA20>\nmock_session = <MagicMock name='Session()' id='1450989559184'>\n\n    @patch(\"os.path.exists\", return_value=False)\n    @patch(\"os.mkdir\")\n    @patch(\"builtins.open\", new_callable=mock_open)\n    def test_video_gen_save_video(\n        mock_file, mock_mkdir, mock_exists, video_gen, mock_session\n    ):\n        mock_session.post.return_value.json.return_value = {\n            \"data\": {\"task\": {\"id\": \"mock_id\"}}\n        }\n        mock_session.get.return_value.json.return_value = {\n            \"data\": {\"status\": 100, \"works\": [{\"resource\": {\"resource\": \"mock_video_url\"}}]}\n        }\n        mock_session.get.return_value.content = b\"mock_video_content\"\n        mock_session.get.return_value.status_code = 200\n    \n        video_gen.save_video(\"mock_prompt\", \"mock_output_dir\")\n    \n        mock_mkdir.assert_called_once_with(\"mock_output_dir\")\n>       mock_file.assert_called_once_with(\"mock_output_dir/0.mp4\", \"wb\")\n\ntests\\test_kling.py:196: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\nC:\\Users\\Mohay\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\unittest\\mock.py:956: in assert_called_once_with\n    return self.assert_called_with(*args, **kwargs)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <MagicMock name='open' id='1451008422544'>\nargs = ('mock_output_dir/0.mp4', 'wb'), kwargs = {}\nexpected = call('mock_output_dir/0.mp4', 'wb')\nactual = call('mock_output_dir\\\\0.mp4', 'wb')\n_error_message = <function NonCallableMock.assert_called_with.<locals>._error_message at 0x00000151D6D47740>\ncause = None\n\n    def assert_called_with(self, /, *args, **kwargs):\n        \"\"\"assert that the last call was made with the specified arguments.\n    \n        Raises an AssertionError if the args and keyword args passed in are\n        different to the last call to the mock.\"\"\"\n        if self.call_args is None:\n            expected = self._format_mock_call_signature(args, kwargs)\n            actual = 'not called.'\n            error_message = ('expected call not found.\\nExpected: %s\\n  Actual: %s'\n                    % (expected, actual))\n            raise AssertionError(error_message)\n    \n        def _error_message():\n            msg = self._format_mock_failure_message(args, kwargs)\n            return msg\n        expected = self._call_matcher(_Call((args, kwargs), two=True))\n        actual = self._call_matcher(self.call_args)\n        if actual != expected:\n            cause = expected if isinstance(expected, Exception) else None\n>           raise AssertionError(_error_message()) from cause\nE           AssertionError: expected call not found.\nE           Expected: open('mock_output_dir/0.mp4', 'wb')\nE             Actual: open('mock_output_dir\\\\0.mp4', 'wb')\n\nC:\\Users\\Mohay\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\unittest\\mock.py:944: AssertionError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_image_gen_get_images",
      "lineno": 199,
      "outcome": "passed",
      "keywords": [
        "test_image_gen_get_images",
        "__wrapped__",
        "patchings",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__urllib3",
        ""
      ],
      "setup": {
        "outcome": "passed",
        "stdout": "Call daily login success with False:\n<MagicMock name='Session().get().json()' id='1451009040576'>\n\n"
      },
      "call": {
        "outcome": "passed",
        "stdout": "Waiting for results...\nWaiting for results...\nWaiting for results...\n"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_image_gen_save_images",
      "lineno": 219,
      "outcome": "passed",
      "keywords": [
        "test_image_gen_save_images",
        "__wrapped__",
        "patchings",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__urllib3",
        ""
      ],
      "setup": {
        "outcome": "passed",
        "stdout": "Call daily login success with False:\n<MagicMock name='Session().get().json()' id='1451009173136'>\n\n"
      },
      "call": {
        "outcome": "passed",
        "stdout": "Waiting for results...\n\nmock_image_url\n"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_extend_video_completed",
      "lineno": 242,
      "outcome": "passed",
      "keywords": [
        "test_extend_video_completed",
        "__wrapped__",
        "patchings",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__urllib3",
        ""
      ],
      "setup": {
        "outcome": "passed",
        "stdout": "Call daily login success with False:\n<MagicMock name='Session().get().json()' id='1451009038032'>\n\n"
      },
      "call": {
        "outcome": "passed",
        "stdout": "Waiting for results... will take 2mins to 5mins\n"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_extend_video_pending",
      "lineno": 254,
      "outcome": "passed",
      "keywords": [
        "test_extend_video_pending",
        "__wrapped__",
        "patchings",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__urllib3",
        ""
      ],
      "setup": {
        "outcome": "passed",
        "stdout": "Call daily login success with False:\n<MagicMock name='Session().get().json()' id='1450989313136'>\n\n"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_extend_video_failed",
      "lineno": 265,
      "outcome": "passed",
      "keywords": [
        "test_extend_video_failed",
        "__wrapped__",
        "patchings",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__urllib3",
        ""
      ],
      "setup": {
        "outcome": "passed",
        "stdout": "Call daily login success with False:\n<MagicMock name='Session().get().json()' id='1451009915024'>\n\n"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_extend_video_no_works",
      "lineno": 276,
      "outcome": "passed",
      "keywords": [
        "test_extend_video_no_works",
        "__wrapped__",
        "patchings",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__urllib3",
        ""
      ],
      "setup": {
        "outcome": "passed",
        "stdout": "Call daily login success with False:\n<MagicMock name='Session().get().json()' id='1451010354416'>\n\n"
      },
      "call": {
        "outcome": "passed",
        "stdout": "No Video found.\n"
      },
      "teardown": {
        "outcome": "passed"
      }
    }
  ]
}
{
  "exitcode": 1,
  "summary": {
    "passed": 9,
    "failed": 2,
    "total": 11,
    "collected": 11
  },
  "collectors": [
    {
      "nodeid": "",
      "outcome": "passed",
      "result": [
        {
          "nodeid": ".",
          "type": "Dir"
        }
      ]
    },
    {
      "nodeid": "certbot_dns_infomaniak/dns_infomaniak_test.py::AuthenticatorTest",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "certbot_dns_infomaniak/dns_infomaniak_test.py::AuthenticatorTest::test_cleanup",
          "type": "TestCaseFunction",
          "lineno": 69
        },
        {
          "nodeid": "certbot_dns_infomaniak/dns_infomaniak_test.py::AuthenticatorTest::test_get_chall_pref",
          "type": "TestCaseFunction",
          "lineno": 58
        },
        {
          "nodeid": "certbot_dns_infomaniak/dns_infomaniak_test.py::AuthenticatorTest::test_more_info",
          "type": "TestCaseFunction",
          "lineno": 55
        },
        {
          "nodeid": "certbot_dns_infomaniak/dns_infomaniak_test.py::AuthenticatorTest::test_parser_arguments",
          "type": "TestCaseFunction",
          "lineno": 61
        },
        {
          "nodeid": "certbot_dns_infomaniak/dns_infomaniak_test.py::AuthenticatorTest::test_perform",
          "type": "TestCaseFunction",
          "lineno": 60
        }
      ]
    },
    {
      "nodeid": "certbot_dns_infomaniak/dns_infomaniak_test.py::APIDomainTest",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "certbot_dns_infomaniak/dns_infomaniak_test.py::APIDomainTest::test_add_txt_record",
          "type": "TestCaseFunction",
          "lineno": 112
        },
        {
          "nodeid": "certbot_dns_infomaniak/dns_infomaniak_test.py::APIDomainTest::test_add_txt_record_fail_to_authenticate",
          "type": "TestCaseFunction",
          "lineno": 141
        },
        {
          "nodeid": "certbot_dns_infomaniak/dns_infomaniak_test.py::APIDomainTest::test_add_txt_record_fail_to_find_domain",
          "type": "TestCaseFunction",
          "lineno": 133
        },
        {
          "nodeid": "certbot_dns_infomaniak/dns_infomaniak_test.py::APIDomainTest::test_del_txt_record",
          "type": "TestCaseFunction",
          "lineno": 152
        },
        {
          "nodeid": "certbot_dns_infomaniak/dns_infomaniak_test.py::APIDomainTest::test_del_txt_record_fail_to_authenticate",
          "type": "TestCaseFunction",
          "lineno": 182
        },
        {
          "nodeid": "certbot_dns_infomaniak/dns_infomaniak_test.py::APIDomainTest::test_del_txt_record_fail_to_find_domain",
          "type": "TestCaseFunction",
          "lineno": 174
        }
      ]
    },
    {
      "nodeid": "certbot_dns_infomaniak/dns_infomaniak_test.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "certbot_dns_infomaniak/dns_infomaniak_test.py::AuthenticatorTest",
          "type": "UnitTestCase"
        },
        {
          "nodeid": "certbot_dns_infomaniak/dns_infomaniak_test.py::APIDomainTest",
          "type": "UnitTestCase"
        }
      ]
    },
    {
      "nodeid": "certbot_dns_infomaniak",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "certbot_dns_infomaniak/dns_infomaniak_test.py",
          "type": "Module"
        }
      ]
    },
    {
      "nodeid": "certbot_dns_infomaniak.egg-info",
      "outcome": "passed",
      "result": []
    },
    {
      "nodeid": ".",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "certbot_dns_infomaniak",
          "type": "Package"
        },
        {
          "nodeid": "certbot_dns_infomaniak.egg-info",
          "type": "Dir"
        }
      ]
    }
  ],
  "tests": [
    {
      "nodeid": "certbot_dns_infomaniak/dns_infomaniak_test.py::AuthenticatorTest::test_cleanup",
      "lineno": 69,
      "outcome": "passed",
      "keywords": [
        "test_cleanup",
        "AuthenticatorTest",
        "dns_infomaniak_test.py",
        "certbot_dns_infomaniak",
        "infomaniak@certbot-dns-infomaniak__33519931__requests__pycurl",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "certbot_dns_infomaniak/dns_infomaniak_test.py::AuthenticatorTest::test_get_chall_pref",
      "lineno": 58,
      "outcome": "passed",
      "keywords": [
        "test_get_chall_pref",
        "AuthenticatorTest",
        "dns_infomaniak_test.py",
        "certbot_dns_infomaniak",
        "infomaniak@certbot-dns-infomaniak__33519931__requests__pycurl",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "certbot_dns_infomaniak/dns_infomaniak_test.py::AuthenticatorTest::test_more_info",
      "lineno": 55,
      "outcome": "passed",
      "keywords": [
        "test_more_info",
        "AuthenticatorTest",
        "dns_infomaniak_test.py",
        "certbot_dns_infomaniak",
        "infomaniak@certbot-dns-infomaniak__33519931__requests__pycurl",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "certbot_dns_infomaniak/dns_infomaniak_test.py::AuthenticatorTest::test_parser_arguments",
      "lineno": 61,
      "outcome": "passed",
      "keywords": [
        "test_parser_arguments",
        "AuthenticatorTest",
        "dns_infomaniak_test.py",
        "certbot_dns_infomaniak",
        "infomaniak@certbot-dns-infomaniak__33519931__requests__pycurl",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "certbot_dns_infomaniak/dns_infomaniak_test.py::AuthenticatorTest::test_perform",
      "lineno": 60,
      "outcome": "passed",
      "keywords": [
        "test_perform",
        "AuthenticatorTest",
        "dns_infomaniak_test.py",
        "certbot_dns_infomaniak",
        "infomaniak@certbot-dns-infomaniak__33519931__requests__pycurl",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "certbot_dns_infomaniak/dns_infomaniak_test.py::APIDomainTest::test_add_txt_record",
      "lineno": 112,
      "outcome": "failed",
      "keywords": [
        "test_add_txt_record",
        "APIDomainTest",
        "dns_infomaniak_test.py",
        "certbot_dns_infomaniak",
        "infomaniak@certbot-dns-infomaniak__33519931__requests__pycurl",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\infomaniak@certbot-dns-infomaniak__33519931__requests__pycurl\\certbot_dns_infomaniak\\dns_infomaniak.py",
          "lineno": 211,
          "message": "certbot.errors.PluginError: Domain not found"
        },
        "traceback": [
          {
            "path": "certbot_dns_infomaniak\\dns_infomaniak_test.py",
            "lineno": 130,
            "message": ""
          },
          {
            "path": "certbot_dns_infomaniak\\dns_infomaniak.py",
            "lineno": 222,
            "message": "in add_txt_record"
          },
          {
            "path": "certbot_dns_infomaniak\\dns_infomaniak.py",
            "lineno": 211,
            "message": "PluginError"
          }
        ],
        "longrepr": "self = <certbot_dns_infomaniak.dns_infomaniak_test.APIDomainTest testMethod=test_add_txt_record>\n\n    def test_add_txt_record(self):\n        \"\"\"add_txt_record with normal params should succeed\"\"\"\n        # Mock domain lookup\n        domain_data = [\n            {\n                \"id\": 654321,\n                \"account_id\": 1234,\n                \"service_id\": 14,\n                \"service_name\": \"domain\",\n                \"customer_name\": DOMAIN,\n            }\n        ]\n        self.client._make_request = mock.MagicMock(return_value={\"result\": \"success\", \"data\": domain_data})\n    \n        # Mock DNS record creation\n        self.client._make_request = mock.MagicMock(return_value={\"result\": \"success\", \"data\": \"1001234\"})\n    \n>       self.client.add_txt_record(\n            DOMAIN, self.record_name, self.record_content, self.record_ttl\n        )\n\ncertbot_dns_infomaniak\\dns_infomaniak_test.py:130: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\ncertbot_dns_infomaniak\\dns_infomaniak.py:222: in add_txt_record\n    (domain_id, domain_name) = self._find_zone(domain)\n                               ^^^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <certbot_dns_infomaniak.dns_infomaniak._APIDomain object at 0x0000016BB8E856D0>\ndomain = 'com'\n\n    def _find_zone(self, domain):\n        \"\"\"Finds the corresponding DNS zone through the API\n    \n        :param str domain: domain name\n    \n        :returns: id and zone name\n        \"\"\"\n        while \".\" in domain:\n            result = self._get_request(\n                \"/1/product?service_name=domain&customer_name={domain}\".format(domain=domain),\n            )\n            if len(result) == 1:\n                return (\n                    result[0][\"id\"],\n                    domain,\n                )\n            domain = domain[domain.find(\".\") + 1:]\n>       raise errors.PluginError(\"Domain not found\")\nE       certbot.errors.PluginError: Domain not found\n\ncertbot_dns_infomaniak\\dns_infomaniak.py:211: PluginError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "certbot_dns_infomaniak/dns_infomaniak_test.py::APIDomainTest::test_add_txt_record_fail_to_authenticate",
      "lineno": 141,
      "outcome": "passed",
      "keywords": [
        "test_add_txt_record_fail_to_authenticate",
        "APIDomainTest",
        "dns_infomaniak_test.py",
        "certbot_dns_infomaniak",
        "infomaniak@certbot-dns-infomaniak__33519931__requests__pycurl",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "certbot_dns_infomaniak/dns_infomaniak_test.py::APIDomainTest::test_add_txt_record_fail_to_find_domain",
      "lineno": 133,
      "outcome": "passed",
      "keywords": [
        "test_add_txt_record_fail_to_find_domain",
        "APIDomainTest",
        "dns_infomaniak_test.py",
        "certbot_dns_infomaniak",
        "infomaniak@certbot-dns-infomaniak__33519931__requests__pycurl",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "certbot_dns_infomaniak/dns_infomaniak_test.py::APIDomainTest::test_del_txt_record",
      "lineno": 152,
      "outcome": "failed",
      "keywords": [
        "test_del_txt_record",
        "APIDomainTest",
        "dns_infomaniak_test.py",
        "certbot_dns_infomaniak",
        "infomaniak@certbot-dns-infomaniak__33519931__requests__pycurl",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\infomaniak@certbot-dns-infomaniak__33519931__requests__pycurl\\certbot_dns_infomaniak\\dns_infomaniak.py",
          "lineno": 207,
          "message": "KeyError: 0"
        },
        "traceback": [
          {
            "path": "certbot_dns_infomaniak\\dns_infomaniak_test.py",
            "lineno": 170,
            "message": ""
          },
          {
            "path": "certbot_dns_infomaniak\\dns_infomaniak.py",
            "lineno": 239,
            "message": "in del_txt_record"
          },
          {
            "path": "certbot_dns_infomaniak\\dns_infomaniak.py",
            "lineno": 207,
            "message": "KeyError"
          }
        ],
        "longrepr": "self = <certbot_dns_infomaniak.dns_infomaniak_test.APIDomainTest testMethod=test_del_txt_record>\n\n    def test_del_txt_record(self):\n        \"\"\"del_txt_record with normal params should succeed\"\"\"\n        # Mock domain lookup\n        domain_data = [\n            {\n                \"id\": \"654321\",\n                \"account_id\": \"1234\",\n                \"service_id\": \"14\",\n                \"service_name\": \"domain\",\n                \"customer_name\": DOMAIN,\n            }\n        ]\n        self.client._make_request = mock.MagicMock(return_value={\"result\": \"success\", \"data\": domain_data})\n    \n        # Mock DNS record deletion\n        self.client._make_request = mock.MagicMock(return_value={\"result\": \"success\"})\n    \n>       self.client.del_txt_record(\n            DOMAIN, \"{name}.{domain}\".format(name=self.record_name, domain=DOMAIN),\n            self.record_content,\n        )\n\ncertbot_dns_infomaniak\\dns_infomaniak_test.py:170: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\ncertbot_dns_infomaniak\\dns_infomaniak.py:239: in del_txt_record\n    (domain_id, domain_name) = self._find_zone(domain)\n                               ^^^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <certbot_dns_infomaniak.dns_infomaniak._APIDomain object at 0x0000016BB8F11490>\ndomain = 'example.com'\n\n    def _find_zone(self, domain):\n        \"\"\"Finds the corresponding DNS zone through the API\n    \n        :param str domain: domain name\n    \n        :returns: id and zone name\n        \"\"\"\n        while \".\" in domain:\n            result = self._get_request(\n                \"/1/product?service_name=domain&customer_name={domain}\".format(domain=domain),\n            )\n            if len(result) == 1:\n                return (\n>                   result[0][\"id\"],\n                    ^^^^^^^^^\n                    domain,\n                )\nE               KeyError: 0\n\ncertbot_dns_infomaniak\\dns_infomaniak.py:207: KeyError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "certbot_dns_infomaniak/dns_infomaniak_test.py::APIDomainTest::test_del_txt_record_fail_to_authenticate",
      "lineno": 182,
      "outcome": "passed",
      "keywords": [
        "test_del_txt_record_fail_to_authenticate",
        "APIDomainTest",
        "dns_infomaniak_test.py",
        "certbot_dns_infomaniak",
        "infomaniak@certbot-dns-infomaniak__33519931__requests__pycurl",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "certbot_dns_infomaniak/dns_infomaniak_test.py::APIDomainTest::test_del_txt_record_fail_to_find_domain",
      "lineno": 174,
      "outcome": "passed",
      "keywords": [
        "test_del_txt_record_fail_to_find_domain",
        "APIDomainTest",
        "dns_infomaniak_test.py",
        "certbot_dns_infomaniak",
        "infomaniak@certbot-dns-infomaniak__33519931__requests__pycurl",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    }
  ]
}
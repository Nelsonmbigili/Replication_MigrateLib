{
  "exitcode": 1,
  "summary": {
    "passed": 137,
    "failed": 94,
    "total": 231,
    "collected": 231
  },
  "collectors": [
    {
      "nodeid": "",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "tests",
          "type": "Package"
        },
        {
          "nodeid": "pyemv",
          "type": "Package"
        }
      ]
    },
    {
      "nodeid": "tests/__init__.py",
      "outcome": "passed",
      "result": []
    },
    {
      "nodeid": "tests/test_ac.py",
      "outcome": "passed",
      "result": []
    },
    {
      "nodeid": "tests/test_ac.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "tests/test_ac.py::test_generate_ac_exception",
          "type": "Function",
          "lineno": 5
        },
        {
          "nodeid": "tests/test_ac.py::test_generate_arpc_1_exception",
          "type": "Function",
          "lineno": 38
        },
        {
          "nodeid": "tests/test_ac.py::test_generate_arpc_2_exception",
          "type": "Function",
          "lineno": 106
        }
      ]
    },
    {
      "nodeid": "tests/test_ac_hsm.py",
      "outcome": "passed",
      "result": []
    },
    {
      "nodeid": "tests/test_ac_hsm.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "tests/test_ac_hsm.py::test_generate_ac_emv_arpc1",
          "type": "Function",
          "lineno": 3
        },
        {
          "nodeid": "tests/test_ac_hsm.py::test_generate_ac_default_emv_arpc1",
          "type": "Function",
          "lineno": 39
        },
        {
          "nodeid": "tests/test_ac_hsm.py::test_generate_ac_visa_aprc1",
          "type": "Function",
          "lineno": 75
        },
        {
          "nodeid": "tests/test_ac_hsm.py::test_generate_ac_visa_aprc1_no_padding_required",
          "type": "Function",
          "lineno": 111
        },
        {
          "nodeid": "tests/test_ac_hsm.py::test_generate_arpc2",
          "type": "Function",
          "lineno": 148
        },
        {
          "nodeid": "tests/test_ac_hsm.py::test_generate_arpc2_no_prop_auth_data",
          "type": "Function",
          "lineno": 185
        }
      ]
    },
    {
      "nodeid": "tests/test_cvn_hsm.py",
      "outcome": "passed",
      "result": []
    },
    {
      "nodeid": "tests/test_cvn_hsm.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "tests/test_cvn_hsm.py::test_visa_cvn10[1234567890123456-00-9999-8888_0]",
          "type": "Function",
          "lineno": 7
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_visa_cvn10[1234567890123456-00-9999-8888_1]",
          "type": "Function",
          "lineno": 7
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_visa_cvn10[1234567890123456-00-9999-8888_2]",
          "type": "Function",
          "lineno": 7
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_visa_cvn10[1234567890123456-00-9999-8888_3]",
          "type": "Function",
          "lineno": 7
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_visa_cvn18[1234567890123456-00-9999-8888_0]",
          "type": "Function",
          "lineno": 104
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_visa_cvn18[1234567890123456-00-9999-8888_1]",
          "type": "Function",
          "lineno": 104
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_visa_cvn18[1234567890123456-00-9999-8888_2]",
          "type": "Function",
          "lineno": 104
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_visa_cvn18[1234567890123456-00-9999-8888_3]",
          "type": "Function",
          "lineno": 104
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_visa_cvn22[1234567890123456-00-9999-8888_0]",
          "type": "Function",
          "lineno": 203
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_visa_cvn22[1234567890123456-00-9999-8888_1]",
          "type": "Function",
          "lineno": 203
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_visa_cvn22[1234567890123456-00-9999-8888_2]",
          "type": "Function",
          "lineno": 203
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_visa_cvn22[1234567890123456-00-9999-8888_3]",
          "type": "Function",
          "lineno": 203
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_interac_cvn133[1234567890123456-00-9999_0]",
          "type": "Function",
          "lineno": 312
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_interac_cvn133[1234567890123456-00-9999_1]",
          "type": "Function",
          "lineno": 312
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_interac_cvn133[1234567890123456-00-9999_2]",
          "type": "Function",
          "lineno": 312
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_interac_cvn133[1234567890123456-00-9999_3]",
          "type": "Function",
          "lineno": 312
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn16[1234567890123456-00-9999_0]",
          "type": "Function",
          "lineno": 397
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn16[1234567890123456-00-9999_1]",
          "type": "Function",
          "lineno": 397
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn16[1234567890123456-00-9999_2]",
          "type": "Function",
          "lineno": 397
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn16[1234567890123456-00-9999_3]",
          "type": "Function",
          "lineno": 397
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn17[1234567890123456-00-9999_0]",
          "type": "Function",
          "lineno": 481
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn17[1234567890123456-00-9999_1]",
          "type": "Function",
          "lineno": 481
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn17[1234567890123456-00-9999_2]",
          "type": "Function",
          "lineno": 481
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn17[1234567890123456-00-9999_3]",
          "type": "Function",
          "lineno": 481
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn20[1234567890123456-00-9999_0]",
          "type": "Function",
          "lineno": 567
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn20[1234567890123456-00-9999_1]",
          "type": "Function",
          "lineno": 567
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn20[1234567890123456-00-9999_2]",
          "type": "Function",
          "lineno": 567
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn20[1234567890123456-00-9999_3]",
          "type": "Function",
          "lineno": 567
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn21[1234567890123456-00-9999_0]",
          "type": "Function",
          "lineno": 650
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn21[1234567890123456-00-9999_1]",
          "type": "Function",
          "lineno": 650
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn21[1234567890123456-00-9999_2]",
          "type": "Function",
          "lineno": 650
        },
        {
          "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn21[1234567890123456-00-9999_3]",
          "type": "Function",
          "lineno": 650
        }
      ]
    },
    {
      "nodeid": "tests/test_cvv.py",
      "outcome": "passed",
      "result": []
    },
    {
      "nodeid": "tests/test_cvv.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "tests/test_cvv.py::test_generate_ac_exception",
          "type": "Function",
          "lineno": 4
        }
      ]
    },
    {
      "nodeid": "tests/test_cvv_hsm.py",
      "outcome": "passed",
      "result": []
    },
    {
      "nodeid": "tests/test_cvv_hsm.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "tests/test_cvv_hsm.py::test_generate_cvc3_track2",
          "type": "Function",
          "lineno": 3
        },
        {
          "nodeid": "tests/test_cvv_hsm.py::test_generate_cvc3_track1",
          "type": "Function",
          "lineno": 22
        }
      ]
    },
    {
      "nodeid": "tests/test_kd.py",
      "outcome": "passed",
      "result": []
    },
    {
      "nodeid": "tests/test_kd.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "tests/test_kd.py::test_derive_common_sk_exception",
          "type": "Function",
          "lineno": 5
        },
        {
          "nodeid": "tests/test_kd.py::test_derive_visa_sm_sk_exception",
          "type": "Function",
          "lineno": 47
        },
        {
          "nodeid": "tests/test_kd.py::test_derive_emv2000_tree_sk_exception",
          "type": "Function",
          "lineno": 88
        }
      ]
    },
    {
      "nodeid": "tests/test_kd_hsm.py",
      "outcome": "passed",
      "result": []
    },
    {
      "nodeid": "tests/test_kd_hsm.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_a_psn[12345678901234567-45_0]",
          "type": "Function",
          "lineno": 5
        },
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_a_psn[12345678901234567-45_1]",
          "type": "Function",
          "lineno": 5
        },
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_a_psn[12345678901234567-45_2]",
          "type": "Function",
          "lineno": 5
        },
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_a_psn[12345678901234567-45_3]",
          "type": "Function",
          "lineno": 5
        },
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_a_no_psn[12345678901234567_0]",
          "type": "Function",
          "lineno": 48
        },
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_a_no_psn[12345678901234567_1]",
          "type": "Function",
          "lineno": 48
        },
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_common_sk",
          "type": "Function",
          "lineno": 88
        },
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_b_pan16",
          "type": "Function",
          "lineno": 126
        },
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_b_pan17_psn[12345678901234567-45_0]",
          "type": "Function",
          "lineno": 163
        },
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_b_pan17_psn[12345678901234567-45_1]",
          "type": "Function",
          "lineno": 163
        },
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_b_pan17_psn[12345678901234567-45_2]",
          "type": "Function",
          "lineno": 163
        },
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_b_pan17_psn[12345678901234567-45_3]",
          "type": "Function",
          "lineno": 163
        },
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_b_pan17_no_psn[12345678901234567_0]",
          "type": "Function",
          "lineno": 208
        },
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_b_pan17_no_psn[12345678901234567_1]",
          "type": "Function",
          "lineno": 208
        },
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_b_pan18",
          "type": "Function",
          "lineno": 249
        },
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_b_sha_pad",
          "type": "Function",
          "lineno": 285
        },
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_visa_sm_sk",
          "type": "Function",
          "lineno": 331
        },
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_emv2000_tree_sk[0000-8-4-00000000000000000000000000000000-80BF3145AECB948A5201DAB9EF469875]",
          "type": "Function",
          "lineno": 358
        },
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_emv2000_tree_sk[0000-8-4-F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0-DC31BC40B3AB8F73F2E3DA5EBF9DE59B]",
          "type": "Function",
          "lineno": 358
        },
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_emv2000_tree_sk[0000-16-2-00000000000000000000000000000000-86AD9732D5A192A749ADCE31919DAE8A]",
          "type": "Function",
          "lineno": 358
        },
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_emv2000_tree_sk[0000-16-2-F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0-7C57A15261202A101C6DA29B16672A3E]",
          "type": "Function",
          "lineno": 358
        },
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_emv2000_tree_sk[00FF-8-4-00000000000000000000000000000000-981F9D208AE6132CBC8A7C97F42A5445]",
          "type": "Function",
          "lineno": 358
        },
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_emv2000_tree_sk[00FF-8-4-F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0-D579C8A4927589017FA1739B2C853BAD]",
          "type": "Function",
          "lineno": 358
        },
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_emv2000_tree_sk[00FF-16-2-00000000000000000000000000000000-1F54F492EF104580B0F4B0F8910D0438]",
          "type": "Function",
          "lineno": 358
        },
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_emv2000_tree_sk[00FF-16-2-F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0-2086F81AAB731FF8CED9BF6DA7191CA2]",
          "type": "Function",
          "lineno": 358
        },
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_emv2000_tree_sk[FFFF-8-4-00000000000000000000000000000000-D93D7A6B70F867615D4AAB79BF235B62]",
          "type": "Function",
          "lineno": 358
        },
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_emv2000_tree_sk[FFFF-8-4-F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0-A10EA78F2F1ACE203B3B402F6EE6CB29]",
          "type": "Function",
          "lineno": 358
        },
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_emv2000_tree_sk[FFFF-16-2-00000000000000000000000000000000-F83E499EF786C20BC41310A176E3F84F]",
          "type": "Function",
          "lineno": 358
        },
        {
          "nodeid": "tests/test_kd_hsm.py::test_derive_emv2000_tree_sk[FFFF-16-2-F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0-73E3B0A1406E5E4908D5804C4970E520]",
          "type": "Function",
          "lineno": 358
        }
      ]
    },
    {
      "nodeid": "tests/test_mac.py",
      "outcome": "passed",
      "result": []
    },
    {
      "nodeid": "tests/test_mac.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "tests/test_mac.py::test_mac_iso9797_3",
          "type": "Function",
          "lineno": 5
        },
        {
          "nodeid": "tests/test_mac.py::test_pad_iso9797_1",
          "type": "Function",
          "lineno": 43
        },
        {
          "nodeid": "tests/test_mac.py::test_pad_iso9797_2",
          "type": "Function",
          "lineno": 56
        }
      ]
    },
    {
      "nodeid": "tests/test_sm.py",
      "outcome": "passed",
      "result": []
    },
    {
      "nodeid": "tests/test_sm.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "tests/test_sm.py::test_generate_command_mac_exception",
          "type": "Function",
          "lineno": 5
        },
        {
          "nodeid": "tests/test_sm.py::test_encrypt_command_data_mastercard_nonpadded",
          "type": "Function",
          "lineno": 27
        },
        {
          "nodeid": "tests/test_sm.py::test_encrypt_command_data_exception",
          "type": "Function",
          "lineno": 49
        },
        {
          "nodeid": "tests/test_sm.py::test_format_vis_pin_block_exception",
          "type": "Function",
          "lineno": 84
        },
        {
          "nodeid": "tests/test_sm.py::test_format_iso9564_2_pin_block_exception",
          "type": "Function",
          "lineno": 148
        }
      ]
    },
    {
      "nodeid": "tests/test_sm_hsm.py",
      "outcome": "passed",
      "result": []
    },
    {
      "nodeid": "tests/test_sm_hsm.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "tests/test_sm_hsm.py::test_generate_command_mac",
          "type": "Function",
          "lineno": 6
        },
        {
          "nodeid": "tests/test_sm_hsm.py::test_mastercard_pin_change[9999_0]",
          "type": "Function",
          "lineno": 36
        },
        {
          "nodeid": "tests/test_sm_hsm.py::test_mastercard_pin_change[9999_1]",
          "type": "Function",
          "lineno": 36
        },
        {
          "nodeid": "tests/test_sm_hsm.py::test_mastercard_pin_change_12[999999999999_0]",
          "type": "Function",
          "lineno": 89
        },
        {
          "nodeid": "tests/test_sm_hsm.py::test_mastercard_pin_change_12[999999999999_1]",
          "type": "Function",
          "lineno": 89
        },
        {
          "nodeid": "tests/test_sm_hsm.py::test_vis_pin_change[9999_0]",
          "type": "Function",
          "lineno": 143
        },
        {
          "nodeid": "tests/test_sm_hsm.py::test_vis_pin_change[9999_1]",
          "type": "Function",
          "lineno": 143
        },
        {
          "nodeid": "tests/test_sm_hsm.py::test_vis_change_change_current_pin[9999-8888_0]",
          "type": "Function",
          "lineno": 196
        },
        {
          "nodeid": "tests/test_sm_hsm.py::test_vis_change_change_current_pin[9999-8888_1]",
          "type": "Function",
          "lineno": 196
        },
        {
          "nodeid": "tests/test_sm_hsm.py::test_vis_change_change_current_pin[9999-8888_2]",
          "type": "Function",
          "lineno": 196
        },
        {
          "nodeid": "tests/test_sm_hsm.py::test_vis_change_change_current_pin[9999-8888_3]",
          "type": "Function",
          "lineno": 196
        },
        {
          "nodeid": "tests/test_sm_hsm.py::test_vis_change_current_pin_12[999999999999-888888888888_0]",
          "type": "Function",
          "lineno": 253
        },
        {
          "nodeid": "tests/test_sm_hsm.py::test_vis_change_current_pin_12[999999999999-888888888888_1]",
          "type": "Function",
          "lineno": 253
        },
        {
          "nodeid": "tests/test_sm_hsm.py::test_vis_change_current_pin_12[999999999999-888888888888_2]",
          "type": "Function",
          "lineno": 253
        },
        {
          "nodeid": "tests/test_sm_hsm.py::test_vis_change_current_pin_12[999999999999-888888888888_3]",
          "type": "Function",
          "lineno": 253
        },
        {
          "nodeid": "tests/test_sm_hsm.py::test_ccd_pin_change[9999_0]",
          "type": "Function",
          "lineno": 311
        },
        {
          "nodeid": "tests/test_sm_hsm.py::test_ccd_pin_change[9999_1]",
          "type": "Function",
          "lineno": 311
        }
      ]
    },
    {
      "nodeid": "tests/test_tlv.py",
      "outcome": "passed",
      "result": []
    },
    {
      "nodeid": "tests/test_tlv.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag[-value0]",
          "type": "Function",
          "lineno": 7
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag[9C00-value1]",
          "type": "Function",
          "lineno": 7
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag[9C01FF-value2]",
          "type": "Function",
          "lineno": 7
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag[9C8101FF-value3]",
          "type": "Function",
          "lineno": 7
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag[9F0200-value4]",
          "type": "Function",
          "lineno": 7
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag[9F0201FF-value5]",
          "type": "Function",
          "lineno": 7
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag[9F820100-value6]",
          "type": "Function",
          "lineno": 7
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag[9F820101FF-value7]",
          "type": "Function",
          "lineno": 7
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag[9C80-value8]",
          "type": "Function",
          "lineno": 7
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag[9C8100-value9]",
          "type": "Function",
          "lineno": 7
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag[9C820000-value10]",
          "type": "Function",
          "lineno": 7
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag[9C83000000-value11]",
          "type": "Function",
          "lineno": 7
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag[9C8400000000-value12]",
          "type": "Function",
          "lineno": 7
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag[9C8101FF-value13]",
          "type": "Function",
          "lineno": 7
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag[9C820001FF-value14]",
          "type": "Function",
          "lineno": 7
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag[9C83000001FF-value15]",
          "type": "Function",
          "lineno": 7
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag[9C8400000001FF-value16]",
          "type": "Function",
          "lineno": 7
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[-value0]",
          "type": "Function",
          "lineno": 38
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9C00-value1]",
          "type": "Function",
          "lineno": 38
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9C01FF-value2]",
          "type": "Function",
          "lineno": 38
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9C8101FF-value3]",
          "type": "Function",
          "lineno": 38
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9F0200-value4]",
          "type": "Function",
          "lineno": 38
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9F0201FF-value5]",
          "type": "Function",
          "lineno": 38
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9F820100-value6]",
          "type": "Function",
          "lineno": 38
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9F820101FF-value7]",
          "type": "Function",
          "lineno": 38
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9C80-value8]",
          "type": "Function",
          "lineno": 38
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9C8100-value9]",
          "type": "Function",
          "lineno": 38
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9C820000-value10]",
          "type": "Function",
          "lineno": 38
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9C83000000-value11]",
          "type": "Function",
          "lineno": 38
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9C8400000000-value12]",
          "type": "Function",
          "lineno": 38
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9C8101FF-value13]",
          "type": "Function",
          "lineno": 38
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9C820001FF-value14]",
          "type": "Function",
          "lineno": 38
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9C83000001FF-value15]",
          "type": "Function",
          "lineno": 38
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9C8400000001FF-value16]",
          "type": "Function",
          "lineno": 38
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_nested",
          "type": "Function",
          "lineno": 70
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_nested_flat",
          "type": "Function",
          "lineno": 75
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_simple",
          "type": "Function",
          "lineno": 85
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_exception[9F-9F-0-value0-Tag malformed, expecting more data: tag '9F', offset 0.]",
          "type": "Function",
          "lineno": 91
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_exception[9FF0-9FF0-0-value1-Tag malformed, expecting more data: tag '9FF0', offset 0.]",
          "type": "Function",
          "lineno": 91
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_exception[9C-9C-1-value2-Tag length malformed, expecting 1 byte(s): tag '9C', offset 1.]",
          "type": "Function",
          "lineno": 91
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_exception[9C81-9C-2-value3-Tag length malformed, expecting 1 byte(s): tag '9C', offset 2.]",
          "type": "Function",
          "lineno": 91
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_exception[9C8200-9C-2-value4-Tag length malformed, expecting 2 byte(s): tag '9C', offset 2.]",
          "type": "Function",
          "lineno": 91
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_exception[9C01-9C-2-value5-Tag value malformed, expecting 1 byte(s): tag '9C', offset 2.]",
          "type": "Function",
          "lineno": 91
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_exception[9C0200-9C-2-value6-Tag value malformed, expecting 2 byte(s): tag '9C', offset 2.]",
          "type": "Function",
          "lineno": 91
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_exception[E001-E0-2-value7-Tag value malformed, expecting 1 byte(s): tag 'E0', offset 2.]",
          "type": "Function",
          "lineno": 91
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_exception[E0019F0001FF-9F-2-value8-Tag malformed, expecting more data: tag '9F', offset 2.]",
          "type": "Function",
          "lineno": 91
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_exception[E0019C01FF-9C-3-value9-Tag length malformed, expecting 1 byte(s): tag '9C', offset 3.]",
          "type": "Function",
          "lineno": 91
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_exception[E0029C8101FF-9C-4-value10-Tag length malformed, expecting 1 byte(s): tag '9C', offset 4.]",
          "type": "Function",
          "lineno": 91
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_exception[E0039C8201FF-9C-4-value11-Tag length malformed, expecting 2 byte(s): tag '9C', offset 4.]",
          "type": "Function",
          "lineno": 91
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_exception[E0039C8101C001FF-9C-5-value12-Tag value malformed, expecting 1 byte(s): tag '9C', offset 5.]",
          "type": "Function",
          "lineno": 91
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_exception[E0049C810200C001FF-9C-5-value13-Tag value malformed, expecting 2 byte(s): tag '9C', offset 5.]",
          "type": "Function",
          "lineno": 91
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_exception[9C01FFAA-AA-4-value14-Tag length malformed, expecting 1 byte(s): tag 'AA', offset 4.]",
          "type": "Function",
          "lineno": 91
        },
        {
          "nodeid": "tests/test_tlv.py::test_decode_exception[E0039C01FFAA-AA-6-value15-Tag length malformed, expecting 1 byte(s): tag 'AA', offset 6.]",
          "type": "Function",
          "lineno": 91
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode[tags0-]",
          "type": "Function",
          "lineno": 139
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode[tags1-9C00]",
          "type": "Function",
          "lineno": 139
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode[tags2-9C01FF]",
          "type": "Function",
          "lineno": 139
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode[tags3-9F0001FF]",
          "type": "Function",
          "lineno": 139
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode[tags4-9F800101FF]",
          "type": "Function",
          "lineno": 139
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode[tags5-9C8180FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF]",
          "type": "Function",
          "lineno": 139
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode[tags6-9C8201FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF]",
          "type": "Function",
          "lineno": 139
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode[tags7-E000]",
          "type": "Function",
          "lineno": 139
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode[tags8-E0029C00]",
          "type": "Function",
          "lineno": 139
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode[tags9-E0039C01FF]",
          "type": "Function",
          "lineno": 139
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode[tags10-E0049F0001FF]",
          "type": "Function",
          "lineno": 139
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode[tags11-E0049F0001FF9C01FF]",
          "type": "Function",
          "lineno": 139
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_str[tags0-]",
          "type": "Function",
          "lineno": 166
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_str[tags1-9C00]",
          "type": "Function",
          "lineno": 166
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_str[tags2-9C01FF]",
          "type": "Function",
          "lineno": 166
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_str[tags3-9F0001FF]",
          "type": "Function",
          "lineno": 166
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_str[tags4-9F800101FF]",
          "type": "Function",
          "lineno": 166
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_str[tags5-9C8180FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF]",
          "type": "Function",
          "lineno": 166
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_str[tags6-9C8201FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF]",
          "type": "Function",
          "lineno": 166
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_str[tags7-E000]",
          "type": "Function",
          "lineno": 166
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_str[tags8-E0029C00]",
          "type": "Function",
          "lineno": 166
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_str[tags9-E0039C01FF]",
          "type": "Function",
          "lineno": 166
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_str[tags10-E0049F0001FF]",
          "type": "Function",
          "lineno": 166
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_str[tags11-E0049F0001FF9C01FF]",
          "type": "Function",
          "lineno": 166
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_simple[tags0-]",
          "type": "Function",
          "lineno": 193
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_simple[tags1-9C00]",
          "type": "Function",
          "lineno": 193
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_simple[tags2-9C01FF]",
          "type": "Function",
          "lineno": 193
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_simple[tags3-9F0001FF]",
          "type": "Function",
          "lineno": 193
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_simple[tags4-9F800101FF]",
          "type": "Function",
          "lineno": 193
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_simple[tags5-9C80FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF]",
          "type": "Function",
          "lineno": 193
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_simple[tags6-9CFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF]",
          "type": "Function",
          "lineno": 193
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_simple[tags7-E000]",
          "type": "Function",
          "lineno": 193
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_simple[tags8-E0029C00]",
          "type": "Function",
          "lineno": 193
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_simple[tags9-E0039C01FF]",
          "type": "Function",
          "lineno": 193
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_simple[tags10-E0049F0001FF]",
          "type": "Function",
          "lineno": 193
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_simple[tags11-E0049F0001FF9C01FF]",
          "type": "Function",
          "lineno": 193
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_exception[tags0-XX-Invalid tag format, expecting hexchar string: tag 'XX'.]",
          "type": "Function",
          "lineno": 220
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_exception[tags1-00X-Invalid tag format, expecting hexchar string: tag '00X'.]",
          "type": "Function",
          "lineno": 220
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_exception[tags2-0-Invalid tag format, expecting hexchar string: tag '0'.]",
          "type": "Function",
          "lineno": 220
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_exception[tags3-9F-Invalid tag format, expecting more data: tag '9F'.]",
          "type": "Function",
          "lineno": 220
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_exception[tags4-9F0001-Invalid tag format, extra data: tag '9F0001'.]",
          "type": "Function",
          "lineno": 220
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_exception[tags5-EC-Invalid value type (list) for a constructed tag, expecting a dict: tag 'EC'.]",
          "type": "Function",
          "lineno": 220
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_exception[tags6-EC-Invalid value type (tuple) for a constructed tag, expecting a dict: tag 'EC'.]",
          "type": "Function",
          "lineno": 220
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_exception[tags7-9C-Invalid value type (list) for a primitive tag, expecting bytes or str: tag '9C'.]",
          "type": "Function",
          "lineno": 220
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_exception[tags8-9C-Invalid value type (tuple) for a primitive tag, expecting bytes or str: tag '9C'.]",
          "type": "Function",
          "lineno": 220
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_exception[tags9-9C-Invalid value format, expecting hexchar string: tag '9C'.]",
          "type": "Function",
          "lineno": 220
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_exception[tags10-9C-Invalid value format, expecting hexchar string: tag '9C'.]",
          "type": "Function",
          "lineno": 220
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_simple_exception[tags0-9C-Value length (256) cannot exceed 255 bytes when 'simple' is enabled: tag '9C'.]",
          "type": "Function",
          "lineno": 247
        },
        {
          "nodeid": "tests/test_tlv.py::test_encode_simple_exception[tags1-9C-Value length (256) cannot exceed 255 bytes when 'simple' is enabled: tag '9C'.]",
          "type": "Function",
          "lineno": 247
        }
      ]
    },
    {
      "nodeid": "tests",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "tests/__init__.py",
          "type": "DoctestModule"
        },
        {
          "nodeid": "tests/test_ac.py",
          "type": "DoctestModule"
        },
        {
          "nodeid": "tests/test_ac.py",
          "type": "Module"
        },
        {
          "nodeid": "tests/test_ac_hsm.py",
          "type": "DoctestModule"
        },
        {
          "nodeid": "tests/test_ac_hsm.py",
          "type": "Module"
        },
        {
          "nodeid": "tests/test_cvn_hsm.py",
          "type": "DoctestModule"
        },
        {
          "nodeid": "tests/test_cvn_hsm.py",
          "type": "Module"
        },
        {
          "nodeid": "tests/test_cvv.py",
          "type": "DoctestModule"
        },
        {
          "nodeid": "tests/test_cvv.py",
          "type": "Module"
        },
        {
          "nodeid": "tests/test_cvv_hsm.py",
          "type": "DoctestModule"
        },
        {
          "nodeid": "tests/test_cvv_hsm.py",
          "type": "Module"
        },
        {
          "nodeid": "tests/test_kd.py",
          "type": "DoctestModule"
        },
        {
          "nodeid": "tests/test_kd.py",
          "type": "Module"
        },
        {
          "nodeid": "tests/test_kd_hsm.py",
          "type": "DoctestModule"
        },
        {
          "nodeid": "tests/test_kd_hsm.py",
          "type": "Module"
        },
        {
          "nodeid": "tests/test_mac.py",
          "type": "DoctestModule"
        },
        {
          "nodeid": "tests/test_mac.py",
          "type": "Module"
        },
        {
          "nodeid": "tests/test_sm.py",
          "type": "DoctestModule"
        },
        {
          "nodeid": "tests/test_sm.py",
          "type": "Module"
        },
        {
          "nodeid": "tests/test_sm_hsm.py",
          "type": "DoctestModule"
        },
        {
          "nodeid": "tests/test_sm_hsm.py",
          "type": "Module"
        },
        {
          "nodeid": "tests/test_tlv.py",
          "type": "DoctestModule"
        },
        {
          "nodeid": "tests/test_tlv.py",
          "type": "Module"
        }
      ]
    },
    {
      "nodeid": "pyemv/__init__.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "pyemv/__init__.py::pyemv",
          "type": "DoctestItem",
          "lineno": 0
        }
      ]
    },
    {
      "nodeid": "pyemv/ac.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "pyemv/ac.py::pyemv.ac",
          "type": "DoctestItem",
          "lineno": 0
        },
        {
          "nodeid": "pyemv/ac.py::pyemv.ac.generate_ac",
          "type": "DoctestItem",
          "lineno": 54
        },
        {
          "nodeid": "pyemv/ac.py::pyemv.ac.generate_arpc_1",
          "type": "DoctestItem",
          "lineno": 168
        },
        {
          "nodeid": "pyemv/ac.py::pyemv.ac.generate_arpc_2",
          "type": "DoctestItem",
          "lineno": 240
        }
      ]
    },
    {
      "nodeid": "pyemv/cvn.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "pyemv/cvn.py::pyemv.cvn",
          "type": "DoctestItem",
          "lineno": 0
        }
      ]
    },
    {
      "nodeid": "pyemv/cvv.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "pyemv/cvv.py::pyemv.cvv.generate_cvc3",
          "type": "DoctestItem",
          "lineno": 12
        }
      ]
    },
    {
      "nodeid": "pyemv/kd.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "pyemv/kd.py::pyemv.kd",
          "type": "DoctestItem",
          "lineno": 0
        },
        {
          "nodeid": "pyemv/kd.py::pyemv.kd.derive_common_sk",
          "type": "DoctestItem",
          "lineno": 200
        },
        {
          "nodeid": "pyemv/kd.py::pyemv.kd.derive_emv2000_tree_sk",
          "type": "DoctestItem",
          "lineno": 318
        },
        {
          "nodeid": "pyemv/kd.py::pyemv.kd.derive_icc_mk_a",
          "type": "DoctestItem",
          "lineno": 33
        },
        {
          "nodeid": "pyemv/kd.py::pyemv.kd.derive_icc_mk_b",
          "type": "DoctestItem",
          "lineno": 102
        },
        {
          "nodeid": "pyemv/kd.py::pyemv.kd.derive_visa_sm_sk",
          "type": "DoctestItem",
          "lineno": 263
        }
      ]
    },
    {
      "nodeid": "pyemv/mac.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "pyemv/mac.py::pyemv.mac.mac_iso9797_3",
          "type": "DoctestItem",
          "lineno": 17
        },
        {
          "nodeid": "pyemv/mac.py::pyemv.mac.pad_iso9797_1",
          "type": "DoctestItem",
          "lineno": 92
        },
        {
          "nodeid": "pyemv/mac.py::pyemv.mac.pad_iso9797_2",
          "type": "DoctestItem",
          "lineno": 135
        }
      ]
    },
    {
      "nodeid": "pyemv/sm.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "pyemv/sm.py::pyemv.sm",
          "type": "DoctestItem",
          "lineno": 0
        },
        {
          "nodeid": "pyemv/sm.py::pyemv.sm.encrypt_command_data",
          "type": "DoctestItem",
          "lineno": 119
        },
        {
          "nodeid": "pyemv/sm.py::pyemv.sm.format_iso9564_2_pin_block",
          "type": "DoctestItem",
          "lineno": 291
        },
        {
          "nodeid": "pyemv/sm.py::pyemv.sm.format_vis_pin_block",
          "type": "DoctestItem",
          "lineno": 222
        },
        {
          "nodeid": "pyemv/sm.py::pyemv.sm.generate_command_mac",
          "type": "DoctestItem",
          "lineno": 46
        }
      ]
    },
    {
      "nodeid": "pyemv/tlv.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "pyemv/tlv.py::pyemv.tlv",
          "type": "DoctestItem",
          "lineno": 0
        },
        {
          "nodeid": "pyemv/tlv.py::pyemv.tlv.decode",
          "type": "DoctestItem",
          "lineno": 106
        },
        {
          "nodeid": "pyemv/tlv.py::pyemv.tlv.encode",
          "type": "DoctestItem",
          "lineno": 278
        }
      ]
    },
    {
      "nodeid": "pyemv/tools.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "pyemv/tools.py::pyemv.tools.adjust_key_parity",
          "type": "DoctestItem",
          "lineno": 65
        },
        {
          "nodeid": "pyemv/tools.py::pyemv.tools.encrypt_tdes_cbc",
          "type": "DoctestItem",
          "lineno": 120
        },
        {
          "nodeid": "pyemv/tools.py::pyemv.tools.encrypt_tdes_ecb",
          "type": "DoctestItem",
          "lineno": 149
        },
        {
          "nodeid": "pyemv/tools.py::pyemv.tools.key_check_digits",
          "type": "DoctestItem",
          "lineno": 94
        }
      ]
    },
    {
      "nodeid": "pyemv",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "pyemv/__init__.py",
          "type": "DoctestModule"
        },
        {
          "nodeid": "pyemv/ac.py",
          "type": "DoctestModule"
        },
        {
          "nodeid": "pyemv/cvn.py",
          "type": "DoctestModule"
        },
        {
          "nodeid": "pyemv/cvv.py",
          "type": "DoctestModule"
        },
        {
          "nodeid": "pyemv/kd.py",
          "type": "DoctestModule"
        },
        {
          "nodeid": "pyemv/mac.py",
          "type": "DoctestModule"
        },
        {
          "nodeid": "pyemv/sm.py",
          "type": "DoctestModule"
        },
        {
          "nodeid": "pyemv/tlv.py",
          "type": "DoctestModule"
        },
        {
          "nodeid": "pyemv/tools.py",
          "type": "DoctestModule"
        }
      ]
    }
  ],
  "tests": [
    {
      "nodeid": "tests/test_ac.py::test_generate_ac_exception",
      "lineno": 5,
      "outcome": "passed",
      "keywords": [
        "test_generate_ac_exception",
        "test_ac.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_ac.py::test_generate_arpc_1_exception",
      "lineno": 38,
      "outcome": "passed",
      "keywords": [
        "test_generate_arpc_1_exception",
        "test_ac.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_ac.py::test_generate_arpc_2_exception",
      "lineno": 106,
      "outcome": "passed",
      "keywords": [
        "test_generate_arpc_2_exception",
        "test_ac.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_ac_hsm.py::test_generate_ac_emv_arpc1",
      "lineno": 3,
      "outcome": "failed",
      "keywords": [
        "test_generate_ac_emv_arpc1",
        "test_ac_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_ac_hsm.py",
            "lineno": 31,
            "message": ""
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "def test_generate_ac_emv_arpc1() -> None:\n        r\"\"\"\n        Test generate AC with EMV padding (\\x80 padding).\n    \n        Master Key Derivation = Option A\n        ARQC verification using Common Session Key Derivation\n        ARPC generation using ICC Master Key\n        ARPC Method = 1\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk, 2).hex().upper() == \"08D7\"\n    \n        # Derive ICC master key.\n        pan = \"9901234567890123\"\n        psn = \"45\"\n        icc_mk = kd.derive_icc_mk_a(iss_mk, pan, psn)\n        assert tools.key_check_digits(icc_mk, 2).hex().upper() == \"1DA5\"\n    \n        # Verify AC session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"1234567890123456\")\n        sk_ac = kd.derive_common_sk(icc_mk, r)\n        assert tools.key_check_digits(sk_ac, 2).hex().upper() == \"0995\"\n    \n        # ARQC validation using Session Key\n        cipher_text = bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\")\n>       arqc = ac.generate_ac(sk_ac, cipher_text, ac.PaddingType.EMV)\n\ntests\\test_ac_hsm.py:31: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'>sk\\xf8\\xd3vd4'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_ac_hsm.py::test_generate_ac_default_emv_arpc1",
      "lineno": 39,
      "outcome": "failed",
      "keywords": [
        "test_generate_ac_default_emv_arpc1",
        "test_ac_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_ac_hsm.py",
            "lineno": 67,
            "message": ""
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "def test_generate_ac_default_emv_arpc1() -> None:\n        r\"\"\"\n        Test generate AC with default EMV padding (\\x80 padding).\n    \n        Master Key Derivation = Option A\n        ARQC verification using Common Session Key Derivation\n        ARPC generation using ICC Master Key\n        ARPC Method = 1\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk, 2).hex().upper() == \"08D7\"\n    \n        # Derive ICC master key.\n        pan = \"9901234567890123\"\n        psn = \"45\"\n        icc_mk = kd.derive_icc_mk_a(iss_mk, pan, psn)\n        assert tools.key_check_digits(icc_mk, 2).hex().upper() == \"1DA5\"\n    \n        # Verify AC session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"1234567890123456\")\n        sk_ac = kd.derive_common_sk(icc_mk, r)\n        assert tools.key_check_digits(sk_ac, 2).hex().upper() == \"0995\"\n    \n        # ARQC validation using Session Key\n        cipher_text = bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\")\n>       arqc = ac.generate_ac(sk_ac, cipher_text)\n\ntests\\test_ac_hsm.py:67: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'>sk\\xf8\\xd3vd4'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_ac_hsm.py::test_generate_ac_visa_aprc1",
      "lineno": 75,
      "outcome": "failed",
      "keywords": [
        "test_generate_ac_visa_aprc1",
        "test_ac_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_ac_hsm.py",
            "lineno": 103,
            "message": ""
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "def test_generate_ac_visa_aprc1() -> None:\n        r\"\"\"\n        Test generate AC with Visa padding (\\x00 padding).\n    \n        Master Key Derivation = Option A\n        ARQC verification using Common Session Key Derivation\n        ARPC generation using ICC Master Key\n        ARPC Method = 1\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk, 2).hex().upper() == \"08D7\"\n    \n        # Derive ICC master key\n        pan = \"9901234567890123\"\n        psn = \"45\"\n        icc_mk = kd.derive_icc_mk_a(iss_mk, pan, psn)\n        assert tools.key_check_digits(icc_mk, 2).hex().upper() == \"1DA5\"\n    \n        # Verify AC session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"1234567890123456\")\n        sk_ac = kd.derive_common_sk(icc_mk, r)\n        assert tools.key_check_digits(sk_ac, 2).hex().upper() == \"0995\"\n    \n        # ARQC validation using Session Key\n        cipher_text = bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF01\")\n>       arqc = ac.generate_ac(sk_ac, cipher_text, ac.PaddingType.VISA)\n\ntests\\test_ac_hsm.py:103: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'>sk\\xf8\\xd3vd4'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_ac_hsm.py::test_generate_ac_visa_aprc1_no_padding_required",
      "lineno": 111,
      "outcome": "failed",
      "keywords": [
        "test_generate_ac_visa_aprc1_no_padding_required",
        "test_ac_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_ac_hsm.py",
            "lineno": 140,
            "message": ""
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "def test_generate_ac_visa_aprc1_no_padding_required() -> None:\n        r\"\"\"\n        Test generate AC with Visa padding (\\x00 padding).\n        However, no padding is required. The data is already multiple of 8.\n    \n        Master Key Derivation = Option A\n        ARQC verification using Common Session Key Derivation\n        ARPC generation using ICC Master Key\n        ARPC Method = 1\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk, 2).hex().upper() == \"08D7\"\n    \n        # Derive ICC master key\n        pan = \"9901234567890123\"\n        psn = \"45\"\n        icc_mk = kd.derive_icc_mk_a(iss_mk, pan, psn)\n        assert tools.key_check_digits(icc_mk, 2).hex().upper() == \"1DA5\"\n    \n        # Verify AC session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"1234567890123456\")\n        sk_ac = kd.derive_common_sk(icc_mk, r)\n        assert tools.key_check_digits(sk_ac, 2).hex().upper() == \"0995\"\n    \n        # ARQC validation using Session Key\n        cipher_text = bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\")\n>       arqc = ac.generate_ac(sk_ac, cipher_text, ac.PaddingType.VISA)\n\ntests\\test_ac_hsm.py:140: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'>sk\\xf8\\xd3vd4'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_ac_hsm.py::test_generate_arpc2",
      "lineno": 148,
      "outcome": "failed",
      "keywords": [
        "test_generate_arpc2",
        "test_ac_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_ac_hsm.py",
            "lineno": 176,
            "message": ""
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "def test_generate_arpc2() -> None:\n        r\"\"\"\n        Test generate ARPC using method 2.\n    \n        Master Key Derivation = Option A\n        ARQC verification using Common Session Key Derivation\n        ARPC generation using Common Session Key\n        ARPC Method = 2\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk, 2).hex().upper() == \"08D7\"\n    \n        # Derive ICC master key\n        pan = \"9901234567890123\"\n        psn = \"45\"\n        icc_mk = kd.derive_icc_mk_a(iss_mk, pan, psn)\n        assert tools.key_check_digits(icc_mk, 2).hex().upper() == \"1DA5\"\n    \n        # Verify AC session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"1234567890123456\")\n        sk_ac = kd.derive_common_sk(icc_mk, r)\n        assert tools.key_check_digits(sk_ac, 2).hex().upper() == \"0995\"\n    \n        # ARQC validation using Session Key\n        cipher_text = bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\")\n>       arqc = ac.generate_ac(sk_ac, cipher_text, ac.PaddingType.EMV)\n\ntests\\test_ac_hsm.py:176: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'>sk\\xf8\\xd3vd4'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_ac_hsm.py::test_generate_arpc2_no_prop_auth_data",
      "lineno": 185,
      "outcome": "failed",
      "keywords": [
        "test_generate_arpc2_no_prop_auth_data",
        "test_ac_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_ac_hsm.py",
            "lineno": 213,
            "message": ""
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "def test_generate_arpc2_no_prop_auth_data() -> None:\n        r\"\"\"\n        Test generate ARPC using method 2 without prop auth data.\n    \n        Master Key Derivation = Option A\n        ARQC verification using Common Session Key Derivation\n        ARPC generation using Common Session Key\n        ARPC Method = 2\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk, 2).hex().upper() == \"08D7\"\n    \n        # Derive ICC master key\n        pan = \"9901234567890123\"\n        psn = \"45\"\n        icc_mk = kd.derive_icc_mk_a(iss_mk, pan, psn)\n        assert tools.key_check_digits(icc_mk, 2).hex().upper() == \"1DA5\"\n    \n        # Verify AC session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"1234567890123456\")\n        sk_ac = kd.derive_common_sk(icc_mk, r)\n        assert tools.key_check_digits(sk_ac, 2).hex().upper() == \"0995\"\n    \n        # ARQC validation using Session Key\n        cipher_text = bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\")\n>       arqc = ac.generate_ac(sk_ac, cipher_text, ac.PaddingType.EMV)\n\ntests\\test_ac_hsm.py:213: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'>sk\\xf8\\xd3vd4'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_visa_cvn10[1234567890123456-00-9999-8888_0]",
      "lineno": 7,
      "outcome": "failed",
      "keywords": [
        "test_visa_cvn10[1234567890123456-00-9999-8888_0]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999-8888_0",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 39,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 196,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = b'1234567890123456', psn = b'00', pin = b'9999', current_pin = b'8888'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\", \"current_pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\", b\"8888\"),\n            (b\"1234567890123456\", \"00\", b\"9999\", \"8888\"),\n            (\"1234567890123456\", b\"00\", \"9999\", b\"8888\"),\n            (\"1234567890123456\", \"00\", \"9999\", \"8888\"),\n        ],\n    )\n    def test_visa_cvn10(\n        pan: Union[bytes, str],\n        psn: Union[bytes, str],\n        pin: Union[bytes, str],\n        current_pin: Union[bytes, str],\n    ) -> None:\n        \"\"\"Visa CVN 10\"\"\"\n        cvn10 = cvn.VisaCVN10(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Check ICC Master Keys\n        assert key_check_digits(cvn10.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn10.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn10.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n>       arqc = cvn10.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000004000\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000048000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"191105\"),\n            tag_9c=bytes.fromhex(\"01\"),\n            tag_9f37=bytes.fromhex(\"52BF4585\"),\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            cvr=bytes.fromhex(\"03A06010\"),\n        )\n\ntests\\test_cvn_hsm.py:39: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:196: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\x15O4\\x9d\\x85\\x85\\xcb\\x7f'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_visa_cvn10[1234567890123456-00-9999-8888_1]",
      "lineno": 7,
      "outcome": "failed",
      "keywords": [
        "test_visa_cvn10[1234567890123456-00-9999-8888_1]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999-8888_1",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 39,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 196,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = b'1234567890123456', psn = '00', pin = b'9999', current_pin = '8888'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\", \"current_pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\", b\"8888\"),\n            (b\"1234567890123456\", \"00\", b\"9999\", \"8888\"),\n            (\"1234567890123456\", b\"00\", \"9999\", b\"8888\"),\n            (\"1234567890123456\", \"00\", \"9999\", \"8888\"),\n        ],\n    )\n    def test_visa_cvn10(\n        pan: Union[bytes, str],\n        psn: Union[bytes, str],\n        pin: Union[bytes, str],\n        current_pin: Union[bytes, str],\n    ) -> None:\n        \"\"\"Visa CVN 10\"\"\"\n        cvn10 = cvn.VisaCVN10(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Check ICC Master Keys\n        assert key_check_digits(cvn10.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn10.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn10.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n>       arqc = cvn10.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000004000\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000048000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"191105\"),\n            tag_9c=bytes.fromhex(\"01\"),\n            tag_9f37=bytes.fromhex(\"52BF4585\"),\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            cvr=bytes.fromhex(\"03A06010\"),\n        )\n\ntests\\test_cvn_hsm.py:39: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:196: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\x15O4\\x9d\\x85\\x85\\xcb\\x7f'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_visa_cvn10[1234567890123456-00-9999-8888_2]",
      "lineno": 7,
      "outcome": "failed",
      "keywords": [
        "test_visa_cvn10[1234567890123456-00-9999-8888_2]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999-8888_2",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 39,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 196,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = '1234567890123456', psn = b'00', pin = '9999', current_pin = b'8888'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\", \"current_pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\", b\"8888\"),\n            (b\"1234567890123456\", \"00\", b\"9999\", \"8888\"),\n            (\"1234567890123456\", b\"00\", \"9999\", b\"8888\"),\n            (\"1234567890123456\", \"00\", \"9999\", \"8888\"),\n        ],\n    )\n    def test_visa_cvn10(\n        pan: Union[bytes, str],\n        psn: Union[bytes, str],\n        pin: Union[bytes, str],\n        current_pin: Union[bytes, str],\n    ) -> None:\n        \"\"\"Visa CVN 10\"\"\"\n        cvn10 = cvn.VisaCVN10(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Check ICC Master Keys\n        assert key_check_digits(cvn10.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn10.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn10.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n>       arqc = cvn10.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000004000\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000048000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"191105\"),\n            tag_9c=bytes.fromhex(\"01\"),\n            tag_9f37=bytes.fromhex(\"52BF4585\"),\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            cvr=bytes.fromhex(\"03A06010\"),\n        )\n\ntests\\test_cvn_hsm.py:39: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:196: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\x15O4\\x9d\\x85\\x85\\xcb\\x7f'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_visa_cvn10[1234567890123456-00-9999-8888_3]",
      "lineno": 7,
      "outcome": "failed",
      "keywords": [
        "test_visa_cvn10[1234567890123456-00-9999-8888_3]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999-8888_3",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 39,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 196,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = '1234567890123456', psn = '00', pin = '9999', current_pin = '8888'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\", \"current_pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\", b\"8888\"),\n            (b\"1234567890123456\", \"00\", b\"9999\", \"8888\"),\n            (\"1234567890123456\", b\"00\", \"9999\", b\"8888\"),\n            (\"1234567890123456\", \"00\", \"9999\", \"8888\"),\n        ],\n    )\n    def test_visa_cvn10(\n        pan: Union[bytes, str],\n        psn: Union[bytes, str],\n        pin: Union[bytes, str],\n        current_pin: Union[bytes, str],\n    ) -> None:\n        \"\"\"Visa CVN 10\"\"\"\n        cvn10 = cvn.VisaCVN10(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Check ICC Master Keys\n        assert key_check_digits(cvn10.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn10.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn10.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n>       arqc = cvn10.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000004000\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000048000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"191105\"),\n            tag_9c=bytes.fromhex(\"01\"),\n            tag_9f37=bytes.fromhex(\"52BF4585\"),\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            cvr=bytes.fromhex(\"03A06010\"),\n        )\n\ntests\\test_cvn_hsm.py:39: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:196: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\x15O4\\x9d\\x85\\x85\\xcb\\x7f'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_visa_cvn18[1234567890123456-00-9999-8888_0]",
      "lineno": 104,
      "outcome": "failed",
      "keywords": [
        "test_visa_cvn18[1234567890123456-00-9999-8888_0]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999-8888_0",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 136,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 475,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = b'1234567890123456', psn = b'00', pin = b'9999', current_pin = b'8888'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\", \"current_pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\", b\"8888\"),\n            (b\"1234567890123456\", \"00\", b\"9999\", \"8888\"),\n            (\"1234567890123456\", b\"00\", \"9999\", b\"8888\"),\n            (\"1234567890123456\", \"00\", \"9999\", \"8888\"),\n        ],\n    )\n    def test_visa_cvn18(\n        pan: Union[bytes, str],\n        psn: Union[bytes, str],\n        pin: Union[bytes, str],\n        current_pin: Union[bytes, str],\n    ) -> None:\n        \"\"\"Visa CVN 18\"\"\"\n        cvn18 = cvn.VisaCVN18(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Check ICC Master Keys\n        assert key_check_digits(cvn18.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn18.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn18.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n>       arqc = cvn18.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000004000\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000048000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"191105\"),\n            tag_9c=bytes.fromhex(\"01\"),\n            tag_9f37=bytes.fromhex(\"52BF4585\"),\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            tag_9f10=bytes.fromhex(\"06011203A0B800\"),\n        )\n\ntests\\test_cvn_hsm.py:136: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:475: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'Ck\\x94*\\xd67\\xe0\\x85'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_visa_cvn18[1234567890123456-00-9999-8888_1]",
      "lineno": 104,
      "outcome": "failed",
      "keywords": [
        "test_visa_cvn18[1234567890123456-00-9999-8888_1]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999-8888_1",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 136,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 475,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = b'1234567890123456', psn = '00', pin = b'9999', current_pin = '8888'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\", \"current_pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\", b\"8888\"),\n            (b\"1234567890123456\", \"00\", b\"9999\", \"8888\"),\n            (\"1234567890123456\", b\"00\", \"9999\", b\"8888\"),\n            (\"1234567890123456\", \"00\", \"9999\", \"8888\"),\n        ],\n    )\n    def test_visa_cvn18(\n        pan: Union[bytes, str],\n        psn: Union[bytes, str],\n        pin: Union[bytes, str],\n        current_pin: Union[bytes, str],\n    ) -> None:\n        \"\"\"Visa CVN 18\"\"\"\n        cvn18 = cvn.VisaCVN18(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Check ICC Master Keys\n        assert key_check_digits(cvn18.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn18.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn18.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n>       arqc = cvn18.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000004000\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000048000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"191105\"),\n            tag_9c=bytes.fromhex(\"01\"),\n            tag_9f37=bytes.fromhex(\"52BF4585\"),\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            tag_9f10=bytes.fromhex(\"06011203A0B800\"),\n        )\n\ntests\\test_cvn_hsm.py:136: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:475: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'Ck\\x94*\\xd67\\xe0\\x85'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_visa_cvn18[1234567890123456-00-9999-8888_2]",
      "lineno": 104,
      "outcome": "failed",
      "keywords": [
        "test_visa_cvn18[1234567890123456-00-9999-8888_2]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999-8888_2",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 136,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 475,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = '1234567890123456', psn = b'00', pin = '9999', current_pin = b'8888'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\", \"current_pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\", b\"8888\"),\n            (b\"1234567890123456\", \"00\", b\"9999\", \"8888\"),\n            (\"1234567890123456\", b\"00\", \"9999\", b\"8888\"),\n            (\"1234567890123456\", \"00\", \"9999\", \"8888\"),\n        ],\n    )\n    def test_visa_cvn18(\n        pan: Union[bytes, str],\n        psn: Union[bytes, str],\n        pin: Union[bytes, str],\n        current_pin: Union[bytes, str],\n    ) -> None:\n        \"\"\"Visa CVN 18\"\"\"\n        cvn18 = cvn.VisaCVN18(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Check ICC Master Keys\n        assert key_check_digits(cvn18.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn18.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn18.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n>       arqc = cvn18.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000004000\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000048000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"191105\"),\n            tag_9c=bytes.fromhex(\"01\"),\n            tag_9f37=bytes.fromhex(\"52BF4585\"),\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            tag_9f10=bytes.fromhex(\"06011203A0B800\"),\n        )\n\ntests\\test_cvn_hsm.py:136: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:475: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'Ck\\x94*\\xd67\\xe0\\x85'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_visa_cvn18[1234567890123456-00-9999-8888_3]",
      "lineno": 104,
      "outcome": "failed",
      "keywords": [
        "test_visa_cvn18[1234567890123456-00-9999-8888_3]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999-8888_3",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 136,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 475,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = '1234567890123456', psn = '00', pin = '9999', current_pin = '8888'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\", \"current_pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\", b\"8888\"),\n            (b\"1234567890123456\", \"00\", b\"9999\", \"8888\"),\n            (\"1234567890123456\", b\"00\", \"9999\", b\"8888\"),\n            (\"1234567890123456\", \"00\", \"9999\", \"8888\"),\n        ],\n    )\n    def test_visa_cvn18(\n        pan: Union[bytes, str],\n        psn: Union[bytes, str],\n        pin: Union[bytes, str],\n        current_pin: Union[bytes, str],\n    ) -> None:\n        \"\"\"Visa CVN 18\"\"\"\n        cvn18 = cvn.VisaCVN18(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Check ICC Master Keys\n        assert key_check_digits(cvn18.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn18.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn18.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n>       arqc = cvn18.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000004000\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000048000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"191105\"),\n            tag_9c=bytes.fromhex(\"01\"),\n            tag_9f37=bytes.fromhex(\"52BF4585\"),\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            tag_9f10=bytes.fromhex(\"06011203A0B800\"),\n        )\n\ntests\\test_cvn_hsm.py:136: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:475: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'Ck\\x94*\\xd67\\xe0\\x85'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_visa_cvn22[1234567890123456-00-9999-8888_0]",
      "lineno": 203,
      "outcome": "failed",
      "keywords": [
        "test_visa_cvn22[1234567890123456-00-9999-8888_0]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999-8888_0",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 235,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 772,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = b'1234567890123456', psn = b'00', pin = b'9999', current_pin = b'8888'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\", \"current_pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\", b\"8888\"),\n            (b\"1234567890123456\", \"00\", b\"9999\", \"8888\"),\n            (\"1234567890123456\", b\"00\", \"9999\", b\"8888\"),\n            (\"1234567890123456\", \"00\", \"9999\", \"8888\"),\n        ],\n    )\n    def test_visa_cvn22(\n        pan: Union[bytes, str],\n        psn: Union[bytes, str],\n        pin: Union[bytes, str],\n        current_pin: Union[bytes, str],\n    ) -> None:\n        \"\"\"Visa CVN 22\"\"\"\n        cvn22 = cvn.VisaCVN22(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Check ICC Master Keys\n        assert key_check_digits(cvn22.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn22.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn22.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n>       arqc = cvn22.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000004000\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000048000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"191105\"),\n            tag_9c=bytes.fromhex(\"01\"),\n            tag_9f37=bytes.fromhex(\"52BF4585\"),\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            tag_9f10=bytes.fromhex(\"06011203A0B800\"),\n        )\n\ntests\\test_cvn_hsm.py:235: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:772: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'Ck\\x94*\\xd67\\xe0\\x85'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_visa_cvn22[1234567890123456-00-9999-8888_1]",
      "lineno": 203,
      "outcome": "failed",
      "keywords": [
        "test_visa_cvn22[1234567890123456-00-9999-8888_1]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999-8888_1",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 235,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 772,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = b'1234567890123456', psn = '00', pin = b'9999', current_pin = '8888'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\", \"current_pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\", b\"8888\"),\n            (b\"1234567890123456\", \"00\", b\"9999\", \"8888\"),\n            (\"1234567890123456\", b\"00\", \"9999\", b\"8888\"),\n            (\"1234567890123456\", \"00\", \"9999\", \"8888\"),\n        ],\n    )\n    def test_visa_cvn22(\n        pan: Union[bytes, str],\n        psn: Union[bytes, str],\n        pin: Union[bytes, str],\n        current_pin: Union[bytes, str],\n    ) -> None:\n        \"\"\"Visa CVN 22\"\"\"\n        cvn22 = cvn.VisaCVN22(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Check ICC Master Keys\n        assert key_check_digits(cvn22.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn22.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn22.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n>       arqc = cvn22.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000004000\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000048000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"191105\"),\n            tag_9c=bytes.fromhex(\"01\"),\n            tag_9f37=bytes.fromhex(\"52BF4585\"),\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            tag_9f10=bytes.fromhex(\"06011203A0B800\"),\n        )\n\ntests\\test_cvn_hsm.py:235: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:772: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'Ck\\x94*\\xd67\\xe0\\x85'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_visa_cvn22[1234567890123456-00-9999-8888_2]",
      "lineno": 203,
      "outcome": "failed",
      "keywords": [
        "test_visa_cvn22[1234567890123456-00-9999-8888_2]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999-8888_2",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 235,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 772,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = '1234567890123456', psn = b'00', pin = '9999', current_pin = b'8888'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\", \"current_pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\", b\"8888\"),\n            (b\"1234567890123456\", \"00\", b\"9999\", \"8888\"),\n            (\"1234567890123456\", b\"00\", \"9999\", b\"8888\"),\n            (\"1234567890123456\", \"00\", \"9999\", \"8888\"),\n        ],\n    )\n    def test_visa_cvn22(\n        pan: Union[bytes, str],\n        psn: Union[bytes, str],\n        pin: Union[bytes, str],\n        current_pin: Union[bytes, str],\n    ) -> None:\n        \"\"\"Visa CVN 22\"\"\"\n        cvn22 = cvn.VisaCVN22(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Check ICC Master Keys\n        assert key_check_digits(cvn22.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn22.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn22.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n>       arqc = cvn22.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000004000\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000048000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"191105\"),\n            tag_9c=bytes.fromhex(\"01\"),\n            tag_9f37=bytes.fromhex(\"52BF4585\"),\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            tag_9f10=bytes.fromhex(\"06011203A0B800\"),\n        )\n\ntests\\test_cvn_hsm.py:235: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:772: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'Ck\\x94*\\xd67\\xe0\\x85'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_visa_cvn22[1234567890123456-00-9999-8888_3]",
      "lineno": 203,
      "outcome": "failed",
      "keywords": [
        "test_visa_cvn22[1234567890123456-00-9999-8888_3]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999-8888_3",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 235,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 772,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = '1234567890123456', psn = '00', pin = '9999', current_pin = '8888'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\", \"current_pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\", b\"8888\"),\n            (b\"1234567890123456\", \"00\", b\"9999\", \"8888\"),\n            (\"1234567890123456\", b\"00\", \"9999\", b\"8888\"),\n            (\"1234567890123456\", \"00\", \"9999\", \"8888\"),\n        ],\n    )\n    def test_visa_cvn22(\n        pan: Union[bytes, str],\n        psn: Union[bytes, str],\n        pin: Union[bytes, str],\n        current_pin: Union[bytes, str],\n    ) -> None:\n        \"\"\"Visa CVN 22\"\"\"\n        cvn22 = cvn.VisaCVN22(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Check ICC Master Keys\n        assert key_check_digits(cvn22.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn22.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn22.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n>       arqc = cvn22.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000004000\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000048000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"191105\"),\n            tag_9c=bytes.fromhex(\"01\"),\n            tag_9f37=bytes.fromhex(\"52BF4585\"),\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            tag_9f10=bytes.fromhex(\"06011203A0B800\"),\n        )\n\ntests\\test_cvn_hsm.py:235: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:772: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'Ck\\x94*\\xd67\\xe0\\x85'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_interac_cvn133[1234567890123456-00-9999_0]",
      "lineno": 312,
      "outcome": "failed",
      "keywords": [
        "test_interac_cvn133[1234567890123456-00-9999_0]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999_0",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 342,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 1082,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = b'1234567890123456', psn = b'00', pin = b'9999'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\"),\n            (b\"1234567890123456\", \"00\", b\"9999\"),\n            (\"1234567890123456\", b\"00\", \"9999\"),\n            (\"1234567890123456\", \"00\", \"9999\"),\n        ],\n    )\n    def test_interac_cvn133(\n        pan: Union[bytes, str], psn: Union[bytes, str], pin: Union[bytes, str]\n    ) -> None:\n        \"\"\"Interac CVN 133\"\"\"\n        cvn133 = cvn.InteracCVN133(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Derive ICC Master Keys\n        assert key_check_digits(cvn133.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn133.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn133.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n        un = bytes.fromhex(\"ABCDEF12\")\n>       arqc = cvn133.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000009999\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000000000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"209906\"),\n            tag_9c=bytes.fromhex(\"00\"),\n            tag_9f37=un,\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            tag_9f10=bytes.fromhex(\"1501850440B100000000B00000000000000000000000\"),\n        )\n\ntests\\test_cvn_hsm.py:342: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:1082: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b']\\x8f7\\xbc\\xd9\\xe5\\xdah'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_interac_cvn133[1234567890123456-00-9999_1]",
      "lineno": 312,
      "outcome": "failed",
      "keywords": [
        "test_interac_cvn133[1234567890123456-00-9999_1]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999_1",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 342,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 1082,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = b'1234567890123456', psn = '00', pin = b'9999'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\"),\n            (b\"1234567890123456\", \"00\", b\"9999\"),\n            (\"1234567890123456\", b\"00\", \"9999\"),\n            (\"1234567890123456\", \"00\", \"9999\"),\n        ],\n    )\n    def test_interac_cvn133(\n        pan: Union[bytes, str], psn: Union[bytes, str], pin: Union[bytes, str]\n    ) -> None:\n        \"\"\"Interac CVN 133\"\"\"\n        cvn133 = cvn.InteracCVN133(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Derive ICC Master Keys\n        assert key_check_digits(cvn133.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn133.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn133.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n        un = bytes.fromhex(\"ABCDEF12\")\n>       arqc = cvn133.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000009999\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000000000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"209906\"),\n            tag_9c=bytes.fromhex(\"00\"),\n            tag_9f37=un,\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            tag_9f10=bytes.fromhex(\"1501850440B100000000B00000000000000000000000\"),\n        )\n\ntests\\test_cvn_hsm.py:342: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:1082: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b']\\x8f7\\xbc\\xd9\\xe5\\xdah'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_interac_cvn133[1234567890123456-00-9999_2]",
      "lineno": 312,
      "outcome": "failed",
      "keywords": [
        "test_interac_cvn133[1234567890123456-00-9999_2]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999_2",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 342,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 1082,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = '1234567890123456', psn = b'00', pin = '9999'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\"),\n            (b\"1234567890123456\", \"00\", b\"9999\"),\n            (\"1234567890123456\", b\"00\", \"9999\"),\n            (\"1234567890123456\", \"00\", \"9999\"),\n        ],\n    )\n    def test_interac_cvn133(\n        pan: Union[bytes, str], psn: Union[bytes, str], pin: Union[bytes, str]\n    ) -> None:\n        \"\"\"Interac CVN 133\"\"\"\n        cvn133 = cvn.InteracCVN133(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Derive ICC Master Keys\n        assert key_check_digits(cvn133.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn133.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn133.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n        un = bytes.fromhex(\"ABCDEF12\")\n>       arqc = cvn133.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000009999\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000000000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"209906\"),\n            tag_9c=bytes.fromhex(\"00\"),\n            tag_9f37=un,\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            tag_9f10=bytes.fromhex(\"1501850440B100000000B00000000000000000000000\"),\n        )\n\ntests\\test_cvn_hsm.py:342: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:1082: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b']\\x8f7\\xbc\\xd9\\xe5\\xdah'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_interac_cvn133[1234567890123456-00-9999_3]",
      "lineno": 312,
      "outcome": "failed",
      "keywords": [
        "test_interac_cvn133[1234567890123456-00-9999_3]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999_3",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 342,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 1082,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = '1234567890123456', psn = '00', pin = '9999'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\"),\n            (b\"1234567890123456\", \"00\", b\"9999\"),\n            (\"1234567890123456\", b\"00\", \"9999\"),\n            (\"1234567890123456\", \"00\", \"9999\"),\n        ],\n    )\n    def test_interac_cvn133(\n        pan: Union[bytes, str], psn: Union[bytes, str], pin: Union[bytes, str]\n    ) -> None:\n        \"\"\"Interac CVN 133\"\"\"\n        cvn133 = cvn.InteracCVN133(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Derive ICC Master Keys\n        assert key_check_digits(cvn133.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn133.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn133.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n        un = bytes.fromhex(\"ABCDEF12\")\n>       arqc = cvn133.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000009999\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000000000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"209906\"),\n            tag_9c=bytes.fromhex(\"00\"),\n            tag_9f37=un,\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            tag_9f10=bytes.fromhex(\"1501850440B100000000B00000000000000000000000\"),\n        )\n\ntests\\test_cvn_hsm.py:342: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:1082: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b']\\x8f7\\xbc\\xd9\\xe5\\xdah'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn16[1234567890123456-00-9999_0]",
      "lineno": 397,
      "outcome": "failed",
      "keywords": [
        "test_mastercard_cvn16[1234567890123456-00-9999_0]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999_0",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 427,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 1368,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = b'1234567890123456', psn = b'00', pin = b'9999'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\"),\n            (b\"1234567890123456\", \"00\", b\"9999\"),\n            (\"1234567890123456\", b\"00\", \"9999\"),\n            (\"1234567890123456\", \"00\", \"9999\"),\n        ],\n    )\n    def test_mastercard_cvn16(\n        pan: Union[bytes, str], psn: Union[bytes, str], pin: Union[bytes, str]\n    ) -> None:\n        \"\"\"MasterCard CVN 16\"\"\"\n        cvn16 = cvn.MasterCardCVN16(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Derive ICC Master Keys\n        assert key_check_digits(cvn16.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn16.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn16.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n        un = bytes.fromhex(\"ABCDEF12\")\n>       arqc = cvn16.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000009999\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000000000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"209906\"),\n            tag_9c=bytes.fromhex(\"00\"),\n            tag_9f37=un,\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            cvr=bytes.fromhex(\"A00003220000\"),  # 9F10: 0110A00003220000000000000000000000FF\n        )\n\ntests\\test_cvn_hsm.py:427: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:1368: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b']\\x8f7\\xbc\\xd9\\xe5\\xdah'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn16[1234567890123456-00-9999_1]",
      "lineno": 397,
      "outcome": "failed",
      "keywords": [
        "test_mastercard_cvn16[1234567890123456-00-9999_1]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999_1",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 427,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 1368,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = b'1234567890123456', psn = '00', pin = b'9999'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\"),\n            (b\"1234567890123456\", \"00\", b\"9999\"),\n            (\"1234567890123456\", b\"00\", \"9999\"),\n            (\"1234567890123456\", \"00\", \"9999\"),\n        ],\n    )\n    def test_mastercard_cvn16(\n        pan: Union[bytes, str], psn: Union[bytes, str], pin: Union[bytes, str]\n    ) -> None:\n        \"\"\"MasterCard CVN 16\"\"\"\n        cvn16 = cvn.MasterCardCVN16(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Derive ICC Master Keys\n        assert key_check_digits(cvn16.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn16.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn16.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n        un = bytes.fromhex(\"ABCDEF12\")\n>       arqc = cvn16.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000009999\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000000000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"209906\"),\n            tag_9c=bytes.fromhex(\"00\"),\n            tag_9f37=un,\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            cvr=bytes.fromhex(\"A00003220000\"),  # 9F10: 0110A00003220000000000000000000000FF\n        )\n\ntests\\test_cvn_hsm.py:427: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:1368: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b']\\x8f7\\xbc\\xd9\\xe5\\xdah'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn16[1234567890123456-00-9999_2]",
      "lineno": 397,
      "outcome": "failed",
      "keywords": [
        "test_mastercard_cvn16[1234567890123456-00-9999_2]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999_2",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 427,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 1368,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = '1234567890123456', psn = b'00', pin = '9999'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\"),\n            (b\"1234567890123456\", \"00\", b\"9999\"),\n            (\"1234567890123456\", b\"00\", \"9999\"),\n            (\"1234567890123456\", \"00\", \"9999\"),\n        ],\n    )\n    def test_mastercard_cvn16(\n        pan: Union[bytes, str], psn: Union[bytes, str], pin: Union[bytes, str]\n    ) -> None:\n        \"\"\"MasterCard CVN 16\"\"\"\n        cvn16 = cvn.MasterCardCVN16(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Derive ICC Master Keys\n        assert key_check_digits(cvn16.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn16.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn16.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n        un = bytes.fromhex(\"ABCDEF12\")\n>       arqc = cvn16.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000009999\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000000000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"209906\"),\n            tag_9c=bytes.fromhex(\"00\"),\n            tag_9f37=un,\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            cvr=bytes.fromhex(\"A00003220000\"),  # 9F10: 0110A00003220000000000000000000000FF\n        )\n\ntests\\test_cvn_hsm.py:427: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:1368: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b']\\x8f7\\xbc\\xd9\\xe5\\xdah'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn16[1234567890123456-00-9999_3]",
      "lineno": 397,
      "outcome": "failed",
      "keywords": [
        "test_mastercard_cvn16[1234567890123456-00-9999_3]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999_3",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 427,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 1368,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = '1234567890123456', psn = '00', pin = '9999'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\"),\n            (b\"1234567890123456\", \"00\", b\"9999\"),\n            (\"1234567890123456\", b\"00\", \"9999\"),\n            (\"1234567890123456\", \"00\", \"9999\"),\n        ],\n    )\n    def test_mastercard_cvn16(\n        pan: Union[bytes, str], psn: Union[bytes, str], pin: Union[bytes, str]\n    ) -> None:\n        \"\"\"MasterCard CVN 16\"\"\"\n        cvn16 = cvn.MasterCardCVN16(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Derive ICC Master Keys\n        assert key_check_digits(cvn16.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn16.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn16.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n        un = bytes.fromhex(\"ABCDEF12\")\n>       arqc = cvn16.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000009999\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000000000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"209906\"),\n            tag_9c=bytes.fromhex(\"00\"),\n            tag_9f37=un,\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            cvr=bytes.fromhex(\"A00003220000\"),  # 9F10: 0110A00003220000000000000000000000FF\n        )\n\ntests\\test_cvn_hsm.py:427: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:1368: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b']\\x8f7\\xbc\\xd9\\xe5\\xdah'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn17[1234567890123456-00-9999_0]",
      "lineno": 481,
      "outcome": "failed",
      "keywords": [
        "test_mastercard_cvn17[1234567890123456-00-9999_0]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999_0",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 511,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 1687,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = b'1234567890123456', psn = b'00', pin = b'9999'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\"),\n            (b\"1234567890123456\", \"00\", b\"9999\"),\n            (\"1234567890123456\", b\"00\", \"9999\"),\n            (\"1234567890123456\", \"00\", \"9999\"),\n        ],\n    )\n    def test_mastercard_cvn17(\n        pan: Union[bytes, str], psn: Union[bytes, str], pin: Union[bytes, str]\n    ) -> None:\n        \"\"\"MasterCard CVN 17\"\"\"\n        cvn17 = cvn.MasterCardCVN17(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Derive ICC Master Keys\n        assert key_check_digits(cvn17.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn17.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn17.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n        un = bytes.fromhex(\"ABCDEF12\")\n>       arqc = cvn17.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000009999\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000000000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"209906\"),\n            tag_9c=bytes.fromhex(\"00\"),\n            tag_9f37=un,\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            cvr=bytes.fromhex(\"A00003220000\"),  # 9F10: 0111A00003220000000000000000000322FF\n            counters=bytes.fromhex(\"00000000000322FF\"),\n        )\n\ntests\\test_cvn_hsm.py:511: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:1687: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b']\\x8f7\\xbc\\xd9\\xe5\\xdah'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn17[1234567890123456-00-9999_1]",
      "lineno": 481,
      "outcome": "failed",
      "keywords": [
        "test_mastercard_cvn17[1234567890123456-00-9999_1]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999_1",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 511,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 1687,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = b'1234567890123456', psn = '00', pin = b'9999'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\"),\n            (b\"1234567890123456\", \"00\", b\"9999\"),\n            (\"1234567890123456\", b\"00\", \"9999\"),\n            (\"1234567890123456\", \"00\", \"9999\"),\n        ],\n    )\n    def test_mastercard_cvn17(\n        pan: Union[bytes, str], psn: Union[bytes, str], pin: Union[bytes, str]\n    ) -> None:\n        \"\"\"MasterCard CVN 17\"\"\"\n        cvn17 = cvn.MasterCardCVN17(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Derive ICC Master Keys\n        assert key_check_digits(cvn17.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn17.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn17.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n        un = bytes.fromhex(\"ABCDEF12\")\n>       arqc = cvn17.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000009999\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000000000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"209906\"),\n            tag_9c=bytes.fromhex(\"00\"),\n            tag_9f37=un,\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            cvr=bytes.fromhex(\"A00003220000\"),  # 9F10: 0111A00003220000000000000000000322FF\n            counters=bytes.fromhex(\"00000000000322FF\"),\n        )\n\ntests\\test_cvn_hsm.py:511: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:1687: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b']\\x8f7\\xbc\\xd9\\xe5\\xdah'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn17[1234567890123456-00-9999_2]",
      "lineno": 481,
      "outcome": "failed",
      "keywords": [
        "test_mastercard_cvn17[1234567890123456-00-9999_2]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999_2",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 511,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 1687,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = '1234567890123456', psn = b'00', pin = '9999'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\"),\n            (b\"1234567890123456\", \"00\", b\"9999\"),\n            (\"1234567890123456\", b\"00\", \"9999\"),\n            (\"1234567890123456\", \"00\", \"9999\"),\n        ],\n    )\n    def test_mastercard_cvn17(\n        pan: Union[bytes, str], psn: Union[bytes, str], pin: Union[bytes, str]\n    ) -> None:\n        \"\"\"MasterCard CVN 17\"\"\"\n        cvn17 = cvn.MasterCardCVN17(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Derive ICC Master Keys\n        assert key_check_digits(cvn17.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn17.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn17.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n        un = bytes.fromhex(\"ABCDEF12\")\n>       arqc = cvn17.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000009999\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000000000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"209906\"),\n            tag_9c=bytes.fromhex(\"00\"),\n            tag_9f37=un,\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            cvr=bytes.fromhex(\"A00003220000\"),  # 9F10: 0111A00003220000000000000000000322FF\n            counters=bytes.fromhex(\"00000000000322FF\"),\n        )\n\ntests\\test_cvn_hsm.py:511: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:1687: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b']\\x8f7\\xbc\\xd9\\xe5\\xdah'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn17[1234567890123456-00-9999_3]",
      "lineno": 481,
      "outcome": "failed",
      "keywords": [
        "test_mastercard_cvn17[1234567890123456-00-9999_3]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999_3",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 511,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 1687,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = '1234567890123456', psn = '00', pin = '9999'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\"),\n            (b\"1234567890123456\", \"00\", b\"9999\"),\n            (\"1234567890123456\", b\"00\", \"9999\"),\n            (\"1234567890123456\", \"00\", \"9999\"),\n        ],\n    )\n    def test_mastercard_cvn17(\n        pan: Union[bytes, str], psn: Union[bytes, str], pin: Union[bytes, str]\n    ) -> None:\n        \"\"\"MasterCard CVN 17\"\"\"\n        cvn17 = cvn.MasterCardCVN17(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Derive ICC Master Keys\n        assert key_check_digits(cvn17.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn17.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn17.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n        un = bytes.fromhex(\"ABCDEF12\")\n>       arqc = cvn17.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000009999\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000000000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"209906\"),\n            tag_9c=bytes.fromhex(\"00\"),\n            tag_9f37=un,\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            cvr=bytes.fromhex(\"A00003220000\"),  # 9F10: 0111A00003220000000000000000000322FF\n            counters=bytes.fromhex(\"00000000000322FF\"),\n        )\n\ntests\\test_cvn_hsm.py:511: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:1687: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b']\\x8f7\\xbc\\xd9\\xe5\\xdah'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn20[1234567890123456-00-9999_0]",
      "lineno": 567,
      "outcome": "failed",
      "keywords": [
        "test_mastercard_cvn20[1234567890123456-00-9999_0]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999_0",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 597,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 1995,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = b'1234567890123456', psn = b'00', pin = b'9999'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\"),\n            (b\"1234567890123456\", \"00\", b\"9999\"),\n            (\"1234567890123456\", b\"00\", \"9999\"),\n            (\"1234567890123456\", \"00\", \"9999\"),\n        ],\n    )\n    def test_mastercard_cvn20(\n        pan: Union[bytes, str], psn: Union[bytes, str], pin: Union[bytes, str]\n    ) -> None:\n        \"\"\"MasterCard CVN 20\"\"\"\n        cvn20 = cvn.MasterCardCVN20(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Derive ICC Master Keys\n        assert key_check_digits(cvn20.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn20.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn20.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n        un = bytes.fromhex(\"ABCDEF12\")\n>       arqc = cvn20.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000009999\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000000000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"209906\"),\n            tag_9c=bytes.fromhex(\"00\"),\n            tag_9f37=un,\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            cvr=bytes.fromhex(\"A00003220000\"),  # 9F10: 0110A00003220000000000000000000000FF\n        )\n\ntests\\test_cvn_hsm.py:597: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:1995: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'Ck\\x94*\\xd67\\xe0\\x85'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn20[1234567890123456-00-9999_1]",
      "lineno": 567,
      "outcome": "failed",
      "keywords": [
        "test_mastercard_cvn20[1234567890123456-00-9999_1]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999_1",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 597,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 1995,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = b'1234567890123456', psn = '00', pin = b'9999'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\"),\n            (b\"1234567890123456\", \"00\", b\"9999\"),\n            (\"1234567890123456\", b\"00\", \"9999\"),\n            (\"1234567890123456\", \"00\", \"9999\"),\n        ],\n    )\n    def test_mastercard_cvn20(\n        pan: Union[bytes, str], psn: Union[bytes, str], pin: Union[bytes, str]\n    ) -> None:\n        \"\"\"MasterCard CVN 20\"\"\"\n        cvn20 = cvn.MasterCardCVN20(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Derive ICC Master Keys\n        assert key_check_digits(cvn20.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn20.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn20.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n        un = bytes.fromhex(\"ABCDEF12\")\n>       arqc = cvn20.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000009999\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000000000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"209906\"),\n            tag_9c=bytes.fromhex(\"00\"),\n            tag_9f37=un,\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            cvr=bytes.fromhex(\"A00003220000\"),  # 9F10: 0110A00003220000000000000000000000FF\n        )\n\ntests\\test_cvn_hsm.py:597: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:1995: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'Ck\\x94*\\xd67\\xe0\\x85'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn20[1234567890123456-00-9999_2]",
      "lineno": 567,
      "outcome": "failed",
      "keywords": [
        "test_mastercard_cvn20[1234567890123456-00-9999_2]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999_2",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 597,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 1995,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = '1234567890123456', psn = b'00', pin = '9999'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\"),\n            (b\"1234567890123456\", \"00\", b\"9999\"),\n            (\"1234567890123456\", b\"00\", \"9999\"),\n            (\"1234567890123456\", \"00\", \"9999\"),\n        ],\n    )\n    def test_mastercard_cvn20(\n        pan: Union[bytes, str], psn: Union[bytes, str], pin: Union[bytes, str]\n    ) -> None:\n        \"\"\"MasterCard CVN 20\"\"\"\n        cvn20 = cvn.MasterCardCVN20(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Derive ICC Master Keys\n        assert key_check_digits(cvn20.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn20.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn20.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n        un = bytes.fromhex(\"ABCDEF12\")\n>       arqc = cvn20.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000009999\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000000000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"209906\"),\n            tag_9c=bytes.fromhex(\"00\"),\n            tag_9f37=un,\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            cvr=bytes.fromhex(\"A00003220000\"),  # 9F10: 0110A00003220000000000000000000000FF\n        )\n\ntests\\test_cvn_hsm.py:597: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:1995: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'Ck\\x94*\\xd67\\xe0\\x85'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn20[1234567890123456-00-9999_3]",
      "lineno": 567,
      "outcome": "failed",
      "keywords": [
        "test_mastercard_cvn20[1234567890123456-00-9999_3]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999_3",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 597,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 1995,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = '1234567890123456', psn = '00', pin = '9999'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\"),\n            (b\"1234567890123456\", \"00\", b\"9999\"),\n            (\"1234567890123456\", b\"00\", \"9999\"),\n            (\"1234567890123456\", \"00\", \"9999\"),\n        ],\n    )\n    def test_mastercard_cvn20(\n        pan: Union[bytes, str], psn: Union[bytes, str], pin: Union[bytes, str]\n    ) -> None:\n        \"\"\"MasterCard CVN 20\"\"\"\n        cvn20 = cvn.MasterCardCVN20(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Derive ICC Master Keys\n        assert key_check_digits(cvn20.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn20.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn20.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n        un = bytes.fromhex(\"ABCDEF12\")\n>       arqc = cvn20.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000009999\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000000000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"209906\"),\n            tag_9c=bytes.fromhex(\"00\"),\n            tag_9f37=un,\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            cvr=bytes.fromhex(\"A00003220000\"),  # 9F10: 0110A00003220000000000000000000000FF\n        )\n\ntests\\test_cvn_hsm.py:597: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:1995: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'Ck\\x94*\\xd67\\xe0\\x85'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn21[1234567890123456-00-9999_0]",
      "lineno": 650,
      "outcome": "failed",
      "keywords": [
        "test_mastercard_cvn21[1234567890123456-00-9999_0]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999_0",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 680,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 2304,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = b'1234567890123456', psn = b'00', pin = b'9999'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\"),\n            (b\"1234567890123456\", \"00\", b\"9999\"),\n            (\"1234567890123456\", b\"00\", \"9999\"),\n            (\"1234567890123456\", \"00\", \"9999\"),\n        ],\n    )\n    def test_mastercard_cvn21(\n        pan: Union[bytes, str], psn: Union[bytes, str], pin: Union[bytes, str]\n    ) -> None:\n        \"\"\"MasterCard CVN 21\"\"\"\n        cvn21 = cvn.MasterCardCVN21(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Derive ICC Master Keys\n        assert key_check_digits(cvn21.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn21.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn21.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n        un = bytes.fromhex(\"ABCDEF12\")\n>       arqc = cvn21.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000009999\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000000000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"209906\"),\n            tag_9c=bytes.fromhex(\"00\"),\n            tag_9f37=un,\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            cvr=bytes.fromhex(\"A00003220000\"),  # 9F10: 0115A00003220000000000000000000322FF\n            counters=bytes.fromhex(\"00000000000322FF\"),\n        )\n\ntests\\test_cvn_hsm.py:680: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:2304: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'Ck\\x94*\\xd67\\xe0\\x85'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn21[1234567890123456-00-9999_1]",
      "lineno": 650,
      "outcome": "failed",
      "keywords": [
        "test_mastercard_cvn21[1234567890123456-00-9999_1]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999_1",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 680,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 2304,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = b'1234567890123456', psn = '00', pin = b'9999'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\"),\n            (b\"1234567890123456\", \"00\", b\"9999\"),\n            (\"1234567890123456\", b\"00\", \"9999\"),\n            (\"1234567890123456\", \"00\", \"9999\"),\n        ],\n    )\n    def test_mastercard_cvn21(\n        pan: Union[bytes, str], psn: Union[bytes, str], pin: Union[bytes, str]\n    ) -> None:\n        \"\"\"MasterCard CVN 21\"\"\"\n        cvn21 = cvn.MasterCardCVN21(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Derive ICC Master Keys\n        assert key_check_digits(cvn21.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn21.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn21.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n        un = bytes.fromhex(\"ABCDEF12\")\n>       arqc = cvn21.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000009999\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000000000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"209906\"),\n            tag_9c=bytes.fromhex(\"00\"),\n            tag_9f37=un,\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            cvr=bytes.fromhex(\"A00003220000\"),  # 9F10: 0115A00003220000000000000000000322FF\n            counters=bytes.fromhex(\"00000000000322FF\"),\n        )\n\ntests\\test_cvn_hsm.py:680: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:2304: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'Ck\\x94*\\xd67\\xe0\\x85'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn21[1234567890123456-00-9999_2]",
      "lineno": 650,
      "outcome": "failed",
      "keywords": [
        "test_mastercard_cvn21[1234567890123456-00-9999_2]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999_2",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 680,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 2304,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = '1234567890123456', psn = b'00', pin = '9999'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\"),\n            (b\"1234567890123456\", \"00\", b\"9999\"),\n            (\"1234567890123456\", b\"00\", \"9999\"),\n            (\"1234567890123456\", \"00\", \"9999\"),\n        ],\n    )\n    def test_mastercard_cvn21(\n        pan: Union[bytes, str], psn: Union[bytes, str], pin: Union[bytes, str]\n    ) -> None:\n        \"\"\"MasterCard CVN 21\"\"\"\n        cvn21 = cvn.MasterCardCVN21(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Derive ICC Master Keys\n        assert key_check_digits(cvn21.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn21.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn21.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n        un = bytes.fromhex(\"ABCDEF12\")\n>       arqc = cvn21.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000009999\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000000000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"209906\"),\n            tag_9c=bytes.fromhex(\"00\"),\n            tag_9f37=un,\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            cvr=bytes.fromhex(\"A00003220000\"),  # 9F10: 0115A00003220000000000000000000322FF\n            counters=bytes.fromhex(\"00000000000322FF\"),\n        )\n\ntests\\test_cvn_hsm.py:680: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:2304: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'Ck\\x94*\\xd67\\xe0\\x85'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvn_hsm.py::test_mastercard_cvn21[1234567890123456-00-9999_3]",
      "lineno": 650,
      "outcome": "failed",
      "keywords": [
        "test_mastercard_cvn21[1234567890123456-00-9999_3]",
        "parametrize",
        "pytestmark",
        "1234567890123456-00-9999_3",
        "test_cvn_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvn_hsm.py",
            "lineno": 680,
            "message": ""
          },
          {
            "path": "pyemv\\cvn.py",
            "lineno": 2304,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = '1234567890123456', psn = '00', pin = '9999'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\", \"pin\"],\n        [\n            (b\"1234567890123456\", b\"00\", b\"9999\"),\n            (b\"1234567890123456\", \"00\", b\"9999\"),\n            (\"1234567890123456\", b\"00\", \"9999\"),\n            (\"1234567890123456\", \"00\", \"9999\"),\n        ],\n    )\n    def test_mastercard_cvn21(\n        pan: Union[bytes, str], psn: Union[bytes, str], pin: Union[bytes, str]\n    ) -> None:\n        \"\"\"MasterCard CVN 21\"\"\"\n        cvn21 = cvn.MasterCardCVN21(\n            iss_mk_ac=bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\"),\n            iss_mk_smi=bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\"),\n            iss_mk_smc=bytes.fromhex(\"89ABCDEF0123456776543210FEDCBA98\"),\n            pan=pan,\n            psn=psn,\n        )\n    \n        # Derive ICC Master Keys\n        assert key_check_digits(cvn21.icc_mk_ac).hex().upper() == \"BAB0\"\n        assert key_check_digits(cvn21.icc_mk_smi).hex().upper() == \"F010\"\n        assert key_check_digits(cvn21.icc_mk_smc).hex().upper() == \"B154\"\n    \n        # ARQC and its session key\n        atc = bytes.fromhex(\"001C\")\n        un = bytes.fromhex(\"ABCDEF12\")\n>       arqc = cvn21.generate_ac(\n            tag_9f02=bytes.fromhex(\"000000009999\"),\n            tag_9f03=bytes.fromhex(\"000000000000\"),\n            tag_9f1a=bytes.fromhex(\"0124\"),\n            tag_95=bytes.fromhex(\"8000000000\"),\n            tag_5f2a=bytes.fromhex(\"0124\"),\n            tag_9a=bytes.fromhex(\"209906\"),\n            tag_9c=bytes.fromhex(\"00\"),\n            tag_9f37=un,\n            tag_82=bytes.fromhex(\"1800\"),\n            tag_9f36=atc,\n            cvr=bytes.fromhex(\"A00003220000\"),  # 9F10: 0115A00003220000000000000000000322FF\n            counters=bytes.fromhex(\"00000000000322FF\"),\n        )\n\ntests\\test_cvn_hsm.py:680: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvn.py:2304: in generate_ac\n    return _ac.generate_ac(\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'Ck\\x94*\\xd67\\xe0\\x85'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvv.py::test_generate_ac_exception",
      "lineno": 4,
      "outcome": "passed",
      "keywords": [
        "test_generate_ac_exception",
        "test_cvv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvv_hsm.py::test_generate_cvc3_track2",
      "lineno": 3,
      "outcome": "failed",
      "keywords": [
        "test_generate_cvc3_track2",
        "test_cvv_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvv_hsm.py",
            "lineno": 19,
            "message": ""
          },
          {
            "path": "pyemv\\cvv.py",
            "lineno": 86,
            "message": "in generate_cvc3"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "def test_generate_cvc3_track2() -> None:\n        # Device ICC CVC3 key from ISS CVC3 key using method A\n        # Issuer may choose to use method A or B.\n        iss_cvc3 = bytes.fromhex(\"01234567899876543210012345678998\")\n        pan = \"5123456789012345\"\n        psn = \"00\"\n        icc_cvc3 = kd.derive_icc_mk_a(iss_cvc3, pan, psn)\n        assert tools.key_check_digits(icc_cvc3).hex().upper() == \"BB8F\"\n    \n        # Compute CVC3 - track2\n        # Track2 must be converted to binary data where, for example,\n        # characters \"D3\" are represented as \"\\xD3\"\n        track2 = bytes.fromhex(\"5123456789012345D35121010000000000000F\")\n        atc = bytes.fromhex(\"005E\")\n        un = bytes.fromhex(\"00000899\")\n>       cvc3 = cvv.generate_cvc3(icc_cvc3, track2, atc, un)\n\ntests\\test_cvv_hsm.py:19: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvv.py:86: in generate_cvc3\n    iv_cvc3 = _mac.mac_iso9797_3(icc_cvc3[:8], icc_cvc3[-8:], track_template, 2)[-2:]\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'md%\\xfb\\x94\\x01\\xc2\\x1a'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_cvv_hsm.py::test_generate_cvc3_track1",
      "lineno": 22,
      "outcome": "failed",
      "keywords": [
        "test_generate_cvc3_track1",
        "test_cvv_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_cvv_hsm.py",
            "lineno": 38,
            "message": ""
          },
          {
            "path": "pyemv\\cvv.py",
            "lineno": 86,
            "message": "in generate_cvc3"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "def test_generate_cvc3_track1() -> None:\n        # Device ICC CVC3 key from ISS CVC3 key using method A\n        # Issuer may choose to use method A or B.\n        iss_cvc3 = bytes.fromhex(\"01234567899876543210012345678998\")\n        pan = \"5123456789012345\"\n        psn = \"00\"\n        icc_cvc3 = kd.derive_icc_mk_a(iss_cvc3, pan, psn)\n        assert tools.key_check_digits(icc_cvc3).hex().upper() == \"BB8F\"\n    \n        # Compute CVC3 - track1\n        # Track1 must be converted to binary data where, for example,\n        # charater \"B\" is represented as \"\\x42\".\n        track1 = b\"B5123456789012345^KENOBI/OBIWAN^3512101000000000000000000000000\"\n        atc = bytes.fromhex(\"005E\")\n        un = bytes.fromhex(\"00000899\")\n>       cvc3 = cvv.generate_cvc3(icc_cvc3, track1, atc, un)\n\ntests\\test_cvv_hsm.py:38: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\cvv.py:86: in generate_cvc3\n    iv_cvc3 = _mac.mac_iso9797_3(icc_cvc3[:8], icc_cvc3[-8:], track_template, 2)[-2:]\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'md%\\xfb\\x94\\x01\\xc2\\x1a'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd.py::test_derive_common_sk_exception",
      "lineno": 5,
      "outcome": "passed",
      "keywords": [
        "test_derive_common_sk_exception",
        "test_kd.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd.py::test_derive_visa_sm_sk_exception",
      "lineno": 47,
      "outcome": "passed",
      "keywords": [
        "test_derive_visa_sm_sk_exception",
        "test_kd.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd.py::test_derive_emv2000_tree_sk_exception",
      "lineno": 88,
      "outcome": "passed",
      "keywords": [
        "test_derive_emv2000_tree_sk_exception",
        "test_kd.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_a_psn[12345678901234567-45_0]",
      "lineno": 5,
      "outcome": "failed",
      "keywords": [
        "test_derive_icc_mk_a_psn[12345678901234567-45_0]",
        "parametrize",
        "pytestmark",
        "12345678901234567-45_0",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 40,
            "message": ""
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = b'12345678901234567', psn = b'45'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\"],\n        [\n            (b\"12345678901234567\", b\"45\"),\n            (b\"12345678901234567\", \"45\"),\n            (\"12345678901234567\", b\"45\"),\n            (\"12345678901234567\", \"45\"),\n        ],\n    )\n    def test_derive_icc_mk_a_psn(pan: Union[bytes, str], psn: Union[bytes, str]) -> None:\n        \"\"\"\n        Verify ICC MK derivation method A with non-zero PSN.\n    \n        Master Key Derivation = Option A\n        ARQC verification using Common Session Key Derivation\n        ARPC generation using ICC Master Key\n        ARPC Method = 1\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk, 2).hex().upper() == \"08D7\"\n    \n        # Derive ICC master key\n        icc_mk = kd.derive_icc_mk_a(iss_mk, pan, psn)\n        assert tools.key_check_digits(icc_mk, 2).hex().upper() == \"FF08\"\n    \n        # Verify AC session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"1234567890123456\")\n        sk_ac = kd.derive_common_sk(icc_mk, r)\n        assert tools.key_check_digits(sk_ac, 2).hex().upper() == \"DF82\"\n    \n        # ARQC validation using Session Key\n        cipher_text = bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\")\n>       arqc = ac.generate_ac(sk_ac, cipher_text)\n\ntests\\test_kd_hsm.py:40: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\xc7\\xae\\xdfI\\xae\\xf2\\xf1F'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_a_psn[12345678901234567-45_1]",
      "lineno": 5,
      "outcome": "failed",
      "keywords": [
        "test_derive_icc_mk_a_psn[12345678901234567-45_1]",
        "parametrize",
        "pytestmark",
        "12345678901234567-45_1",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 40,
            "message": ""
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = b'12345678901234567', psn = '45'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\"],\n        [\n            (b\"12345678901234567\", b\"45\"),\n            (b\"12345678901234567\", \"45\"),\n            (\"12345678901234567\", b\"45\"),\n            (\"12345678901234567\", \"45\"),\n        ],\n    )\n    def test_derive_icc_mk_a_psn(pan: Union[bytes, str], psn: Union[bytes, str]) -> None:\n        \"\"\"\n        Verify ICC MK derivation method A with non-zero PSN.\n    \n        Master Key Derivation = Option A\n        ARQC verification using Common Session Key Derivation\n        ARPC generation using ICC Master Key\n        ARPC Method = 1\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk, 2).hex().upper() == \"08D7\"\n    \n        # Derive ICC master key\n        icc_mk = kd.derive_icc_mk_a(iss_mk, pan, psn)\n        assert tools.key_check_digits(icc_mk, 2).hex().upper() == \"FF08\"\n    \n        # Verify AC session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"1234567890123456\")\n        sk_ac = kd.derive_common_sk(icc_mk, r)\n        assert tools.key_check_digits(sk_ac, 2).hex().upper() == \"DF82\"\n    \n        # ARQC validation using Session Key\n        cipher_text = bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\")\n>       arqc = ac.generate_ac(sk_ac, cipher_text)\n\ntests\\test_kd_hsm.py:40: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\xc7\\xae\\xdfI\\xae\\xf2\\xf1F'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_a_psn[12345678901234567-45_2]",
      "lineno": 5,
      "outcome": "failed",
      "keywords": [
        "test_derive_icc_mk_a_psn[12345678901234567-45_2]",
        "parametrize",
        "pytestmark",
        "12345678901234567-45_2",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 40,
            "message": ""
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = '12345678901234567', psn = b'45'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\"],\n        [\n            (b\"12345678901234567\", b\"45\"),\n            (b\"12345678901234567\", \"45\"),\n            (\"12345678901234567\", b\"45\"),\n            (\"12345678901234567\", \"45\"),\n        ],\n    )\n    def test_derive_icc_mk_a_psn(pan: Union[bytes, str], psn: Union[bytes, str]) -> None:\n        \"\"\"\n        Verify ICC MK derivation method A with non-zero PSN.\n    \n        Master Key Derivation = Option A\n        ARQC verification using Common Session Key Derivation\n        ARPC generation using ICC Master Key\n        ARPC Method = 1\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk, 2).hex().upper() == \"08D7\"\n    \n        # Derive ICC master key\n        icc_mk = kd.derive_icc_mk_a(iss_mk, pan, psn)\n        assert tools.key_check_digits(icc_mk, 2).hex().upper() == \"FF08\"\n    \n        # Verify AC session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"1234567890123456\")\n        sk_ac = kd.derive_common_sk(icc_mk, r)\n        assert tools.key_check_digits(sk_ac, 2).hex().upper() == \"DF82\"\n    \n        # ARQC validation using Session Key\n        cipher_text = bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\")\n>       arqc = ac.generate_ac(sk_ac, cipher_text)\n\ntests\\test_kd_hsm.py:40: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\xc7\\xae\\xdfI\\xae\\xf2\\xf1F'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_a_psn[12345678901234567-45_3]",
      "lineno": 5,
      "outcome": "failed",
      "keywords": [
        "test_derive_icc_mk_a_psn[12345678901234567-45_3]",
        "parametrize",
        "pytestmark",
        "12345678901234567-45_3",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 40,
            "message": ""
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = '12345678901234567', psn = '45'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\"],\n        [\n            (b\"12345678901234567\", b\"45\"),\n            (b\"12345678901234567\", \"45\"),\n            (\"12345678901234567\", b\"45\"),\n            (\"12345678901234567\", \"45\"),\n        ],\n    )\n    def test_derive_icc_mk_a_psn(pan: Union[bytes, str], psn: Union[bytes, str]) -> None:\n        \"\"\"\n        Verify ICC MK derivation method A with non-zero PSN.\n    \n        Master Key Derivation = Option A\n        ARQC verification using Common Session Key Derivation\n        ARPC generation using ICC Master Key\n        ARPC Method = 1\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk, 2).hex().upper() == \"08D7\"\n    \n        # Derive ICC master key\n        icc_mk = kd.derive_icc_mk_a(iss_mk, pan, psn)\n        assert tools.key_check_digits(icc_mk, 2).hex().upper() == \"FF08\"\n    \n        # Verify AC session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"1234567890123456\")\n        sk_ac = kd.derive_common_sk(icc_mk, r)\n        assert tools.key_check_digits(sk_ac, 2).hex().upper() == \"DF82\"\n    \n        # ARQC validation using Session Key\n        cipher_text = bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\")\n>       arqc = ac.generate_ac(sk_ac, cipher_text)\n\ntests\\test_kd_hsm.py:40: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\xc7\\xae\\xdfI\\xae\\xf2\\xf1F'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_a_no_psn[12345678901234567_0]",
      "lineno": 48,
      "outcome": "failed",
      "keywords": [
        "test_derive_icc_mk_a_no_psn[12345678901234567_0]",
        "parametrize",
        "pytestmark",
        "12345678901234567_0",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 80,
            "message": ""
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = b'12345678901234567'\n\n    @pytest.mark.parametrize(\n        \"pan\",\n        [\n            b\"12345678901234567\",\n            \"12345678901234567\",\n        ],\n    )\n    def test_derive_icc_mk_a_no_psn(pan: Union[bytes, str]) -> None:\n        \"\"\"\n        Verify ICC MK derivation method A with a zero PSN.\n    \n        Master Key Derivation = Option A\n        ARQC verification using Common Session Key Derivation\n        ARPC generation using ICC Master Key\n        ARPC Method = 1\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk, 2).hex().upper() == \"08D7\"\n    \n        # Derive ICC master key\n        icc_mk = kd.derive_icc_mk_a(iss_mk, pan)\n    \n        # Verify AC session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"1234567890123456\")\n        sk_ac = kd.derive_common_sk(icc_mk, r)\n        assert tools.key_check_digits(sk_ac, 2).hex().upper() == \"3F4F\"\n    \n        # ARQC validation using Session Key\n        cipher_text = bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\")\n>       arqc = ac.generate_ac(sk_ac, cipher_text)\n\ntests\\test_kd_hsm.py:80: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'@\\xf4T\\xb6C\\xe5L\\r'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_a_no_psn[12345678901234567_1]",
      "lineno": 48,
      "outcome": "failed",
      "keywords": [
        "test_derive_icc_mk_a_no_psn[12345678901234567_1]",
        "parametrize",
        "pytestmark",
        "12345678901234567_1",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 80,
            "message": ""
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = '12345678901234567'\n\n    @pytest.mark.parametrize(\n        \"pan\",\n        [\n            b\"12345678901234567\",\n            \"12345678901234567\",\n        ],\n    )\n    def test_derive_icc_mk_a_no_psn(pan: Union[bytes, str]) -> None:\n        \"\"\"\n        Verify ICC MK derivation method A with a zero PSN.\n    \n        Master Key Derivation = Option A\n        ARQC verification using Common Session Key Derivation\n        ARPC generation using ICC Master Key\n        ARPC Method = 1\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk, 2).hex().upper() == \"08D7\"\n    \n        # Derive ICC master key\n        icc_mk = kd.derive_icc_mk_a(iss_mk, pan)\n    \n        # Verify AC session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"1234567890123456\")\n        sk_ac = kd.derive_common_sk(icc_mk, r)\n        assert tools.key_check_digits(sk_ac, 2).hex().upper() == \"3F4F\"\n    \n        # ARQC validation using Session Key\n        cipher_text = bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\")\n>       arqc = ac.generate_ac(sk_ac, cipher_text)\n\ntests\\test_kd_hsm.py:80: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'@\\xf4T\\xb6C\\xe5L\\r'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_common_sk",
      "lineno": 88,
      "outcome": "failed",
      "keywords": [
        "test_derive_common_sk",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 118,
            "message": ""
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "def test_derive_common_sk() -> None:\n        \"\"\"\n        Verify common session key derivation using algorithm\n        type where both ARQC and ARPC are verified using derived\n        session key.\n    \n        Master Key Derivation = Option A\n        ARQC verification using Common Session Key Derivation\n        ARPC generation using Common Session Key Derivation\n        ARPC Method = 1\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk, 2).hex().upper() == \"08D7\"\n    \n        # Derive ICC master key\n        pan = \"12345678901234567\"\n        psn = \"45\"\n        icc_mk = kd.derive_icc_mk_a(iss_mk, pan, psn)\n        assert tools.key_check_digits(icc_mk, 2).hex().upper() == \"FF08\"\n    \n        # Verify AC session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"1234567890123456\")\n        sk_ac = kd.derive_common_sk(icc_mk, r)\n        assert tools.key_check_digits(sk_ac, 2).hex().upper() == \"DF82\"\n    \n        # ARQC validation using Session Key\n        cipher_text = bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\")\n>       arqc = ac.generate_ac(sk_ac, cipher_text)\n\ntests\\test_kd_hsm.py:118: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\xc7\\xae\\xdfI\\xae\\xf2\\xf1F'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_b_pan16",
      "lineno": 126,
      "outcome": "failed",
      "keywords": [
        "test_derive_icc_mk_b_pan16",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 155,
            "message": ""
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "def test_derive_icc_mk_b_pan16() -> None:\n        \"\"\"\n        Verify ICC MK derivation method B using incompatible\n        PAN length. Method B is applicable only if PAN is\n        17-19 digits long.\n    \n        Master Key Derivation = Option B\n        ARQC verification using Common Session Key Derivation\n        ARPC generation using Common Session Key Derivation\n        ARPC Method = 2\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk, 2).hex().upper() == \"08D7\"\n    \n        # Derive ICC master key\n        pan = \"1234567890123456\"\n        icc_mk = kd.derive_icc_mk_b(iss_mk, pan)\n        assert tools.key_check_digits(icc_mk, 2).hex().upper() == \"BAB0\"\n    \n        # Verify AC session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"1234567890123456\")\n        sk_ac = kd.derive_common_sk(icc_mk, r)\n        assert tools.key_check_digits(sk_ac, 2).hex().upper() == \"BC19\"\n    \n        # ARQC validation using Session Key\n        cipher_text = bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\")\n>       arqc = ac.generate_ac(sk_ac, cipher_text)\n\ntests\\test_kd_hsm.py:155: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\x91\\xe5\\xc4\\xfe\\xf4\\xf7\\xcb\\xd6'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_b_pan17_psn[12345678901234567-45_0]",
      "lineno": 163,
      "outcome": "failed",
      "keywords": [
        "test_derive_icc_mk_b_pan17_psn[12345678901234567-45_0]",
        "parametrize",
        "pytestmark",
        "12345678901234567-45_0",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 200,
            "message": ""
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = b'12345678901234567', psn = b'45'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\"],\n        [\n            (b\"12345678901234567\", b\"45\"),\n            (b\"12345678901234567\", \"45\"),\n            (\"12345678901234567\", b\"45\"),\n            (\"12345678901234567\", \"45\"),\n        ],\n    )\n    def test_derive_icc_mk_b_pan17_psn(\n        pan: Union[bytes, str], psn: Union[bytes, str]\n    ) -> None:\n        \"\"\"\n        Verify ICC MK derivation method B using 17 digit PAN.\n    \n        Master Key Derivation = Option B\n        ARQC verification using Common Session Key Derivation\n        ARPC generation using Common Session Key Derivation\n        ARPC Method = 2\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk, 2).hex().upper() == \"08D7\"\n    \n        # Derive ICC master key\n        icc_mk = kd.derive_icc_mk_b(iss_mk, pan, psn)\n        assert tools.key_check_digits(icc_mk, 2).hex().upper() == \"0BAF\"\n    \n        # Verify AC session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"1234567890123456\")\n        sk_ac = kd.derive_common_sk(icc_mk, r)\n        assert tools.key_check_digits(sk_ac, 2).hex().upper() == \"4262\"\n    \n        # ARQC validation using Session Key\n        cipher_text = bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\")\n>       arqc = ac.generate_ac(sk_ac, cipher_text)\n\ntests\\test_kd_hsm.py:200: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'W\\xbc#Q \\x8cz\\xb0'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_b_pan17_psn[12345678901234567-45_1]",
      "lineno": 163,
      "outcome": "failed",
      "keywords": [
        "test_derive_icc_mk_b_pan17_psn[12345678901234567-45_1]",
        "parametrize",
        "pytestmark",
        "12345678901234567-45_1",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 200,
            "message": ""
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = b'12345678901234567', psn = '45'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\"],\n        [\n            (b\"12345678901234567\", b\"45\"),\n            (b\"12345678901234567\", \"45\"),\n            (\"12345678901234567\", b\"45\"),\n            (\"12345678901234567\", \"45\"),\n        ],\n    )\n    def test_derive_icc_mk_b_pan17_psn(\n        pan: Union[bytes, str], psn: Union[bytes, str]\n    ) -> None:\n        \"\"\"\n        Verify ICC MK derivation method B using 17 digit PAN.\n    \n        Master Key Derivation = Option B\n        ARQC verification using Common Session Key Derivation\n        ARPC generation using Common Session Key Derivation\n        ARPC Method = 2\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk, 2).hex().upper() == \"08D7\"\n    \n        # Derive ICC master key\n        icc_mk = kd.derive_icc_mk_b(iss_mk, pan, psn)\n        assert tools.key_check_digits(icc_mk, 2).hex().upper() == \"0BAF\"\n    \n        # Verify AC session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"1234567890123456\")\n        sk_ac = kd.derive_common_sk(icc_mk, r)\n        assert tools.key_check_digits(sk_ac, 2).hex().upper() == \"4262\"\n    \n        # ARQC validation using Session Key\n        cipher_text = bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\")\n>       arqc = ac.generate_ac(sk_ac, cipher_text)\n\ntests\\test_kd_hsm.py:200: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'W\\xbc#Q \\x8cz\\xb0'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_b_pan17_psn[12345678901234567-45_2]",
      "lineno": 163,
      "outcome": "failed",
      "keywords": [
        "test_derive_icc_mk_b_pan17_psn[12345678901234567-45_2]",
        "parametrize",
        "pytestmark",
        "12345678901234567-45_2",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 200,
            "message": ""
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = '12345678901234567', psn = b'45'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\"],\n        [\n            (b\"12345678901234567\", b\"45\"),\n            (b\"12345678901234567\", \"45\"),\n            (\"12345678901234567\", b\"45\"),\n            (\"12345678901234567\", \"45\"),\n        ],\n    )\n    def test_derive_icc_mk_b_pan17_psn(\n        pan: Union[bytes, str], psn: Union[bytes, str]\n    ) -> None:\n        \"\"\"\n        Verify ICC MK derivation method B using 17 digit PAN.\n    \n        Master Key Derivation = Option B\n        ARQC verification using Common Session Key Derivation\n        ARPC generation using Common Session Key Derivation\n        ARPC Method = 2\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk, 2).hex().upper() == \"08D7\"\n    \n        # Derive ICC master key\n        icc_mk = kd.derive_icc_mk_b(iss_mk, pan, psn)\n        assert tools.key_check_digits(icc_mk, 2).hex().upper() == \"0BAF\"\n    \n        # Verify AC session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"1234567890123456\")\n        sk_ac = kd.derive_common_sk(icc_mk, r)\n        assert tools.key_check_digits(sk_ac, 2).hex().upper() == \"4262\"\n    \n        # ARQC validation using Session Key\n        cipher_text = bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\")\n>       arqc = ac.generate_ac(sk_ac, cipher_text)\n\ntests\\test_kd_hsm.py:200: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'W\\xbc#Q \\x8cz\\xb0'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_b_pan17_psn[12345678901234567-45_3]",
      "lineno": 163,
      "outcome": "failed",
      "keywords": [
        "test_derive_icc_mk_b_pan17_psn[12345678901234567-45_3]",
        "parametrize",
        "pytestmark",
        "12345678901234567-45_3",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 200,
            "message": ""
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = '12345678901234567', psn = '45'\n\n    @pytest.mark.parametrize(\n        [\"pan\", \"psn\"],\n        [\n            (b\"12345678901234567\", b\"45\"),\n            (b\"12345678901234567\", \"45\"),\n            (\"12345678901234567\", b\"45\"),\n            (\"12345678901234567\", \"45\"),\n        ],\n    )\n    def test_derive_icc_mk_b_pan17_psn(\n        pan: Union[bytes, str], psn: Union[bytes, str]\n    ) -> None:\n        \"\"\"\n        Verify ICC MK derivation method B using 17 digit PAN.\n    \n        Master Key Derivation = Option B\n        ARQC verification using Common Session Key Derivation\n        ARPC generation using Common Session Key Derivation\n        ARPC Method = 2\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk, 2).hex().upper() == \"08D7\"\n    \n        # Derive ICC master key\n        icc_mk = kd.derive_icc_mk_b(iss_mk, pan, psn)\n        assert tools.key_check_digits(icc_mk, 2).hex().upper() == \"0BAF\"\n    \n        # Verify AC session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"1234567890123456\")\n        sk_ac = kd.derive_common_sk(icc_mk, r)\n        assert tools.key_check_digits(sk_ac, 2).hex().upper() == \"4262\"\n    \n        # ARQC validation using Session Key\n        cipher_text = bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\")\n>       arqc = ac.generate_ac(sk_ac, cipher_text)\n\ntests\\test_kd_hsm.py:200: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'W\\xbc#Q \\x8cz\\xb0'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_b_pan17_no_psn[12345678901234567_0]",
      "lineno": 208,
      "outcome": "failed",
      "keywords": [
        "test_derive_icc_mk_b_pan17_no_psn[12345678901234567_0]",
        "parametrize",
        "pytestmark",
        "12345678901234567_0",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 241,
            "message": ""
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = b'12345678901234567'\n\n    @pytest.mark.parametrize(\n        \"pan\",\n        [\n            b\"12345678901234567\",\n            \"12345678901234567\",\n        ],\n    )\n    def test_derive_icc_mk_b_pan17_no_psn(pan: Union[bytes, str]) -> None:\n        \"\"\"\n        Verify ICC MK derivation method B using 17 digit PAN.\n    \n        Master Key Derivation = Option B\n        ARQC verification using Common Session Key Derivation\n        ARPC generation using Common Session Key Derivation\n        ARPC Method = 2\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk, 2).hex().upper() == \"08D7\"\n    \n        # Derive ICC master key\n        icc_mk = kd.derive_icc_mk_b(iss_mk, pan)\n        assert tools.key_check_digits(icc_mk, 2).hex().upper() == \"4626\"\n    \n        # Verify AC session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"1234567890123456\")\n        sk_ac = kd.derive_common_sk(icc_mk, r)\n        assert tools.key_check_digits(sk_ac, 2).hex().upper() == \"7F36\"\n    \n        # ARQC validation using Session Key\n        cipher_text = bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\")\n>       arqc = ac.generate_ac(sk_ac, cipher_text)\n\ntests\\test_kd_hsm.py:241: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'I\\x8a\\xa7\\xa4X\\r\\xf1X'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_b_pan17_no_psn[12345678901234567_1]",
      "lineno": 208,
      "outcome": "failed",
      "keywords": [
        "test_derive_icc_mk_b_pan17_no_psn[12345678901234567_1]",
        "parametrize",
        "pytestmark",
        "12345678901234567_1",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 241,
            "message": ""
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pan = '12345678901234567'\n\n    @pytest.mark.parametrize(\n        \"pan\",\n        [\n            b\"12345678901234567\",\n            \"12345678901234567\",\n        ],\n    )\n    def test_derive_icc_mk_b_pan17_no_psn(pan: Union[bytes, str]) -> None:\n        \"\"\"\n        Verify ICC MK derivation method B using 17 digit PAN.\n    \n        Master Key Derivation = Option B\n        ARQC verification using Common Session Key Derivation\n        ARPC generation using Common Session Key Derivation\n        ARPC Method = 2\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk, 2).hex().upper() == \"08D7\"\n    \n        # Derive ICC master key\n        icc_mk = kd.derive_icc_mk_b(iss_mk, pan)\n        assert tools.key_check_digits(icc_mk, 2).hex().upper() == \"4626\"\n    \n        # Verify AC session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"1234567890123456\")\n        sk_ac = kd.derive_common_sk(icc_mk, r)\n        assert tools.key_check_digits(sk_ac, 2).hex().upper() == \"7F36\"\n    \n        # ARQC validation using Session Key\n        cipher_text = bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\")\n>       arqc = ac.generate_ac(sk_ac, cipher_text)\n\ntests\\test_kd_hsm.py:241: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'I\\x8a\\xa7\\xa4X\\r\\xf1X'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_b_pan18",
      "lineno": 249,
      "outcome": "failed",
      "keywords": [
        "test_derive_icc_mk_b_pan18",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 277,
            "message": ""
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "def test_derive_icc_mk_b_pan18() -> None:\n        \"\"\"\n        Verify ICC MK derivation method B using 18 digit PAN.\n    \n        Master Key Derivation = Option B\n        ARQC verification using Common Session Key Derivation\n        ARPC generation using Common Session Key Derivation\n        ARPC Method = 2\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk, 2).hex().upper() == \"08D7\"\n    \n        # Derive ICC master key\n        pan = \"123456789012345679\"\n        psn = \"00\"\n        icc_mk = kd.derive_icc_mk_b(iss_mk, pan, psn)\n        assert tools.key_check_digits(icc_mk, 2).hex().upper() == \"C2F3\"\n    \n        # Verify AC session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"1234567890123456\")\n        sk_ac = kd.derive_common_sk(icc_mk, r)\n        assert tools.key_check_digits(sk_ac, 2).hex().upper() == \"7C35\"\n    \n        # ARQC validation using Session Key\n        cipher_text = bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\")\n>       arqc = ac.generate_ac(sk_ac, cipher_text)\n\ntests\\test_kd_hsm.py:277: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\xe0b\\xb0\\xb5\\xb5s\\xa7C'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_icc_mk_b_sha_pad",
      "lineno": 285,
      "outcome": "failed",
      "keywords": [
        "test_derive_icc_mk_b_sha_pad",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 321,
            "message": ""
          },
          {
            "path": "pyemv\\ac.py",
            "lineno": 165,
            "message": "in generate_ac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "def test_derive_icc_mk_b_sha_pad() -> None:\n        \"\"\"\n        Verify ICC MK derivation method B where the algorithm\n        is forced to convert sha digest letters into numbers.\n    \n        Master Key Derivation = Option B\n        ARQC verification using Common Session Key Derivation\n        ARPC generation using Common Session Key Derivation\n        ARPC Method = 2\n    \n        Note: in this test sha1 does not produce 16 digits.\n        Use decimalisation table to convert hexchars to digits.\n            e -> 4\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk, 2).hex().upper() == \"08D7\"\n    \n        # Derive ICC master key\n        pan = \"000000000000000005\"\n        psn = \"23\"\n        icc_mk = kd.derive_icc_mk_b(iss_mk, pan, psn)\n        assert tools.key_check_digits(icc_mk, 2).hex().upper() == \"DD73\"\n    \n        # Verify AC session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"001C000000000000\")\n        sk_ac = kd.derive_common_sk(icc_mk, r)\n        assert tools.key_check_digits(sk_ac, 2).hex().upper() == \"04F8\"\n    \n        # ARQC validation using Session Key\n        cipher_text = bytes.fromhex(\n            \"00000000400000000000000001248000048000012\"\n            \"41911050152BF45851800001C06011203A0B800\"\n        )\n>       arqc = ac.generate_ac(sk_ac, cipher_text)\n\ntests\\test_kd_hsm.py:321: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\ac.py:165: in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'Q,\\xe0\\xec\\x80\\xa4]\\xab'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_visa_sm_sk",
      "lineno": 331,
      "outcome": "failed",
      "keywords": [
        "test_derive_visa_sm_sk",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 353,
            "message": ""
          },
          {
            "path": "pyemv\\sm.py",
            "lineno": 108,
            "message": "in generate_command_mac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "def test_derive_visa_sm_sk() -> None:\n        \"\"\"\n        Verify visa session key derivation for secure messaging.\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk = bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\")\n        assert tools.key_check_digits(iss_mk, 2).hex().upper() == \"7B83\"\n    \n        # Derive ICC master key\n        pan = \"1234567890123456\"\n        icc_mk = kd.derive_icc_mk_b(iss_mk, pan)\n        assert tools.key_check_digits(icc_mk, 2).hex().upper() == \"F010\"\n    \n        # Verify AC session key\n        atc = bytes.fromhex(\"001C\")\n        arqc = bytes.fromhex(\"29CCA15AE665FA2E\")\n        sk_sm = kd.derive_visa_sm_sk(icc_mk, atc)\n        assert tools.key_check_digits(sk_sm, 2).hex().upper() == \"DB10\"\n    \n        # Command MAC generation using Session Key\n        command_header = bytes.fromhex(\"8418000008\")\n>       mac = sm.generate_command_mac(sk_sm, command_header + atc + arqc)\n\ntests\\test_kd_hsm.py:353: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\sm.py:108: in generate_command_mac\n    return _mac.mac_iso9797_3(sk_smi[:8], sk_smi[-8:], command, 2, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\x94\\xf8g\\x16|d\\xef#'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_emv2000_tree_sk[0000-8-4-00000000000000000000000000000000-80BF3145AECB948A5201DAB9EF469875]",
      "lineno": 358,
      "outcome": "failed",
      "keywords": [
        "test_derive_emv2000_tree_sk[0000-8-4-00000000000000000000000000000000-80BF3145AECB948A5201DAB9EF469875]",
        "parametrize",
        "pytestmark",
        "0000-8-4-00000000000000000000000000000000-80BF3145AECB948A5201DAB9EF469875",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 85,
          "message": "ValueError: Triple DES key degenerates to single DES"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 387,
            "message": ""
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 431,
            "message": "in derive_emv2000_tree_sk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 425,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 405,
            "message": "in derive"
          },
          {
            "path": "pyemv\\tools.py",
            "lineno": 171,
            "message": "in encrypt_tdes_ecb"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_ecb.py",
            "lineno": 216,
            "message": "in _create_ecb_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 85,
            "message": "ValueError"
          }
        ],
        "longrepr": "atc = '0000', height = 8, branch = 4, iv = '00000000000000000000000000000000'\nsk = '80BF3145AECB948A5201DAB9EF469875'\n\n    @pytest.mark.parametrize(\n        [\"atc\", \"height\", \"branch\", \"iv\", \"sk\"],\n        [\n            # Small ATC\n            (\"0000\",  8, 4, \"00000000000000000000000000000000\", \"80BF3145AECB948A5201DAB9EF469875\"),\n            (\"0000\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"DC31BC40B3AB8F73F2E3DA5EBF9DE59B\"),\n            (\"0000\", 16, 2, \"00000000000000000000000000000000\", \"86AD9732D5A192A749ADCE31919DAE8A\"),\n            (\"0000\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"7C57A15261202A101C6DA29B16672A3E\"),\n            # Medium ATC\n            (\"00FF\",  8, 4, \"00000000000000000000000000000000\", \"981F9D208AE6132CBC8A7C97F42A5445\"),\n            (\"00FF\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"D579C8A4927589017FA1739B2C853BAD\"),\n            (\"00FF\", 16, 2, \"00000000000000000000000000000000\", \"1F54F492EF104580B0F4B0F8910D0438\"),\n            (\"00FF\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"2086F81AAB731FF8CED9BF6DA7191CA2\"),\n            # Large ATC\n            (\"FFFF\",  8, 4, \"00000000000000000000000000000000\", \"D93D7A6B70F867615D4AAB79BF235B62\"),\n            (\"FFFF\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"A10EA78F2F1ACE203B3B402F6EE6CB29\"),\n            (\"FFFF\", 16, 2, \"00000000000000000000000000000000\", \"F83E499EF786C20BC41310A176E3F84F\"),\n            (\"FFFF\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"73E3B0A1406E5E4908D5804C4970E520\"),\n        ],\n    )\n    # fmt: on\n    def test_derive_emv2000_tree_sk(\n        atc: str,\n        height: int,\n        branch: int,\n        iv: str,\n        sk: str,\n    ) -> None:\n>       assert bytes.fromhex(sk) == kd.derive_emv2000_tree_sk(\n            bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\"),\n            bytes.fromhex(atc),\n            height,\n            branch,\n            bytes.fromhex(iv),\n        )\n\ntests\\test_kd_hsm.py:387: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\kd.py:431: in derive_emv2000_tree_sk\n    p, gp = walk(atc_num // branch_factor, height - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:425: in walk\n    return derive(p, gp, j), p\npyemv\\kd.py:405: in derive\n    l_data = _tools.encrypt_tdes_ecb(x, l_data)\npyemv\\tools.py:171: in encrypt_tdes_ecb\n    cipher = DES3.new(key, DES3.MODE_ECB)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_ecb.py:216: in _create_ecb_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\x01#Eg\\x89\\xab\\xcd\\xef\\x01#Eg\\x89\\xab\\xcd\\xef'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n            raise ValueError(\"Not a valid TDES key\")\n    \n        key_out = b\"\".join([ bchr(parity_byte(bord(x))) for x in key_in ])\n    \n        if key_out[:8] == key_out[8:16] or key_out[-16:-8] == key_out[-8:]:\n>           raise ValueError(\"Triple DES key degenerates to single DES\")\nE           ValueError: Triple DES key degenerates to single DES\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:85: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_emv2000_tree_sk[0000-8-4-F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0-DC31BC40B3AB8F73F2E3DA5EBF9DE59B]",
      "lineno": 358,
      "outcome": "failed",
      "keywords": [
        "test_derive_emv2000_tree_sk[0000-8-4-F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0-DC31BC40B3AB8F73F2E3DA5EBF9DE59B]",
        "parametrize",
        "pytestmark",
        "0000-8-4-F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0-DC31BC40B3AB8F73F2E3DA5EBF9DE59B",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 85,
          "message": "ValueError: Triple DES key degenerates to single DES"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 387,
            "message": ""
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 431,
            "message": "in derive_emv2000_tree_sk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 425,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 405,
            "message": "in derive"
          },
          {
            "path": "pyemv\\tools.py",
            "lineno": 171,
            "message": "in encrypt_tdes_ecb"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_ecb.py",
            "lineno": 216,
            "message": "in _create_ecb_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 85,
            "message": "ValueError"
          }
        ],
        "longrepr": "atc = '0000', height = 8, branch = 4, iv = 'F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0'\nsk = 'DC31BC40B3AB8F73F2E3DA5EBF9DE59B'\n\n    @pytest.mark.parametrize(\n        [\"atc\", \"height\", \"branch\", \"iv\", \"sk\"],\n        [\n            # Small ATC\n            (\"0000\",  8, 4, \"00000000000000000000000000000000\", \"80BF3145AECB948A5201DAB9EF469875\"),\n            (\"0000\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"DC31BC40B3AB8F73F2E3DA5EBF9DE59B\"),\n            (\"0000\", 16, 2, \"00000000000000000000000000000000\", \"86AD9732D5A192A749ADCE31919DAE8A\"),\n            (\"0000\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"7C57A15261202A101C6DA29B16672A3E\"),\n            # Medium ATC\n            (\"00FF\",  8, 4, \"00000000000000000000000000000000\", \"981F9D208AE6132CBC8A7C97F42A5445\"),\n            (\"00FF\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"D579C8A4927589017FA1739B2C853BAD\"),\n            (\"00FF\", 16, 2, \"00000000000000000000000000000000\", \"1F54F492EF104580B0F4B0F8910D0438\"),\n            (\"00FF\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"2086F81AAB731FF8CED9BF6DA7191CA2\"),\n            # Large ATC\n            (\"FFFF\",  8, 4, \"00000000000000000000000000000000\", \"D93D7A6B70F867615D4AAB79BF235B62\"),\n            (\"FFFF\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"A10EA78F2F1ACE203B3B402F6EE6CB29\"),\n            (\"FFFF\", 16, 2, \"00000000000000000000000000000000\", \"F83E499EF786C20BC41310A176E3F84F\"),\n            (\"FFFF\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"73E3B0A1406E5E4908D5804C4970E520\"),\n        ],\n    )\n    # fmt: on\n    def test_derive_emv2000_tree_sk(\n        atc: str,\n        height: int,\n        branch: int,\n        iv: str,\n        sk: str,\n    ) -> None:\n>       assert bytes.fromhex(sk) == kd.derive_emv2000_tree_sk(\n            bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\"),\n            bytes.fromhex(atc),\n            height,\n            branch,\n            bytes.fromhex(iv),\n        )\n\ntests\\test_kd_hsm.py:387: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\kd.py:431: in derive_emv2000_tree_sk\n    p, gp = walk(atc_num // branch_factor, height - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:425: in walk\n    return derive(p, gp, j), p\npyemv\\kd.py:405: in derive\n    l_data = _tools.encrypt_tdes_ecb(x, l_data)\npyemv\\tools.py:171: in encrypt_tdes_ecb\n    cipher = DES3.new(key, DES3.MODE_ECB)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_ecb.py:216: in _create_ecb_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\x01#Eg\\x89\\xab\\xcd\\xef\\x01#Eg\\x89\\xab\\xcd\\xef'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n            raise ValueError(\"Not a valid TDES key\")\n    \n        key_out = b\"\".join([ bchr(parity_byte(bord(x))) for x in key_in ])\n    \n        if key_out[:8] == key_out[8:16] or key_out[-16:-8] == key_out[-8:]:\n>           raise ValueError(\"Triple DES key degenerates to single DES\")\nE           ValueError: Triple DES key degenerates to single DES\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:85: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_emv2000_tree_sk[0000-16-2-00000000000000000000000000000000-86AD9732D5A192A749ADCE31919DAE8A]",
      "lineno": 358,
      "outcome": "failed",
      "keywords": [
        "test_derive_emv2000_tree_sk[0000-16-2-00000000000000000000000000000000-86AD9732D5A192A749ADCE31919DAE8A]",
        "parametrize",
        "pytestmark",
        "0000-16-2-00000000000000000000000000000000-86AD9732D5A192A749ADCE31919DAE8A",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 85,
          "message": "ValueError: Triple DES key degenerates to single DES"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 387,
            "message": ""
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 431,
            "message": "in derive_emv2000_tree_sk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 425,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 405,
            "message": "in derive"
          },
          {
            "path": "pyemv\\tools.py",
            "lineno": 171,
            "message": "in encrypt_tdes_ecb"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_ecb.py",
            "lineno": 216,
            "message": "in _create_ecb_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 85,
            "message": "ValueError"
          }
        ],
        "longrepr": "atc = '0000', height = 16, branch = 2, iv = '00000000000000000000000000000000'\nsk = '86AD9732D5A192A749ADCE31919DAE8A'\n\n    @pytest.mark.parametrize(\n        [\"atc\", \"height\", \"branch\", \"iv\", \"sk\"],\n        [\n            # Small ATC\n            (\"0000\",  8, 4, \"00000000000000000000000000000000\", \"80BF3145AECB948A5201DAB9EF469875\"),\n            (\"0000\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"DC31BC40B3AB8F73F2E3DA5EBF9DE59B\"),\n            (\"0000\", 16, 2, \"00000000000000000000000000000000\", \"86AD9732D5A192A749ADCE31919DAE8A\"),\n            (\"0000\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"7C57A15261202A101C6DA29B16672A3E\"),\n            # Medium ATC\n            (\"00FF\",  8, 4, \"00000000000000000000000000000000\", \"981F9D208AE6132CBC8A7C97F42A5445\"),\n            (\"00FF\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"D579C8A4927589017FA1739B2C853BAD\"),\n            (\"00FF\", 16, 2, \"00000000000000000000000000000000\", \"1F54F492EF104580B0F4B0F8910D0438\"),\n            (\"00FF\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"2086F81AAB731FF8CED9BF6DA7191CA2\"),\n            # Large ATC\n            (\"FFFF\",  8, 4, \"00000000000000000000000000000000\", \"D93D7A6B70F867615D4AAB79BF235B62\"),\n            (\"FFFF\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"A10EA78F2F1ACE203B3B402F6EE6CB29\"),\n            (\"FFFF\", 16, 2, \"00000000000000000000000000000000\", \"F83E499EF786C20BC41310A176E3F84F\"),\n            (\"FFFF\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"73E3B0A1406E5E4908D5804C4970E520\"),\n        ],\n    )\n    # fmt: on\n    def test_derive_emv2000_tree_sk(\n        atc: str,\n        height: int,\n        branch: int,\n        iv: str,\n        sk: str,\n    ) -> None:\n>       assert bytes.fromhex(sk) == kd.derive_emv2000_tree_sk(\n            bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\"),\n            bytes.fromhex(atc),\n            height,\n            branch,\n            bytes.fromhex(iv),\n        )\n\ntests\\test_kd_hsm.py:387: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\kd.py:431: in derive_emv2000_tree_sk\n    p, gp = walk(atc_num // branch_factor, height - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:425: in walk\n    return derive(p, gp, j), p\npyemv\\kd.py:405: in derive\n    l_data = _tools.encrypt_tdes_ecb(x, l_data)\npyemv\\tools.py:171: in encrypt_tdes_ecb\n    cipher = DES3.new(key, DES3.MODE_ECB)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_ecb.py:216: in _create_ecb_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\x01#Eg\\x89\\xab\\xcd\\xef\\x01#Eg\\x89\\xab\\xcd\\xef'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n            raise ValueError(\"Not a valid TDES key\")\n    \n        key_out = b\"\".join([ bchr(parity_byte(bord(x))) for x in key_in ])\n    \n        if key_out[:8] == key_out[8:16] or key_out[-16:-8] == key_out[-8:]:\n>           raise ValueError(\"Triple DES key degenerates to single DES\")\nE           ValueError: Triple DES key degenerates to single DES\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:85: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_emv2000_tree_sk[0000-16-2-F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0-7C57A15261202A101C6DA29B16672A3E]",
      "lineno": 358,
      "outcome": "failed",
      "keywords": [
        "test_derive_emv2000_tree_sk[0000-16-2-F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0-7C57A15261202A101C6DA29B16672A3E]",
        "parametrize",
        "pytestmark",
        "0000-16-2-F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0-7C57A15261202A101C6DA29B16672A3E",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 85,
          "message": "ValueError: Triple DES key degenerates to single DES"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 387,
            "message": ""
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 431,
            "message": "in derive_emv2000_tree_sk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 425,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 405,
            "message": "in derive"
          },
          {
            "path": "pyemv\\tools.py",
            "lineno": 171,
            "message": "in encrypt_tdes_ecb"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_ecb.py",
            "lineno": 216,
            "message": "in _create_ecb_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 85,
            "message": "ValueError"
          }
        ],
        "longrepr": "atc = '0000', height = 16, branch = 2, iv = 'F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0'\nsk = '7C57A15261202A101C6DA29B16672A3E'\n\n    @pytest.mark.parametrize(\n        [\"atc\", \"height\", \"branch\", \"iv\", \"sk\"],\n        [\n            # Small ATC\n            (\"0000\",  8, 4, \"00000000000000000000000000000000\", \"80BF3145AECB948A5201DAB9EF469875\"),\n            (\"0000\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"DC31BC40B3AB8F73F2E3DA5EBF9DE59B\"),\n            (\"0000\", 16, 2, \"00000000000000000000000000000000\", \"86AD9732D5A192A749ADCE31919DAE8A\"),\n            (\"0000\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"7C57A15261202A101C6DA29B16672A3E\"),\n            # Medium ATC\n            (\"00FF\",  8, 4, \"00000000000000000000000000000000\", \"981F9D208AE6132CBC8A7C97F42A5445\"),\n            (\"00FF\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"D579C8A4927589017FA1739B2C853BAD\"),\n            (\"00FF\", 16, 2, \"00000000000000000000000000000000\", \"1F54F492EF104580B0F4B0F8910D0438\"),\n            (\"00FF\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"2086F81AAB731FF8CED9BF6DA7191CA2\"),\n            # Large ATC\n            (\"FFFF\",  8, 4, \"00000000000000000000000000000000\", \"D93D7A6B70F867615D4AAB79BF235B62\"),\n            (\"FFFF\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"A10EA78F2F1ACE203B3B402F6EE6CB29\"),\n            (\"FFFF\", 16, 2, \"00000000000000000000000000000000\", \"F83E499EF786C20BC41310A176E3F84F\"),\n            (\"FFFF\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"73E3B0A1406E5E4908D5804C4970E520\"),\n        ],\n    )\n    # fmt: on\n    def test_derive_emv2000_tree_sk(\n        atc: str,\n        height: int,\n        branch: int,\n        iv: str,\n        sk: str,\n    ) -> None:\n>       assert bytes.fromhex(sk) == kd.derive_emv2000_tree_sk(\n            bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\"),\n            bytes.fromhex(atc),\n            height,\n            branch,\n            bytes.fromhex(iv),\n        )\n\ntests\\test_kd_hsm.py:387: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\kd.py:431: in derive_emv2000_tree_sk\n    p, gp = walk(atc_num // branch_factor, height - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:425: in walk\n    return derive(p, gp, j), p\npyemv\\kd.py:405: in derive\n    l_data = _tools.encrypt_tdes_ecb(x, l_data)\npyemv\\tools.py:171: in encrypt_tdes_ecb\n    cipher = DES3.new(key, DES3.MODE_ECB)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_ecb.py:216: in _create_ecb_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\x01#Eg\\x89\\xab\\xcd\\xef\\x01#Eg\\x89\\xab\\xcd\\xef'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n            raise ValueError(\"Not a valid TDES key\")\n    \n        key_out = b\"\".join([ bchr(parity_byte(bord(x))) for x in key_in ])\n    \n        if key_out[:8] == key_out[8:16] or key_out[-16:-8] == key_out[-8:]:\n>           raise ValueError(\"Triple DES key degenerates to single DES\")\nE           ValueError: Triple DES key degenerates to single DES\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:85: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_emv2000_tree_sk[00FF-8-4-00000000000000000000000000000000-981F9D208AE6132CBC8A7C97F42A5445]",
      "lineno": 358,
      "outcome": "failed",
      "keywords": [
        "test_derive_emv2000_tree_sk[00FF-8-4-00000000000000000000000000000000-981F9D208AE6132CBC8A7C97F42A5445]",
        "parametrize",
        "pytestmark",
        "00FF-8-4-00000000000000000000000000000000-981F9D208AE6132CBC8A7C97F42A5445",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 85,
          "message": "ValueError: Triple DES key degenerates to single DES"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 387,
            "message": ""
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 431,
            "message": "in derive_emv2000_tree_sk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 425,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 405,
            "message": "in derive"
          },
          {
            "path": "pyemv\\tools.py",
            "lineno": 171,
            "message": "in encrypt_tdes_ecb"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_ecb.py",
            "lineno": 216,
            "message": "in _create_ecb_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 85,
            "message": "ValueError"
          }
        ],
        "longrepr": "atc = '00FF', height = 8, branch = 4, iv = '00000000000000000000000000000000'\nsk = '981F9D208AE6132CBC8A7C97F42A5445'\n\n    @pytest.mark.parametrize(\n        [\"atc\", \"height\", \"branch\", \"iv\", \"sk\"],\n        [\n            # Small ATC\n            (\"0000\",  8, 4, \"00000000000000000000000000000000\", \"80BF3145AECB948A5201DAB9EF469875\"),\n            (\"0000\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"DC31BC40B3AB8F73F2E3DA5EBF9DE59B\"),\n            (\"0000\", 16, 2, \"00000000000000000000000000000000\", \"86AD9732D5A192A749ADCE31919DAE8A\"),\n            (\"0000\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"7C57A15261202A101C6DA29B16672A3E\"),\n            # Medium ATC\n            (\"00FF\",  8, 4, \"00000000000000000000000000000000\", \"981F9D208AE6132CBC8A7C97F42A5445\"),\n            (\"00FF\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"D579C8A4927589017FA1739B2C853BAD\"),\n            (\"00FF\", 16, 2, \"00000000000000000000000000000000\", \"1F54F492EF104580B0F4B0F8910D0438\"),\n            (\"00FF\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"2086F81AAB731FF8CED9BF6DA7191CA2\"),\n            # Large ATC\n            (\"FFFF\",  8, 4, \"00000000000000000000000000000000\", \"D93D7A6B70F867615D4AAB79BF235B62\"),\n            (\"FFFF\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"A10EA78F2F1ACE203B3B402F6EE6CB29\"),\n            (\"FFFF\", 16, 2, \"00000000000000000000000000000000\", \"F83E499EF786C20BC41310A176E3F84F\"),\n            (\"FFFF\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"73E3B0A1406E5E4908D5804C4970E520\"),\n        ],\n    )\n    # fmt: on\n    def test_derive_emv2000_tree_sk(\n        atc: str,\n        height: int,\n        branch: int,\n        iv: str,\n        sk: str,\n    ) -> None:\n>       assert bytes.fromhex(sk) == kd.derive_emv2000_tree_sk(\n            bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\"),\n            bytes.fromhex(atc),\n            height,\n            branch,\n            bytes.fromhex(iv),\n        )\n\ntests\\test_kd_hsm.py:387: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\kd.py:431: in derive_emv2000_tree_sk\n    p, gp = walk(atc_num // branch_factor, height - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:425: in walk\n    return derive(p, gp, j), p\npyemv\\kd.py:405: in derive\n    l_data = _tools.encrypt_tdes_ecb(x, l_data)\npyemv\\tools.py:171: in encrypt_tdes_ecb\n    cipher = DES3.new(key, DES3.MODE_ECB)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_ecb.py:216: in _create_ecb_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\x01#Eg\\x89\\xab\\xcd\\xef\\x01#Eg\\x89\\xab\\xcd\\xef'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n            raise ValueError(\"Not a valid TDES key\")\n    \n        key_out = b\"\".join([ bchr(parity_byte(bord(x))) for x in key_in ])\n    \n        if key_out[:8] == key_out[8:16] or key_out[-16:-8] == key_out[-8:]:\n>           raise ValueError(\"Triple DES key degenerates to single DES\")\nE           ValueError: Triple DES key degenerates to single DES\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:85: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_emv2000_tree_sk[00FF-8-4-F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0-D579C8A4927589017FA1739B2C853BAD]",
      "lineno": 358,
      "outcome": "failed",
      "keywords": [
        "test_derive_emv2000_tree_sk[00FF-8-4-F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0-D579C8A4927589017FA1739B2C853BAD]",
        "parametrize",
        "pytestmark",
        "00FF-8-4-F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0-D579C8A4927589017FA1739B2C853BAD",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 85,
          "message": "ValueError: Triple DES key degenerates to single DES"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 387,
            "message": ""
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 431,
            "message": "in derive_emv2000_tree_sk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 425,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 405,
            "message": "in derive"
          },
          {
            "path": "pyemv\\tools.py",
            "lineno": 171,
            "message": "in encrypt_tdes_ecb"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_ecb.py",
            "lineno": 216,
            "message": "in _create_ecb_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 85,
            "message": "ValueError"
          }
        ],
        "longrepr": "atc = '00FF', height = 8, branch = 4, iv = 'F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0'\nsk = 'D579C8A4927589017FA1739B2C853BAD'\n\n    @pytest.mark.parametrize(\n        [\"atc\", \"height\", \"branch\", \"iv\", \"sk\"],\n        [\n            # Small ATC\n            (\"0000\",  8, 4, \"00000000000000000000000000000000\", \"80BF3145AECB948A5201DAB9EF469875\"),\n            (\"0000\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"DC31BC40B3AB8F73F2E3DA5EBF9DE59B\"),\n            (\"0000\", 16, 2, \"00000000000000000000000000000000\", \"86AD9732D5A192A749ADCE31919DAE8A\"),\n            (\"0000\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"7C57A15261202A101C6DA29B16672A3E\"),\n            # Medium ATC\n            (\"00FF\",  8, 4, \"00000000000000000000000000000000\", \"981F9D208AE6132CBC8A7C97F42A5445\"),\n            (\"00FF\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"D579C8A4927589017FA1739B2C853BAD\"),\n            (\"00FF\", 16, 2, \"00000000000000000000000000000000\", \"1F54F492EF104580B0F4B0F8910D0438\"),\n            (\"00FF\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"2086F81AAB731FF8CED9BF6DA7191CA2\"),\n            # Large ATC\n            (\"FFFF\",  8, 4, \"00000000000000000000000000000000\", \"D93D7A6B70F867615D4AAB79BF235B62\"),\n            (\"FFFF\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"A10EA78F2F1ACE203B3B402F6EE6CB29\"),\n            (\"FFFF\", 16, 2, \"00000000000000000000000000000000\", \"F83E499EF786C20BC41310A176E3F84F\"),\n            (\"FFFF\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"73E3B0A1406E5E4908D5804C4970E520\"),\n        ],\n    )\n    # fmt: on\n    def test_derive_emv2000_tree_sk(\n        atc: str,\n        height: int,\n        branch: int,\n        iv: str,\n        sk: str,\n    ) -> None:\n>       assert bytes.fromhex(sk) == kd.derive_emv2000_tree_sk(\n            bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\"),\n            bytes.fromhex(atc),\n            height,\n            branch,\n            bytes.fromhex(iv),\n        )\n\ntests\\test_kd_hsm.py:387: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\kd.py:431: in derive_emv2000_tree_sk\n    p, gp = walk(atc_num // branch_factor, height - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:425: in walk\n    return derive(p, gp, j), p\npyemv\\kd.py:405: in derive\n    l_data = _tools.encrypt_tdes_ecb(x, l_data)\npyemv\\tools.py:171: in encrypt_tdes_ecb\n    cipher = DES3.new(key, DES3.MODE_ECB)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_ecb.py:216: in _create_ecb_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\x01#Eg\\x89\\xab\\xcd\\xef\\x01#Eg\\x89\\xab\\xcd\\xef'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n            raise ValueError(\"Not a valid TDES key\")\n    \n        key_out = b\"\".join([ bchr(parity_byte(bord(x))) for x in key_in ])\n    \n        if key_out[:8] == key_out[8:16] or key_out[-16:-8] == key_out[-8:]:\n>           raise ValueError(\"Triple DES key degenerates to single DES\")\nE           ValueError: Triple DES key degenerates to single DES\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:85: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_emv2000_tree_sk[00FF-16-2-00000000000000000000000000000000-1F54F492EF104580B0F4B0F8910D0438]",
      "lineno": 358,
      "outcome": "failed",
      "keywords": [
        "test_derive_emv2000_tree_sk[00FF-16-2-00000000000000000000000000000000-1F54F492EF104580B0F4B0F8910D0438]",
        "parametrize",
        "pytestmark",
        "00FF-16-2-00000000000000000000000000000000-1F54F492EF104580B0F4B0F8910D0438",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 85,
          "message": "ValueError: Triple DES key degenerates to single DES"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 387,
            "message": ""
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 431,
            "message": "in derive_emv2000_tree_sk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 425,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 405,
            "message": "in derive"
          },
          {
            "path": "pyemv\\tools.py",
            "lineno": 171,
            "message": "in encrypt_tdes_ecb"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_ecb.py",
            "lineno": 216,
            "message": "in _create_ecb_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 85,
            "message": "ValueError"
          }
        ],
        "longrepr": "atc = '00FF', height = 16, branch = 2, iv = '00000000000000000000000000000000'\nsk = '1F54F492EF104580B0F4B0F8910D0438'\n\n    @pytest.mark.parametrize(\n        [\"atc\", \"height\", \"branch\", \"iv\", \"sk\"],\n        [\n            # Small ATC\n            (\"0000\",  8, 4, \"00000000000000000000000000000000\", \"80BF3145AECB948A5201DAB9EF469875\"),\n            (\"0000\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"DC31BC40B3AB8F73F2E3DA5EBF9DE59B\"),\n            (\"0000\", 16, 2, \"00000000000000000000000000000000\", \"86AD9732D5A192A749ADCE31919DAE8A\"),\n            (\"0000\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"7C57A15261202A101C6DA29B16672A3E\"),\n            # Medium ATC\n            (\"00FF\",  8, 4, \"00000000000000000000000000000000\", \"981F9D208AE6132CBC8A7C97F42A5445\"),\n            (\"00FF\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"D579C8A4927589017FA1739B2C853BAD\"),\n            (\"00FF\", 16, 2, \"00000000000000000000000000000000\", \"1F54F492EF104580B0F4B0F8910D0438\"),\n            (\"00FF\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"2086F81AAB731FF8CED9BF6DA7191CA2\"),\n            # Large ATC\n            (\"FFFF\",  8, 4, \"00000000000000000000000000000000\", \"D93D7A6B70F867615D4AAB79BF235B62\"),\n            (\"FFFF\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"A10EA78F2F1ACE203B3B402F6EE6CB29\"),\n            (\"FFFF\", 16, 2, \"00000000000000000000000000000000\", \"F83E499EF786C20BC41310A176E3F84F\"),\n            (\"FFFF\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"73E3B0A1406E5E4908D5804C4970E520\"),\n        ],\n    )\n    # fmt: on\n    def test_derive_emv2000_tree_sk(\n        atc: str,\n        height: int,\n        branch: int,\n        iv: str,\n        sk: str,\n    ) -> None:\n>       assert bytes.fromhex(sk) == kd.derive_emv2000_tree_sk(\n            bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\"),\n            bytes.fromhex(atc),\n            height,\n            branch,\n            bytes.fromhex(iv),\n        )\n\ntests\\test_kd_hsm.py:387: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\kd.py:431: in derive_emv2000_tree_sk\n    p, gp = walk(atc_num // branch_factor, height - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:425: in walk\n    return derive(p, gp, j), p\npyemv\\kd.py:405: in derive\n    l_data = _tools.encrypt_tdes_ecb(x, l_data)\npyemv\\tools.py:171: in encrypt_tdes_ecb\n    cipher = DES3.new(key, DES3.MODE_ECB)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_ecb.py:216: in _create_ecb_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\x01#Eg\\x89\\xab\\xcd\\xef\\x01#Eg\\x89\\xab\\xcd\\xef'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n            raise ValueError(\"Not a valid TDES key\")\n    \n        key_out = b\"\".join([ bchr(parity_byte(bord(x))) for x in key_in ])\n    \n        if key_out[:8] == key_out[8:16] or key_out[-16:-8] == key_out[-8:]:\n>           raise ValueError(\"Triple DES key degenerates to single DES\")\nE           ValueError: Triple DES key degenerates to single DES\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:85: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_emv2000_tree_sk[00FF-16-2-F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0-2086F81AAB731FF8CED9BF6DA7191CA2]",
      "lineno": 358,
      "outcome": "failed",
      "keywords": [
        "test_derive_emv2000_tree_sk[00FF-16-2-F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0-2086F81AAB731FF8CED9BF6DA7191CA2]",
        "parametrize",
        "pytestmark",
        "00FF-16-2-F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0-2086F81AAB731FF8CED9BF6DA7191CA2",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 85,
          "message": "ValueError: Triple DES key degenerates to single DES"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 387,
            "message": ""
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 431,
            "message": "in derive_emv2000_tree_sk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 425,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 405,
            "message": "in derive"
          },
          {
            "path": "pyemv\\tools.py",
            "lineno": 171,
            "message": "in encrypt_tdes_ecb"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_ecb.py",
            "lineno": 216,
            "message": "in _create_ecb_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 85,
            "message": "ValueError"
          }
        ],
        "longrepr": "atc = '00FF', height = 16, branch = 2, iv = 'F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0'\nsk = '2086F81AAB731FF8CED9BF6DA7191CA2'\n\n    @pytest.mark.parametrize(\n        [\"atc\", \"height\", \"branch\", \"iv\", \"sk\"],\n        [\n            # Small ATC\n            (\"0000\",  8, 4, \"00000000000000000000000000000000\", \"80BF3145AECB948A5201DAB9EF469875\"),\n            (\"0000\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"DC31BC40B3AB8F73F2E3DA5EBF9DE59B\"),\n            (\"0000\", 16, 2, \"00000000000000000000000000000000\", \"86AD9732D5A192A749ADCE31919DAE8A\"),\n            (\"0000\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"7C57A15261202A101C6DA29B16672A3E\"),\n            # Medium ATC\n            (\"00FF\",  8, 4, \"00000000000000000000000000000000\", \"981F9D208AE6132CBC8A7C97F42A5445\"),\n            (\"00FF\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"D579C8A4927589017FA1739B2C853BAD\"),\n            (\"00FF\", 16, 2, \"00000000000000000000000000000000\", \"1F54F492EF104580B0F4B0F8910D0438\"),\n            (\"00FF\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"2086F81AAB731FF8CED9BF6DA7191CA2\"),\n            # Large ATC\n            (\"FFFF\",  8, 4, \"00000000000000000000000000000000\", \"D93D7A6B70F867615D4AAB79BF235B62\"),\n            (\"FFFF\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"A10EA78F2F1ACE203B3B402F6EE6CB29\"),\n            (\"FFFF\", 16, 2, \"00000000000000000000000000000000\", \"F83E499EF786C20BC41310A176E3F84F\"),\n            (\"FFFF\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"73E3B0A1406E5E4908D5804C4970E520\"),\n        ],\n    )\n    # fmt: on\n    def test_derive_emv2000_tree_sk(\n        atc: str,\n        height: int,\n        branch: int,\n        iv: str,\n        sk: str,\n    ) -> None:\n>       assert bytes.fromhex(sk) == kd.derive_emv2000_tree_sk(\n            bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\"),\n            bytes.fromhex(atc),\n            height,\n            branch,\n            bytes.fromhex(iv),\n        )\n\ntests\\test_kd_hsm.py:387: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\kd.py:431: in derive_emv2000_tree_sk\n    p, gp = walk(atc_num // branch_factor, height - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:425: in walk\n    return derive(p, gp, j), p\npyemv\\kd.py:405: in derive\n    l_data = _tools.encrypt_tdes_ecb(x, l_data)\npyemv\\tools.py:171: in encrypt_tdes_ecb\n    cipher = DES3.new(key, DES3.MODE_ECB)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_ecb.py:216: in _create_ecb_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\x01#Eg\\x89\\xab\\xcd\\xef\\x01#Eg\\x89\\xab\\xcd\\xef'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n            raise ValueError(\"Not a valid TDES key\")\n    \n        key_out = b\"\".join([ bchr(parity_byte(bord(x))) for x in key_in ])\n    \n        if key_out[:8] == key_out[8:16] or key_out[-16:-8] == key_out[-8:]:\n>           raise ValueError(\"Triple DES key degenerates to single DES\")\nE           ValueError: Triple DES key degenerates to single DES\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:85: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_emv2000_tree_sk[FFFF-8-4-00000000000000000000000000000000-D93D7A6B70F867615D4AAB79BF235B62]",
      "lineno": 358,
      "outcome": "failed",
      "keywords": [
        "test_derive_emv2000_tree_sk[FFFF-8-4-00000000000000000000000000000000-D93D7A6B70F867615D4AAB79BF235B62]",
        "parametrize",
        "pytestmark",
        "FFFF-8-4-00000000000000000000000000000000-D93D7A6B70F867615D4AAB79BF235B62",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 85,
          "message": "ValueError: Triple DES key degenerates to single DES"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 387,
            "message": ""
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 431,
            "message": "in derive_emv2000_tree_sk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 425,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 405,
            "message": "in derive"
          },
          {
            "path": "pyemv\\tools.py",
            "lineno": 171,
            "message": "in encrypt_tdes_ecb"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_ecb.py",
            "lineno": 216,
            "message": "in _create_ecb_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 85,
            "message": "ValueError"
          }
        ],
        "longrepr": "atc = 'FFFF', height = 8, branch = 4, iv = '00000000000000000000000000000000'\nsk = 'D93D7A6B70F867615D4AAB79BF235B62'\n\n    @pytest.mark.parametrize(\n        [\"atc\", \"height\", \"branch\", \"iv\", \"sk\"],\n        [\n            # Small ATC\n            (\"0000\",  8, 4, \"00000000000000000000000000000000\", \"80BF3145AECB948A5201DAB9EF469875\"),\n            (\"0000\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"DC31BC40B3AB8F73F2E3DA5EBF9DE59B\"),\n            (\"0000\", 16, 2, \"00000000000000000000000000000000\", \"86AD9732D5A192A749ADCE31919DAE8A\"),\n            (\"0000\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"7C57A15261202A101C6DA29B16672A3E\"),\n            # Medium ATC\n            (\"00FF\",  8, 4, \"00000000000000000000000000000000\", \"981F9D208AE6132CBC8A7C97F42A5445\"),\n            (\"00FF\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"D579C8A4927589017FA1739B2C853BAD\"),\n            (\"00FF\", 16, 2, \"00000000000000000000000000000000\", \"1F54F492EF104580B0F4B0F8910D0438\"),\n            (\"00FF\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"2086F81AAB731FF8CED9BF6DA7191CA2\"),\n            # Large ATC\n            (\"FFFF\",  8, 4, \"00000000000000000000000000000000\", \"D93D7A6B70F867615D4AAB79BF235B62\"),\n            (\"FFFF\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"A10EA78F2F1ACE203B3B402F6EE6CB29\"),\n            (\"FFFF\", 16, 2, \"00000000000000000000000000000000\", \"F83E499EF786C20BC41310A176E3F84F\"),\n            (\"FFFF\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"73E3B0A1406E5E4908D5804C4970E520\"),\n        ],\n    )\n    # fmt: on\n    def test_derive_emv2000_tree_sk(\n        atc: str,\n        height: int,\n        branch: int,\n        iv: str,\n        sk: str,\n    ) -> None:\n>       assert bytes.fromhex(sk) == kd.derive_emv2000_tree_sk(\n            bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\"),\n            bytes.fromhex(atc),\n            height,\n            branch,\n            bytes.fromhex(iv),\n        )\n\ntests\\test_kd_hsm.py:387: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\kd.py:431: in derive_emv2000_tree_sk\n    p, gp = walk(atc_num // branch_factor, height - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:425: in walk\n    return derive(p, gp, j), p\npyemv\\kd.py:405: in derive\n    l_data = _tools.encrypt_tdes_ecb(x, l_data)\npyemv\\tools.py:171: in encrypt_tdes_ecb\n    cipher = DES3.new(key, DES3.MODE_ECB)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_ecb.py:216: in _create_ecb_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\x01#Eg\\x89\\xab\\xcd\\xef\\x01#Eg\\x89\\xab\\xcd\\xef'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n            raise ValueError(\"Not a valid TDES key\")\n    \n        key_out = b\"\".join([ bchr(parity_byte(bord(x))) for x in key_in ])\n    \n        if key_out[:8] == key_out[8:16] or key_out[-16:-8] == key_out[-8:]:\n>           raise ValueError(\"Triple DES key degenerates to single DES\")\nE           ValueError: Triple DES key degenerates to single DES\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:85: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_emv2000_tree_sk[FFFF-8-4-F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0-A10EA78F2F1ACE203B3B402F6EE6CB29]",
      "lineno": 358,
      "outcome": "failed",
      "keywords": [
        "test_derive_emv2000_tree_sk[FFFF-8-4-F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0-A10EA78F2F1ACE203B3B402F6EE6CB29]",
        "parametrize",
        "pytestmark",
        "FFFF-8-4-F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0-A10EA78F2F1ACE203B3B402F6EE6CB29",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 85,
          "message": "ValueError: Triple DES key degenerates to single DES"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 387,
            "message": ""
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 431,
            "message": "in derive_emv2000_tree_sk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 425,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 405,
            "message": "in derive"
          },
          {
            "path": "pyemv\\tools.py",
            "lineno": 171,
            "message": "in encrypt_tdes_ecb"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_ecb.py",
            "lineno": 216,
            "message": "in _create_ecb_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 85,
            "message": "ValueError"
          }
        ],
        "longrepr": "atc = 'FFFF', height = 8, branch = 4, iv = 'F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0'\nsk = 'A10EA78F2F1ACE203B3B402F6EE6CB29'\n\n    @pytest.mark.parametrize(\n        [\"atc\", \"height\", \"branch\", \"iv\", \"sk\"],\n        [\n            # Small ATC\n            (\"0000\",  8, 4, \"00000000000000000000000000000000\", \"80BF3145AECB948A5201DAB9EF469875\"),\n            (\"0000\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"DC31BC40B3AB8F73F2E3DA5EBF9DE59B\"),\n            (\"0000\", 16, 2, \"00000000000000000000000000000000\", \"86AD9732D5A192A749ADCE31919DAE8A\"),\n            (\"0000\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"7C57A15261202A101C6DA29B16672A3E\"),\n            # Medium ATC\n            (\"00FF\",  8, 4, \"00000000000000000000000000000000\", \"981F9D208AE6132CBC8A7C97F42A5445\"),\n            (\"00FF\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"D579C8A4927589017FA1739B2C853BAD\"),\n            (\"00FF\", 16, 2, \"00000000000000000000000000000000\", \"1F54F492EF104580B0F4B0F8910D0438\"),\n            (\"00FF\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"2086F81AAB731FF8CED9BF6DA7191CA2\"),\n            # Large ATC\n            (\"FFFF\",  8, 4, \"00000000000000000000000000000000\", \"D93D7A6B70F867615D4AAB79BF235B62\"),\n            (\"FFFF\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"A10EA78F2F1ACE203B3B402F6EE6CB29\"),\n            (\"FFFF\", 16, 2, \"00000000000000000000000000000000\", \"F83E499EF786C20BC41310A176E3F84F\"),\n            (\"FFFF\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"73E3B0A1406E5E4908D5804C4970E520\"),\n        ],\n    )\n    # fmt: on\n    def test_derive_emv2000_tree_sk(\n        atc: str,\n        height: int,\n        branch: int,\n        iv: str,\n        sk: str,\n    ) -> None:\n>       assert bytes.fromhex(sk) == kd.derive_emv2000_tree_sk(\n            bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\"),\n            bytes.fromhex(atc),\n            height,\n            branch,\n            bytes.fromhex(iv),\n        )\n\ntests\\test_kd_hsm.py:387: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\kd.py:431: in derive_emv2000_tree_sk\n    p, gp = walk(atc_num // branch_factor, height - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:425: in walk\n    return derive(p, gp, j), p\npyemv\\kd.py:405: in derive\n    l_data = _tools.encrypt_tdes_ecb(x, l_data)\npyemv\\tools.py:171: in encrypt_tdes_ecb\n    cipher = DES3.new(key, DES3.MODE_ECB)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_ecb.py:216: in _create_ecb_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\x01#Eg\\x89\\xab\\xcd\\xef\\x01#Eg\\x89\\xab\\xcd\\xef'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n            raise ValueError(\"Not a valid TDES key\")\n    \n        key_out = b\"\".join([ bchr(parity_byte(bord(x))) for x in key_in ])\n    \n        if key_out[:8] == key_out[8:16] or key_out[-16:-8] == key_out[-8:]:\n>           raise ValueError(\"Triple DES key degenerates to single DES\")\nE           ValueError: Triple DES key degenerates to single DES\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:85: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_emv2000_tree_sk[FFFF-16-2-00000000000000000000000000000000-F83E499EF786C20BC41310A176E3F84F]",
      "lineno": 358,
      "outcome": "failed",
      "keywords": [
        "test_derive_emv2000_tree_sk[FFFF-16-2-00000000000000000000000000000000-F83E499EF786C20BC41310A176E3F84F]",
        "parametrize",
        "pytestmark",
        "FFFF-16-2-00000000000000000000000000000000-F83E499EF786C20BC41310A176E3F84F",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 85,
          "message": "ValueError: Triple DES key degenerates to single DES"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 387,
            "message": ""
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 431,
            "message": "in derive_emv2000_tree_sk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 425,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 405,
            "message": "in derive"
          },
          {
            "path": "pyemv\\tools.py",
            "lineno": 171,
            "message": "in encrypt_tdes_ecb"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_ecb.py",
            "lineno": 216,
            "message": "in _create_ecb_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 85,
            "message": "ValueError"
          }
        ],
        "longrepr": "atc = 'FFFF', height = 16, branch = 2, iv = '00000000000000000000000000000000'\nsk = 'F83E499EF786C20BC41310A176E3F84F'\n\n    @pytest.mark.parametrize(\n        [\"atc\", \"height\", \"branch\", \"iv\", \"sk\"],\n        [\n            # Small ATC\n            (\"0000\",  8, 4, \"00000000000000000000000000000000\", \"80BF3145AECB948A5201DAB9EF469875\"),\n            (\"0000\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"DC31BC40B3AB8F73F2E3DA5EBF9DE59B\"),\n            (\"0000\", 16, 2, \"00000000000000000000000000000000\", \"86AD9732D5A192A749ADCE31919DAE8A\"),\n            (\"0000\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"7C57A15261202A101C6DA29B16672A3E\"),\n            # Medium ATC\n            (\"00FF\",  8, 4, \"00000000000000000000000000000000\", \"981F9D208AE6132CBC8A7C97F42A5445\"),\n            (\"00FF\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"D579C8A4927589017FA1739B2C853BAD\"),\n            (\"00FF\", 16, 2, \"00000000000000000000000000000000\", \"1F54F492EF104580B0F4B0F8910D0438\"),\n            (\"00FF\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"2086F81AAB731FF8CED9BF6DA7191CA2\"),\n            # Large ATC\n            (\"FFFF\",  8, 4, \"00000000000000000000000000000000\", \"D93D7A6B70F867615D4AAB79BF235B62\"),\n            (\"FFFF\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"A10EA78F2F1ACE203B3B402F6EE6CB29\"),\n            (\"FFFF\", 16, 2, \"00000000000000000000000000000000\", \"F83E499EF786C20BC41310A176E3F84F\"),\n            (\"FFFF\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"73E3B0A1406E5E4908D5804C4970E520\"),\n        ],\n    )\n    # fmt: on\n    def test_derive_emv2000_tree_sk(\n        atc: str,\n        height: int,\n        branch: int,\n        iv: str,\n        sk: str,\n    ) -> None:\n>       assert bytes.fromhex(sk) == kd.derive_emv2000_tree_sk(\n            bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\"),\n            bytes.fromhex(atc),\n            height,\n            branch,\n            bytes.fromhex(iv),\n        )\n\ntests\\test_kd_hsm.py:387: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\kd.py:431: in derive_emv2000_tree_sk\n    p, gp = walk(atc_num // branch_factor, height - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:425: in walk\n    return derive(p, gp, j), p\npyemv\\kd.py:405: in derive\n    l_data = _tools.encrypt_tdes_ecb(x, l_data)\npyemv\\tools.py:171: in encrypt_tdes_ecb\n    cipher = DES3.new(key, DES3.MODE_ECB)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_ecb.py:216: in _create_ecb_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\x01#Eg\\x89\\xab\\xcd\\xef\\x01#Eg\\x89\\xab\\xcd\\xef'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n            raise ValueError(\"Not a valid TDES key\")\n    \n        key_out = b\"\".join([ bchr(parity_byte(bord(x))) for x in key_in ])\n    \n        if key_out[:8] == key_out[8:16] or key_out[-16:-8] == key_out[-8:]:\n>           raise ValueError(\"Triple DES key degenerates to single DES\")\nE           ValueError: Triple DES key degenerates to single DES\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:85: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kd_hsm.py::test_derive_emv2000_tree_sk[FFFF-16-2-F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0-73E3B0A1406E5E4908D5804C4970E520]",
      "lineno": 358,
      "outcome": "failed",
      "keywords": [
        "test_derive_emv2000_tree_sk[FFFF-16-2-F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0-73E3B0A1406E5E4908D5804C4970E520]",
        "parametrize",
        "pytestmark",
        "FFFF-16-2-F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0-73E3B0A1406E5E4908D5804C4970E520",
        "test_kd_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 85,
          "message": "ValueError: Triple DES key degenerates to single DES"
        },
        "traceback": [
          {
            "path": "tests\\test_kd_hsm.py",
            "lineno": 387,
            "message": ""
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 431,
            "message": "in derive_emv2000_tree_sk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 422,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 425,
            "message": "in walk"
          },
          {
            "path": "pyemv\\kd.py",
            "lineno": 405,
            "message": "in derive"
          },
          {
            "path": "pyemv\\tools.py",
            "lineno": 171,
            "message": "in encrypt_tdes_ecb"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_ecb.py",
            "lineno": 216,
            "message": "in _create_ecb_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 85,
            "message": "ValueError"
          }
        ],
        "longrepr": "atc = 'FFFF', height = 16, branch = 2, iv = 'F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0'\nsk = '73E3B0A1406E5E4908D5804C4970E520'\n\n    @pytest.mark.parametrize(\n        [\"atc\", \"height\", \"branch\", \"iv\", \"sk\"],\n        [\n            # Small ATC\n            (\"0000\",  8, 4, \"00000000000000000000000000000000\", \"80BF3145AECB948A5201DAB9EF469875\"),\n            (\"0000\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"DC31BC40B3AB8F73F2E3DA5EBF9DE59B\"),\n            (\"0000\", 16, 2, \"00000000000000000000000000000000\", \"86AD9732D5A192A749ADCE31919DAE8A\"),\n            (\"0000\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"7C57A15261202A101C6DA29B16672A3E\"),\n            # Medium ATC\n            (\"00FF\",  8, 4, \"00000000000000000000000000000000\", \"981F9D208AE6132CBC8A7C97F42A5445\"),\n            (\"00FF\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"D579C8A4927589017FA1739B2C853BAD\"),\n            (\"00FF\", 16, 2, \"00000000000000000000000000000000\", \"1F54F492EF104580B0F4B0F8910D0438\"),\n            (\"00FF\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"2086F81AAB731FF8CED9BF6DA7191CA2\"),\n            # Large ATC\n            (\"FFFF\",  8, 4, \"00000000000000000000000000000000\", \"D93D7A6B70F867615D4AAB79BF235B62\"),\n            (\"FFFF\",  8, 4, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"A10EA78F2F1ACE203B3B402F6EE6CB29\"),\n            (\"FFFF\", 16, 2, \"00000000000000000000000000000000\", \"F83E499EF786C20BC41310A176E3F84F\"),\n            (\"FFFF\", 16, 2, \"F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0\", \"73E3B0A1406E5E4908D5804C4970E520\"),\n        ],\n    )\n    # fmt: on\n    def test_derive_emv2000_tree_sk(\n        atc: str,\n        height: int,\n        branch: int,\n        iv: str,\n        sk: str,\n    ) -> None:\n>       assert bytes.fromhex(sk) == kd.derive_emv2000_tree_sk(\n            bytes.fromhex(\"0123456789ABCDEF0123456789ABCDEF\"),\n            bytes.fromhex(atc),\n            height,\n            branch,\n            bytes.fromhex(iv),\n        )\n\ntests\\test_kd_hsm.py:387: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\kd.py:431: in derive_emv2000_tree_sk\n    p, gp = walk(atc_num // branch_factor, height - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:422: in walk\n    p, gp = walk(j // branch_factor, h - 1)\npyemv\\kd.py:425: in walk\n    return derive(p, gp, j), p\npyemv\\kd.py:405: in derive\n    l_data = _tools.encrypt_tdes_ecb(x, l_data)\npyemv\\tools.py:171: in encrypt_tdes_ecb\n    cipher = DES3.new(key, DES3.MODE_ECB)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_ecb.py:216: in _create_ecb_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\x01#Eg\\x89\\xab\\xcd\\xef\\x01#Eg\\x89\\xab\\xcd\\xef'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n            raise ValueError(\"Not a valid TDES key\")\n    \n        key_out = b\"\".join([ bchr(parity_byte(bord(x))) for x in key_in ])\n    \n        if key_out[:8] == key_out[8:16] or key_out[-16:-8] == key_out[-8:]:\n>           raise ValueError(\"Triple DES key degenerates to single DES\")\nE           ValueError: Triple DES key degenerates to single DES\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:85: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_mac.py::test_mac_iso9797_3",
      "lineno": 5,
      "outcome": "failed",
      "keywords": [
        "test_mac_iso9797_3",
        "test_mac.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_mac.py",
            "lineno": 20,
            "message": ""
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "def test_mac_iso9797_3() -> None:\n        # SK < 16 bytes\n        with pytest.raises(\n            ValueError,\n            match=\"pecify valid padding method: 1 or 2.\",\n        ):\n            mac.mac_iso9797_3(\n                bytes.fromhex(\"AAAAAAAAAAAAAAAA\"),\n                bytes.fromhex(\"BBBBBBBBBBBBBBBB\"),\n                b\"hello world\",\n                4,\n            )\n    \n        _mac = (\n>           mac.mac_iso9797_3(\n                bytes.fromhex(\"AAAAAAAAAAAAAAAA\"),\n                bytes.fromhex(\"BBBBBBBBBBBBBBBB\"),\n                b\"hello world\",\n                1,\n            )\n            .hex()\n            .upper()\n        )\n\ntests\\test_mac.py:20: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_mac.py::test_pad_iso9797_1",
      "lineno": 43,
      "outcome": "passed",
      "keywords": [
        "test_pad_iso9797_1",
        "test_mac.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_mac.py::test_pad_iso9797_2",
      "lineno": 56,
      "outcome": "passed",
      "keywords": [
        "test_pad_iso9797_2",
        "test_mac.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_sm.py::test_generate_command_mac_exception",
      "lineno": 5,
      "outcome": "passed",
      "keywords": [
        "test_generate_command_mac_exception",
        "test_sm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_sm.py::test_encrypt_command_data_mastercard_nonpadded",
      "lineno": 27,
      "outcome": "passed",
      "keywords": [
        "test_encrypt_command_data_mastercard_nonpadded",
        "test_sm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_sm.py::test_encrypt_command_data_exception",
      "lineno": 49,
      "outcome": "passed",
      "keywords": [
        "test_encrypt_command_data_exception",
        "test_sm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_sm.py::test_format_vis_pin_block_exception",
      "lineno": 84,
      "outcome": "passed",
      "keywords": [
        "test_format_vis_pin_block_exception",
        "test_sm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_sm.py::test_format_iso9564_2_pin_block_exception",
      "lineno": 148,
      "outcome": "passed",
      "keywords": [
        "test_format_iso9564_2_pin_block_exception",
        "test_sm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_sm_hsm.py::test_generate_command_mac",
      "lineno": 6,
      "outcome": "failed",
      "keywords": [
        "test_generate_command_mac",
        "test_sm_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_sm_hsm.py",
            "lineno": 33,
            "message": ""
          },
          {
            "path": "pyemv\\sm.py",
            "lineno": 108,
            "message": "in generate_command_mac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "def test_generate_command_mac() -> None:\n        \"\"\"\n        Test generation of script command data MAC\n    \n        Master Key Derivation = Option A\n        SMI using Common Session Key Derivation (EMV SU-46)\n        MAC generation script command is padded with 0x80\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk_smi = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk_smi, 2).hex().upper() == \"08D7\"\n    \n        # Derive ICC master key\n        pan = \"1234567890123456\"\n        psn = \"01\"\n        icc_mk_smi = kd.derive_icc_mk_a(iss_mk_smi, pan, psn)\n        assert tools.key_check_digits(icc_mk_smi, 2).hex().upper() == \"0239\"\n    \n        # Verify SMI session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"ABCDEF1234567890\")\n        sk_smi = kd.derive_common_sk(icc_mk_smi, r)\n        assert tools.key_check_digits(sk_smi, 2).hex().upper() == \"F088\"\n    \n        # Script MAC generated using Session Key\n        script_command = bytes.fromhex(\"8424000008\")\n>       mac = sm.generate_command_mac(sk_smi, script_command)\n\ntests\\test_sm_hsm.py:33: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\sm.py:108: in generate_command_mac\n    return _mac.mac_iso9797_3(sk_smi[:8], sk_smi[-8:], command, 2, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'8u\\x80\\x97\\xae\\x8c\\x94\\x10'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_sm_hsm.py::test_mastercard_pin_change[9999_0]",
      "lineno": 36,
      "outcome": "failed",
      "keywords": [
        "test_mastercard_pin_change[9999_0]",
        "parametrize",
        "pytestmark",
        "9999_0",
        "test_sm_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_sm_hsm.py",
            "lineno": 86,
            "message": ""
          },
          {
            "path": "pyemv\\sm.py",
            "lineno": 108,
            "message": "in generate_command_mac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pin = b'9999'\n\n    @pytest.mark.parametrize(\n        \"pin\",\n        [\n            b\"9999\",\n            \"9999\",\n        ],\n    )\n    def test_mastercard_pin_change(pin: Union[bytes, str]) -> None:\n        \"\"\"\n        Test generation of offline PIN script with ISO format 2 PIN block\n    \n        Master Key Derivation = Option A\n        SMI/SMC using Common Session Key Derivation (EMV SU-46)\n        PIN encipherment with optional padding when block is not\n        multiple of 8. However, no padding takes place because PIN\n        block is 8 bytes long.\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk_smc = bytes.fromhex(\"11111111111111112222222222222222\")\n        assert tools.key_check_digits(iss_mk_smc, 3).hex().upper() == \"D2B91C\"\n        iss_mk_smi = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk_smi, 3).hex().upper() == \"08D7B4\"\n    \n        # Derive ICC master keys\n        pan = \"1234567890123456\"\n        psn = \"01\"\n        icc_mk_smc = kd.derive_icc_mk_a(iss_mk_smc, pan, psn)\n        assert tools.key_check_digits(icc_mk_smc, 3).hex().upper() == \"6B0F76\"\n        icc_mk_smi = kd.derive_icc_mk_a(iss_mk_smi, pan, psn)\n        assert tools.key_check_digits(icc_mk_smi, 3).hex().upper() == \"02396B\"\n    \n        # Verify SMC/SMI session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"ABCDEF1234567890\")\n        sk_smc = kd.derive_common_sk(icc_mk_smc, r)\n        assert tools.key_check_digits(sk_smc, 3).hex().upper() == \"D694B8\"\n        sk_smi = kd.derive_common_sk(icc_mk_smi, r)\n        assert tools.key_check_digits(sk_smi, 3).hex().upper() == \"F088F8\"\n    \n        # Encrypt new PIN\n        pin_block = sm.format_iso9564_2_pin_block(pin)\n        assert pin_block.hex().upper() == \"249999FFFFFFFFFF\"\n        command_data = sm.encrypt_command_data(\n            sk_smc, pin_block, sm.EncryptionType.MASTERCARD\n        )\n        assert command_data.hex().upper() == \"28367E05DE3381C2\"\n    \n        # Script MAC generated using Session Key\n        command_header = bytes.fromhex(\"8424000210\")\n>       mac = sm.generate_command_mac(sk_smi, command_header + command_data)\n\ntests\\test_sm_hsm.py:86: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\sm.py:108: in generate_command_mac\n    return _mac.mac_iso9797_3(sk_smi[:8], sk_smi[-8:], command, 2, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'8u\\x80\\x97\\xae\\x8c\\x94\\x10'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_sm_hsm.py::test_mastercard_pin_change[9999_1]",
      "lineno": 36,
      "outcome": "failed",
      "keywords": [
        "test_mastercard_pin_change[9999_1]",
        "parametrize",
        "pytestmark",
        "9999_1",
        "test_sm_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_sm_hsm.py",
            "lineno": 86,
            "message": ""
          },
          {
            "path": "pyemv\\sm.py",
            "lineno": 108,
            "message": "in generate_command_mac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pin = '9999'\n\n    @pytest.mark.parametrize(\n        \"pin\",\n        [\n            b\"9999\",\n            \"9999\",\n        ],\n    )\n    def test_mastercard_pin_change(pin: Union[bytes, str]) -> None:\n        \"\"\"\n        Test generation of offline PIN script with ISO format 2 PIN block\n    \n        Master Key Derivation = Option A\n        SMI/SMC using Common Session Key Derivation (EMV SU-46)\n        PIN encipherment with optional padding when block is not\n        multiple of 8. However, no padding takes place because PIN\n        block is 8 bytes long.\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk_smc = bytes.fromhex(\"11111111111111112222222222222222\")\n        assert tools.key_check_digits(iss_mk_smc, 3).hex().upper() == \"D2B91C\"\n        iss_mk_smi = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk_smi, 3).hex().upper() == \"08D7B4\"\n    \n        # Derive ICC master keys\n        pan = \"1234567890123456\"\n        psn = \"01\"\n        icc_mk_smc = kd.derive_icc_mk_a(iss_mk_smc, pan, psn)\n        assert tools.key_check_digits(icc_mk_smc, 3).hex().upper() == \"6B0F76\"\n        icc_mk_smi = kd.derive_icc_mk_a(iss_mk_smi, pan, psn)\n        assert tools.key_check_digits(icc_mk_smi, 3).hex().upper() == \"02396B\"\n    \n        # Verify SMC/SMI session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"ABCDEF1234567890\")\n        sk_smc = kd.derive_common_sk(icc_mk_smc, r)\n        assert tools.key_check_digits(sk_smc, 3).hex().upper() == \"D694B8\"\n        sk_smi = kd.derive_common_sk(icc_mk_smi, r)\n        assert tools.key_check_digits(sk_smi, 3).hex().upper() == \"F088F8\"\n    \n        # Encrypt new PIN\n        pin_block = sm.format_iso9564_2_pin_block(pin)\n        assert pin_block.hex().upper() == \"249999FFFFFFFFFF\"\n        command_data = sm.encrypt_command_data(\n            sk_smc, pin_block, sm.EncryptionType.MASTERCARD\n        )\n        assert command_data.hex().upper() == \"28367E05DE3381C2\"\n    \n        # Script MAC generated using Session Key\n        command_header = bytes.fromhex(\"8424000210\")\n>       mac = sm.generate_command_mac(sk_smi, command_header + command_data)\n\ntests\\test_sm_hsm.py:86: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\sm.py:108: in generate_command_mac\n    return _mac.mac_iso9797_3(sk_smi[:8], sk_smi[-8:], command, 2, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'8u\\x80\\x97\\xae\\x8c\\x94\\x10'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_sm_hsm.py::test_mastercard_pin_change_12[999999999999_0]",
      "lineno": 89,
      "outcome": "failed",
      "keywords": [
        "test_mastercard_pin_change_12[999999999999_0]",
        "parametrize",
        "pytestmark",
        "999999999999_0",
        "test_sm_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_sm_hsm.py",
            "lineno": 140,
            "message": ""
          },
          {
            "path": "pyemv\\sm.py",
            "lineno": 108,
            "message": "in generate_command_mac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pin = b'999999999999'\n\n    @pytest.mark.parametrize(\n        \"pin\",\n        [\n            b\"999999999999\",\n            \"999999999999\",\n        ],\n    )\n    def test_mastercard_pin_change_12(pin: Union[bytes, str]) -> None:\n        \"\"\"\n        Test generation of offline PIN script with ISO format 2 PIN block\n        PIN is 12 digits long.\n    \n        Master Key Derivation = Option A\n        SMI/SMC using Common Session Key Derivation (EMV SU-46)\n        PIN encipherment with optional padding when block is not\n        multiple of 8. However, no padding takes place because PIN\n        block is 8 bytes long.\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk_smc = bytes.fromhex(\"11111111111111112222222222222222\")\n        assert tools.key_check_digits(iss_mk_smc, 3).hex().upper() == \"D2B91C\"\n        iss_mk_smi = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk_smi, 3).hex().upper() == \"08D7B4\"\n    \n        # Derive ICC master keys\n        pan = \"1234567890123456\"\n        psn = \"01\"\n        icc_mk_smc = kd.derive_icc_mk_a(iss_mk_smc, pan, psn)\n        assert tools.key_check_digits(icc_mk_smc, 3).hex().upper() == \"6B0F76\"\n        icc_mk_smi = kd.derive_icc_mk_a(iss_mk_smi, pan, psn)\n        assert tools.key_check_digits(icc_mk_smi, 3).hex().upper() == \"02396B\"\n    \n        # Verify SMC/SMI session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"ABCDEF1234567890\")\n        sk_smc = kd.derive_common_sk(icc_mk_smc, r)\n        assert tools.key_check_digits(sk_smc, 3).hex().upper() == \"D694B8\"\n        sk_smi = kd.derive_common_sk(icc_mk_smi, r)\n        assert tools.key_check_digits(sk_smi, 3).hex().upper() == \"F088F8\"\n    \n        # Encrypt new PIN\n        pin_block = sm.format_iso9564_2_pin_block(pin)\n        assert pin_block.hex().upper() == \"2C999999999999FF\"\n        command_data = sm.encrypt_command_data(\n            sk_smc, pin_block, sm.EncryptionType.MASTERCARD\n        )\n        assert command_data.hex().upper() == \"99AD3AF9EB3ECF0C\"\n    \n        # Script MAC generated using Session Key\n        command_header = bytes.fromhex(\"8424000210\")\n>       mac = sm.generate_command_mac(sk_smi, command_header + command_data)\n\ntests\\test_sm_hsm.py:140: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\sm.py:108: in generate_command_mac\n    return _mac.mac_iso9797_3(sk_smi[:8], sk_smi[-8:], command, 2, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'8u\\x80\\x97\\xae\\x8c\\x94\\x10'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_sm_hsm.py::test_mastercard_pin_change_12[999999999999_1]",
      "lineno": 89,
      "outcome": "failed",
      "keywords": [
        "test_mastercard_pin_change_12[999999999999_1]",
        "parametrize",
        "pytestmark",
        "999999999999_1",
        "test_sm_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_sm_hsm.py",
            "lineno": 140,
            "message": ""
          },
          {
            "path": "pyemv\\sm.py",
            "lineno": 108,
            "message": "in generate_command_mac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pin = '999999999999'\n\n    @pytest.mark.parametrize(\n        \"pin\",\n        [\n            b\"999999999999\",\n            \"999999999999\",\n        ],\n    )\n    def test_mastercard_pin_change_12(pin: Union[bytes, str]) -> None:\n        \"\"\"\n        Test generation of offline PIN script with ISO format 2 PIN block\n        PIN is 12 digits long.\n    \n        Master Key Derivation = Option A\n        SMI/SMC using Common Session Key Derivation (EMV SU-46)\n        PIN encipherment with optional padding when block is not\n        multiple of 8. However, no padding takes place because PIN\n        block is 8 bytes long.\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk_smc = bytes.fromhex(\"11111111111111112222222222222222\")\n        assert tools.key_check_digits(iss_mk_smc, 3).hex().upper() == \"D2B91C\"\n        iss_mk_smi = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk_smi, 3).hex().upper() == \"08D7B4\"\n    \n        # Derive ICC master keys\n        pan = \"1234567890123456\"\n        psn = \"01\"\n        icc_mk_smc = kd.derive_icc_mk_a(iss_mk_smc, pan, psn)\n        assert tools.key_check_digits(icc_mk_smc, 3).hex().upper() == \"6B0F76\"\n        icc_mk_smi = kd.derive_icc_mk_a(iss_mk_smi, pan, psn)\n        assert tools.key_check_digits(icc_mk_smi, 3).hex().upper() == \"02396B\"\n    \n        # Verify SMC/SMI session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"ABCDEF1234567890\")\n        sk_smc = kd.derive_common_sk(icc_mk_smc, r)\n        assert tools.key_check_digits(sk_smc, 3).hex().upper() == \"D694B8\"\n        sk_smi = kd.derive_common_sk(icc_mk_smi, r)\n        assert tools.key_check_digits(sk_smi, 3).hex().upper() == \"F088F8\"\n    \n        # Encrypt new PIN\n        pin_block = sm.format_iso9564_2_pin_block(pin)\n        assert pin_block.hex().upper() == \"2C999999999999FF\"\n        command_data = sm.encrypt_command_data(\n            sk_smc, pin_block, sm.EncryptionType.MASTERCARD\n        )\n        assert command_data.hex().upper() == \"99AD3AF9EB3ECF0C\"\n    \n        # Script MAC generated using Session Key\n        command_header = bytes.fromhex(\"8424000210\")\n>       mac = sm.generate_command_mac(sk_smi, command_header + command_data)\n\ntests\\test_sm_hsm.py:140: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\sm.py:108: in generate_command_mac\n    return _mac.mac_iso9797_3(sk_smi[:8], sk_smi[-8:], command, 2, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'8u\\x80\\x97\\xae\\x8c\\x94\\x10'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_sm_hsm.py::test_vis_pin_change[9999_0]",
      "lineno": 143,
      "outcome": "failed",
      "keywords": [
        "test_vis_pin_change[9999_0]",
        "parametrize",
        "pytestmark",
        "9999_0",
        "test_sm_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_sm_hsm.py",
            "lineno": 193,
            "message": ""
          },
          {
            "path": "pyemv\\sm.py",
            "lineno": 108,
            "message": "in generate_command_mac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pin = b'9999'\n\n    @pytest.mark.parametrize(\n        \"pin\",\n        [\n            b\"9999\",\n            \"9999\",\n        ],\n    )\n    def test_vis_pin_change(pin: Union[bytes, str]) -> None:\n        \"\"\"\n        Test generation of offline PIN script with VIS PIN block\n    \n        Master Key Derivation = Option A\n        SMI/SMC using Visa Session Key Derivation\n        PIN encipherment with mandatory Visa padding\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk_ac = bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\")\n        assert tools.key_check_digits(iss_mk_ac, 3).hex().upper() == \"7B8358\"\n        iss_mk_smc = bytes.fromhex(\"11111111111111112222222222222222\")\n        assert tools.key_check_digits(iss_mk_smc, 3).hex().upper() == \"D2B91C\"\n        iss_mk_smi = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk_smi, 3).hex().upper() == \"08D7B4\"\n    \n        # Derive ICC master keys\n        pan = \"1234567890123456\"\n        psn = \"01\"\n        icc_mk_ac = kd.derive_icc_mk_a(iss_mk_ac, pan, psn)\n        assert tools.key_check_digits(icc_mk_ac, 3).hex().upper() == \"C5CACD\"\n        icc_mk_smc = kd.derive_icc_mk_a(iss_mk_smc, pan, psn)\n        assert tools.key_check_digits(icc_mk_smc, 3).hex().upper() == \"6B0F76\"\n        icc_mk_smi = kd.derive_icc_mk_a(iss_mk_smi, pan, psn)\n        assert tools.key_check_digits(icc_mk_smi, 3).hex().upper() == \"02396B\"\n    \n        # Verify SMC/SMI session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"FFFF\")\n        sk_smc = kd.derive_visa_sm_sk(icc_mk_smc, r)\n        assert tools.key_check_digits(sk_smc, 3).hex().upper() == \"BD7C46\"\n        sk_smi = kd.derive_visa_sm_sk(icc_mk_smi, r)\n        assert tools.key_check_digits(sk_smi, 3).hex().upper() == \"A41D47\"\n    \n        # Encrypt new PIN\n        pin_block = sm.format_vis_pin_block(icc_mk_ac, pin)\n        assert pin_block.hex().upper() == \"049999FFC4B001F1\"\n        command_data = sm.encrypt_command_data(sk_smc, pin_block, sm.EncryptionType.VISA)\n        assert command_data.hex().upper() == \"D421231A6FD2F0FAEE671384F0D3A7B9\"\n    \n        # Script MAC generated using Session Key\n        command_header = bytes.fromhex(\"8424000210\")\n>       mac = sm.generate_command_mac(sk_smi, command_header + command_data)\n\ntests\\test_sm_hsm.py:193: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\sm.py:108: in generate_command_mac\n    return _mac.mac_iso9797_3(sk_smi[:8], sk_smi[-8:], command, 2, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\xa7\\xcd\\x8adJ/W\\xd6'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_sm_hsm.py::test_vis_pin_change[9999_1]",
      "lineno": 143,
      "outcome": "failed",
      "keywords": [
        "test_vis_pin_change[9999_1]",
        "parametrize",
        "pytestmark",
        "9999_1",
        "test_sm_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_sm_hsm.py",
            "lineno": 193,
            "message": ""
          },
          {
            "path": "pyemv\\sm.py",
            "lineno": 108,
            "message": "in generate_command_mac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pin = '9999'\n\n    @pytest.mark.parametrize(\n        \"pin\",\n        [\n            b\"9999\",\n            \"9999\",\n        ],\n    )\n    def test_vis_pin_change(pin: Union[bytes, str]) -> None:\n        \"\"\"\n        Test generation of offline PIN script with VIS PIN block\n    \n        Master Key Derivation = Option A\n        SMI/SMC using Visa Session Key Derivation\n        PIN encipherment with mandatory Visa padding\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk_ac = bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\")\n        assert tools.key_check_digits(iss_mk_ac, 3).hex().upper() == \"7B8358\"\n        iss_mk_smc = bytes.fromhex(\"11111111111111112222222222222222\")\n        assert tools.key_check_digits(iss_mk_smc, 3).hex().upper() == \"D2B91C\"\n        iss_mk_smi = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk_smi, 3).hex().upper() == \"08D7B4\"\n    \n        # Derive ICC master keys\n        pan = \"1234567890123456\"\n        psn = \"01\"\n        icc_mk_ac = kd.derive_icc_mk_a(iss_mk_ac, pan, psn)\n        assert tools.key_check_digits(icc_mk_ac, 3).hex().upper() == \"C5CACD\"\n        icc_mk_smc = kd.derive_icc_mk_a(iss_mk_smc, pan, psn)\n        assert tools.key_check_digits(icc_mk_smc, 3).hex().upper() == \"6B0F76\"\n        icc_mk_smi = kd.derive_icc_mk_a(iss_mk_smi, pan, psn)\n        assert tools.key_check_digits(icc_mk_smi, 3).hex().upper() == \"02396B\"\n    \n        # Verify SMC/SMI session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"FFFF\")\n        sk_smc = kd.derive_visa_sm_sk(icc_mk_smc, r)\n        assert tools.key_check_digits(sk_smc, 3).hex().upper() == \"BD7C46\"\n        sk_smi = kd.derive_visa_sm_sk(icc_mk_smi, r)\n        assert tools.key_check_digits(sk_smi, 3).hex().upper() == \"A41D47\"\n    \n        # Encrypt new PIN\n        pin_block = sm.format_vis_pin_block(icc_mk_ac, pin)\n        assert pin_block.hex().upper() == \"049999FFC4B001F1\"\n        command_data = sm.encrypt_command_data(sk_smc, pin_block, sm.EncryptionType.VISA)\n        assert command_data.hex().upper() == \"D421231A6FD2F0FAEE671384F0D3A7B9\"\n    \n        # Script MAC generated using Session Key\n        command_header = bytes.fromhex(\"8424000210\")\n>       mac = sm.generate_command_mac(sk_smi, command_header + command_data)\n\ntests\\test_sm_hsm.py:193: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\sm.py:108: in generate_command_mac\n    return _mac.mac_iso9797_3(sk_smi[:8], sk_smi[-8:], command, 2, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\xa7\\xcd\\x8adJ/W\\xd6'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_sm_hsm.py::test_vis_change_change_current_pin[9999-8888_0]",
      "lineno": 196,
      "outcome": "failed",
      "keywords": [
        "test_vis_change_change_current_pin[9999-8888_0]",
        "parametrize",
        "pytestmark",
        "9999-8888_0",
        "test_sm_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_sm_hsm.py",
            "lineno": 250,
            "message": ""
          },
          {
            "path": "pyemv\\sm.py",
            "lineno": 108,
            "message": "in generate_command_mac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pin = b'9999', current_pin = b'8888'\n\n    @pytest.mark.parametrize(\n        [\"pin\", \"current_pin\"],\n        [\n            (b\"9999\", b\"8888\"),\n            (b\"9999\", \"8888\"),\n            (\"9999\", b\"8888\"),\n            (\"9999\", \"8888\"),\n        ],\n    )\n    def test_vis_change_change_current_pin(\n        pin: Union[bytes, str], current_pin: Union[bytes, str]\n    ) -> None:\n        \"\"\"\n        Test generation of offline PIN script with VIS PIN block with current PIN\n    \n        Master Key Derivation = Option A\n        SMI/SMC using Visa Session Key Derivation\n        PIN encipherment with mandatory Visa padding\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk_ac = bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\")\n        assert tools.key_check_digits(iss_mk_ac, 3).hex().upper() == \"7B8358\"\n        iss_mk_smc = bytes.fromhex(\"11111111111111112222222222222222\")\n        assert tools.key_check_digits(iss_mk_smc, 3).hex().upper() == \"D2B91C\"\n        iss_mk_smi = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk_smi, 3).hex().upper() == \"08D7B4\"\n    \n        # Derive ICC master keys\n        pan = \"1234567890123456\"\n        psn = \"01\"\n        icc_mk_ac = kd.derive_icc_mk_a(iss_mk_ac, pan, psn)\n        assert tools.key_check_digits(icc_mk_ac, 3).hex().upper() == \"C5CACD\"\n        icc_mk_smc = kd.derive_icc_mk_a(iss_mk_smc, pan, psn)\n        assert tools.key_check_digits(icc_mk_smc, 3).hex().upper() == \"6B0F76\"\n        icc_mk_smi = kd.derive_icc_mk_a(iss_mk_smi, pan, psn)\n        assert tools.key_check_digits(icc_mk_smi, 3).hex().upper() == \"02396B\"\n    \n        # Verify SMC/SMI session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"FFFF\")\n        sk_smc = kd.derive_visa_sm_sk(icc_mk_smc, r)\n        assert tools.key_check_digits(sk_smc, 3).hex().upper() == \"BD7C46\"\n        sk_smi = kd.derive_visa_sm_sk(icc_mk_smi, r)\n        assert tools.key_check_digits(sk_smi, 3).hex().upper() == \"A41D47\"\n    \n        # Encrypt new PIN\n        pin_block = sm.format_vis_pin_block(icc_mk_ac, pin, current_pin)\n        assert pin_block.hex().upper() == \"8C1199FFC4B001F1\"\n        command_data = sm.encrypt_command_data(sk_smc, pin_block, sm.EncryptionType.VISA)\n        assert command_data.hex().upper() == \"C29371CC36BA70C1EE671384F0D3A7B9\"\n    \n        # Script MAC generated using Session Key\n        command_header = bytes.fromhex(\"8424000110\")\n>       mac = sm.generate_command_mac(sk_smi, command_header + command_data)\n\ntests\\test_sm_hsm.py:250: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\sm.py:108: in generate_command_mac\n    return _mac.mac_iso9797_3(sk_smi[:8], sk_smi[-8:], command, 2, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\xa7\\xcd\\x8adJ/W\\xd6'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_sm_hsm.py::test_vis_change_change_current_pin[9999-8888_1]",
      "lineno": 196,
      "outcome": "failed",
      "keywords": [
        "test_vis_change_change_current_pin[9999-8888_1]",
        "parametrize",
        "pytestmark",
        "9999-8888_1",
        "test_sm_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_sm_hsm.py",
            "lineno": 250,
            "message": ""
          },
          {
            "path": "pyemv\\sm.py",
            "lineno": 108,
            "message": "in generate_command_mac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pin = b'9999', current_pin = '8888'\n\n    @pytest.mark.parametrize(\n        [\"pin\", \"current_pin\"],\n        [\n            (b\"9999\", b\"8888\"),\n            (b\"9999\", \"8888\"),\n            (\"9999\", b\"8888\"),\n            (\"9999\", \"8888\"),\n        ],\n    )\n    def test_vis_change_change_current_pin(\n        pin: Union[bytes, str], current_pin: Union[bytes, str]\n    ) -> None:\n        \"\"\"\n        Test generation of offline PIN script with VIS PIN block with current PIN\n    \n        Master Key Derivation = Option A\n        SMI/SMC using Visa Session Key Derivation\n        PIN encipherment with mandatory Visa padding\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk_ac = bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\")\n        assert tools.key_check_digits(iss_mk_ac, 3).hex().upper() == \"7B8358\"\n        iss_mk_smc = bytes.fromhex(\"11111111111111112222222222222222\")\n        assert tools.key_check_digits(iss_mk_smc, 3).hex().upper() == \"D2B91C\"\n        iss_mk_smi = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk_smi, 3).hex().upper() == \"08D7B4\"\n    \n        # Derive ICC master keys\n        pan = \"1234567890123456\"\n        psn = \"01\"\n        icc_mk_ac = kd.derive_icc_mk_a(iss_mk_ac, pan, psn)\n        assert tools.key_check_digits(icc_mk_ac, 3).hex().upper() == \"C5CACD\"\n        icc_mk_smc = kd.derive_icc_mk_a(iss_mk_smc, pan, psn)\n        assert tools.key_check_digits(icc_mk_smc, 3).hex().upper() == \"6B0F76\"\n        icc_mk_smi = kd.derive_icc_mk_a(iss_mk_smi, pan, psn)\n        assert tools.key_check_digits(icc_mk_smi, 3).hex().upper() == \"02396B\"\n    \n        # Verify SMC/SMI session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"FFFF\")\n        sk_smc = kd.derive_visa_sm_sk(icc_mk_smc, r)\n        assert tools.key_check_digits(sk_smc, 3).hex().upper() == \"BD7C46\"\n        sk_smi = kd.derive_visa_sm_sk(icc_mk_smi, r)\n        assert tools.key_check_digits(sk_smi, 3).hex().upper() == \"A41D47\"\n    \n        # Encrypt new PIN\n        pin_block = sm.format_vis_pin_block(icc_mk_ac, pin, current_pin)\n        assert pin_block.hex().upper() == \"8C1199FFC4B001F1\"\n        command_data = sm.encrypt_command_data(sk_smc, pin_block, sm.EncryptionType.VISA)\n        assert command_data.hex().upper() == \"C29371CC36BA70C1EE671384F0D3A7B9\"\n    \n        # Script MAC generated using Session Key\n        command_header = bytes.fromhex(\"8424000110\")\n>       mac = sm.generate_command_mac(sk_smi, command_header + command_data)\n\ntests\\test_sm_hsm.py:250: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\sm.py:108: in generate_command_mac\n    return _mac.mac_iso9797_3(sk_smi[:8], sk_smi[-8:], command, 2, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\xa7\\xcd\\x8adJ/W\\xd6'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_sm_hsm.py::test_vis_change_change_current_pin[9999-8888_2]",
      "lineno": 196,
      "outcome": "failed",
      "keywords": [
        "test_vis_change_change_current_pin[9999-8888_2]",
        "parametrize",
        "pytestmark",
        "9999-8888_2",
        "test_sm_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_sm_hsm.py",
            "lineno": 250,
            "message": ""
          },
          {
            "path": "pyemv\\sm.py",
            "lineno": 108,
            "message": "in generate_command_mac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pin = '9999', current_pin = b'8888'\n\n    @pytest.mark.parametrize(\n        [\"pin\", \"current_pin\"],\n        [\n            (b\"9999\", b\"8888\"),\n            (b\"9999\", \"8888\"),\n            (\"9999\", b\"8888\"),\n            (\"9999\", \"8888\"),\n        ],\n    )\n    def test_vis_change_change_current_pin(\n        pin: Union[bytes, str], current_pin: Union[bytes, str]\n    ) -> None:\n        \"\"\"\n        Test generation of offline PIN script with VIS PIN block with current PIN\n    \n        Master Key Derivation = Option A\n        SMI/SMC using Visa Session Key Derivation\n        PIN encipherment with mandatory Visa padding\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk_ac = bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\")\n        assert tools.key_check_digits(iss_mk_ac, 3).hex().upper() == \"7B8358\"\n        iss_mk_smc = bytes.fromhex(\"11111111111111112222222222222222\")\n        assert tools.key_check_digits(iss_mk_smc, 3).hex().upper() == \"D2B91C\"\n        iss_mk_smi = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk_smi, 3).hex().upper() == \"08D7B4\"\n    \n        # Derive ICC master keys\n        pan = \"1234567890123456\"\n        psn = \"01\"\n        icc_mk_ac = kd.derive_icc_mk_a(iss_mk_ac, pan, psn)\n        assert tools.key_check_digits(icc_mk_ac, 3).hex().upper() == \"C5CACD\"\n        icc_mk_smc = kd.derive_icc_mk_a(iss_mk_smc, pan, psn)\n        assert tools.key_check_digits(icc_mk_smc, 3).hex().upper() == \"6B0F76\"\n        icc_mk_smi = kd.derive_icc_mk_a(iss_mk_smi, pan, psn)\n        assert tools.key_check_digits(icc_mk_smi, 3).hex().upper() == \"02396B\"\n    \n        # Verify SMC/SMI session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"FFFF\")\n        sk_smc = kd.derive_visa_sm_sk(icc_mk_smc, r)\n        assert tools.key_check_digits(sk_smc, 3).hex().upper() == \"BD7C46\"\n        sk_smi = kd.derive_visa_sm_sk(icc_mk_smi, r)\n        assert tools.key_check_digits(sk_smi, 3).hex().upper() == \"A41D47\"\n    \n        # Encrypt new PIN\n        pin_block = sm.format_vis_pin_block(icc_mk_ac, pin, current_pin)\n        assert pin_block.hex().upper() == \"8C1199FFC4B001F1\"\n        command_data = sm.encrypt_command_data(sk_smc, pin_block, sm.EncryptionType.VISA)\n        assert command_data.hex().upper() == \"C29371CC36BA70C1EE671384F0D3A7B9\"\n    \n        # Script MAC generated using Session Key\n        command_header = bytes.fromhex(\"8424000110\")\n>       mac = sm.generate_command_mac(sk_smi, command_header + command_data)\n\ntests\\test_sm_hsm.py:250: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\sm.py:108: in generate_command_mac\n    return _mac.mac_iso9797_3(sk_smi[:8], sk_smi[-8:], command, 2, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\xa7\\xcd\\x8adJ/W\\xd6'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_sm_hsm.py::test_vis_change_change_current_pin[9999-8888_3]",
      "lineno": 196,
      "outcome": "failed",
      "keywords": [
        "test_vis_change_change_current_pin[9999-8888_3]",
        "parametrize",
        "pytestmark",
        "9999-8888_3",
        "test_sm_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_sm_hsm.py",
            "lineno": 250,
            "message": ""
          },
          {
            "path": "pyemv\\sm.py",
            "lineno": 108,
            "message": "in generate_command_mac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pin = '9999', current_pin = '8888'\n\n    @pytest.mark.parametrize(\n        [\"pin\", \"current_pin\"],\n        [\n            (b\"9999\", b\"8888\"),\n            (b\"9999\", \"8888\"),\n            (\"9999\", b\"8888\"),\n            (\"9999\", \"8888\"),\n        ],\n    )\n    def test_vis_change_change_current_pin(\n        pin: Union[bytes, str], current_pin: Union[bytes, str]\n    ) -> None:\n        \"\"\"\n        Test generation of offline PIN script with VIS PIN block with current PIN\n    \n        Master Key Derivation = Option A\n        SMI/SMC using Visa Session Key Derivation\n        PIN encipherment with mandatory Visa padding\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk_ac = bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\")\n        assert tools.key_check_digits(iss_mk_ac, 3).hex().upper() == \"7B8358\"\n        iss_mk_smc = bytes.fromhex(\"11111111111111112222222222222222\")\n        assert tools.key_check_digits(iss_mk_smc, 3).hex().upper() == \"D2B91C\"\n        iss_mk_smi = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk_smi, 3).hex().upper() == \"08D7B4\"\n    \n        # Derive ICC master keys\n        pan = \"1234567890123456\"\n        psn = \"01\"\n        icc_mk_ac = kd.derive_icc_mk_a(iss_mk_ac, pan, psn)\n        assert tools.key_check_digits(icc_mk_ac, 3).hex().upper() == \"C5CACD\"\n        icc_mk_smc = kd.derive_icc_mk_a(iss_mk_smc, pan, psn)\n        assert tools.key_check_digits(icc_mk_smc, 3).hex().upper() == \"6B0F76\"\n        icc_mk_smi = kd.derive_icc_mk_a(iss_mk_smi, pan, psn)\n        assert tools.key_check_digits(icc_mk_smi, 3).hex().upper() == \"02396B\"\n    \n        # Verify SMC/SMI session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"FFFF\")\n        sk_smc = kd.derive_visa_sm_sk(icc_mk_smc, r)\n        assert tools.key_check_digits(sk_smc, 3).hex().upper() == \"BD7C46\"\n        sk_smi = kd.derive_visa_sm_sk(icc_mk_smi, r)\n        assert tools.key_check_digits(sk_smi, 3).hex().upper() == \"A41D47\"\n    \n        # Encrypt new PIN\n        pin_block = sm.format_vis_pin_block(icc_mk_ac, pin, current_pin)\n        assert pin_block.hex().upper() == \"8C1199FFC4B001F1\"\n        command_data = sm.encrypt_command_data(sk_smc, pin_block, sm.EncryptionType.VISA)\n        assert command_data.hex().upper() == \"C29371CC36BA70C1EE671384F0D3A7B9\"\n    \n        # Script MAC generated using Session Key\n        command_header = bytes.fromhex(\"8424000110\")\n>       mac = sm.generate_command_mac(sk_smi, command_header + command_data)\n\ntests\\test_sm_hsm.py:250: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\sm.py:108: in generate_command_mac\n    return _mac.mac_iso9797_3(sk_smi[:8], sk_smi[-8:], command, 2, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\xa7\\xcd\\x8adJ/W\\xd6'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_sm_hsm.py::test_vis_change_current_pin_12[999999999999-888888888888_0]",
      "lineno": 253,
      "outcome": "failed",
      "keywords": [
        "test_vis_change_current_pin_12[999999999999-888888888888_0]",
        "parametrize",
        "pytestmark",
        "999999999999-888888888888_0",
        "test_sm_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_sm_hsm.py",
            "lineno": 308,
            "message": ""
          },
          {
            "path": "pyemv\\sm.py",
            "lineno": 108,
            "message": "in generate_command_mac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pin = b'999999999999', current_pin = b'888888888888'\n\n    @pytest.mark.parametrize(\n        [\"pin\", \"current_pin\"],\n        [\n            (b\"999999999999\", b\"888888888888\"),\n            (b\"999999999999\", \"888888888888\"),\n            (\"999999999999\", b\"888888888888\"),\n            (\"999999999999\", \"888888888888\"),\n        ],\n    )\n    def test_vis_change_current_pin_12(\n        pin: Union[bytes, str], current_pin: Union[bytes, str]\n    ) -> None:\n        \"\"\"\n        Test generation of offline PIN script with VIS PIN block with current PIN\n        Both PINs are 12 digits long.\n    \n        Master Key Derivation = Option A\n        SMI/SMC using Visa Session Key Derivation\n        PIN encipherment with mandatory Visa padding\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk_ac = bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\")\n        assert tools.key_check_digits(iss_mk_ac, 3).hex().upper() == \"7B8358\"\n        iss_mk_smc = bytes.fromhex(\"11111111111111112222222222222222\")\n        assert tools.key_check_digits(iss_mk_smc, 3).hex().upper() == \"D2B91C\"\n        iss_mk_smi = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk_smi, 3).hex().upper() == \"08D7B4\"\n    \n        # Derive ICC master keys\n        pan = \"1234567890123456\"\n        psn = \"01\"\n        icc_mk_ac = kd.derive_icc_mk_a(iss_mk_ac, pan, psn)\n        assert tools.key_check_digits(icc_mk_ac, 3).hex().upper() == \"C5CACD\"\n        icc_mk_smc = kd.derive_icc_mk_a(iss_mk_smc, pan, psn)\n        assert tools.key_check_digits(icc_mk_smc, 3).hex().upper() == \"6B0F76\"\n        icc_mk_smi = kd.derive_icc_mk_a(iss_mk_smi, pan, psn)\n        assert tools.key_check_digits(icc_mk_smi, 3).hex().upper() == \"02396B\"\n    \n        # Verify SMC/SMI session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"FFFF\")\n        sk_smc = kd.derive_visa_sm_sk(icc_mk_smc, r)\n        assert tools.key_check_digits(sk_smc, 3).hex().upper() == \"BD7C46\"\n        sk_smi = kd.derive_visa_sm_sk(icc_mk_smi, r)\n        assert tools.key_check_digits(sk_smi, 3).hex().upper() == \"A41D47\"\n    \n        # Encrypt new PIN\n        pin_block = sm.format_vis_pin_block(icc_mk_ac, pin, current_pin)\n        assert pin_block.hex().upper() == \"841111112A5E67F1\"\n        command_data = sm.encrypt_command_data(sk_smc, pin_block, sm.EncryptionType.VISA)\n        assert command_data.hex().upper() == \"622066A74F1E974AEE671384F0D3A7B9\"\n    \n        # Script MAC generated using Session Key\n        command_header = bytes.fromhex(\"8424000110\")\n>       mac = sm.generate_command_mac(sk_smi, command_header + command_data)\n\ntests\\test_sm_hsm.py:308: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\sm.py:108: in generate_command_mac\n    return _mac.mac_iso9797_3(sk_smi[:8], sk_smi[-8:], command, 2, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\xa7\\xcd\\x8adJ/W\\xd6'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_sm_hsm.py::test_vis_change_current_pin_12[999999999999-888888888888_1]",
      "lineno": 253,
      "outcome": "failed",
      "keywords": [
        "test_vis_change_current_pin_12[999999999999-888888888888_1]",
        "parametrize",
        "pytestmark",
        "999999999999-888888888888_1",
        "test_sm_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_sm_hsm.py",
            "lineno": 308,
            "message": ""
          },
          {
            "path": "pyemv\\sm.py",
            "lineno": 108,
            "message": "in generate_command_mac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pin = b'999999999999', current_pin = '888888888888'\n\n    @pytest.mark.parametrize(\n        [\"pin\", \"current_pin\"],\n        [\n            (b\"999999999999\", b\"888888888888\"),\n            (b\"999999999999\", \"888888888888\"),\n            (\"999999999999\", b\"888888888888\"),\n            (\"999999999999\", \"888888888888\"),\n        ],\n    )\n    def test_vis_change_current_pin_12(\n        pin: Union[bytes, str], current_pin: Union[bytes, str]\n    ) -> None:\n        \"\"\"\n        Test generation of offline PIN script with VIS PIN block with current PIN\n        Both PINs are 12 digits long.\n    \n        Master Key Derivation = Option A\n        SMI/SMC using Visa Session Key Derivation\n        PIN encipherment with mandatory Visa padding\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk_ac = bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\")\n        assert tools.key_check_digits(iss_mk_ac, 3).hex().upper() == \"7B8358\"\n        iss_mk_smc = bytes.fromhex(\"11111111111111112222222222222222\")\n        assert tools.key_check_digits(iss_mk_smc, 3).hex().upper() == \"D2B91C\"\n        iss_mk_smi = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk_smi, 3).hex().upper() == \"08D7B4\"\n    \n        # Derive ICC master keys\n        pan = \"1234567890123456\"\n        psn = \"01\"\n        icc_mk_ac = kd.derive_icc_mk_a(iss_mk_ac, pan, psn)\n        assert tools.key_check_digits(icc_mk_ac, 3).hex().upper() == \"C5CACD\"\n        icc_mk_smc = kd.derive_icc_mk_a(iss_mk_smc, pan, psn)\n        assert tools.key_check_digits(icc_mk_smc, 3).hex().upper() == \"6B0F76\"\n        icc_mk_smi = kd.derive_icc_mk_a(iss_mk_smi, pan, psn)\n        assert tools.key_check_digits(icc_mk_smi, 3).hex().upper() == \"02396B\"\n    \n        # Verify SMC/SMI session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"FFFF\")\n        sk_smc = kd.derive_visa_sm_sk(icc_mk_smc, r)\n        assert tools.key_check_digits(sk_smc, 3).hex().upper() == \"BD7C46\"\n        sk_smi = kd.derive_visa_sm_sk(icc_mk_smi, r)\n        assert tools.key_check_digits(sk_smi, 3).hex().upper() == \"A41D47\"\n    \n        # Encrypt new PIN\n        pin_block = sm.format_vis_pin_block(icc_mk_ac, pin, current_pin)\n        assert pin_block.hex().upper() == \"841111112A5E67F1\"\n        command_data = sm.encrypt_command_data(sk_smc, pin_block, sm.EncryptionType.VISA)\n        assert command_data.hex().upper() == \"622066A74F1E974AEE671384F0D3A7B9\"\n    \n        # Script MAC generated using Session Key\n        command_header = bytes.fromhex(\"8424000110\")\n>       mac = sm.generate_command_mac(sk_smi, command_header + command_data)\n\ntests\\test_sm_hsm.py:308: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\sm.py:108: in generate_command_mac\n    return _mac.mac_iso9797_3(sk_smi[:8], sk_smi[-8:], command, 2, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\xa7\\xcd\\x8adJ/W\\xd6'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_sm_hsm.py::test_vis_change_current_pin_12[999999999999-888888888888_2]",
      "lineno": 253,
      "outcome": "failed",
      "keywords": [
        "test_vis_change_current_pin_12[999999999999-888888888888_2]",
        "parametrize",
        "pytestmark",
        "999999999999-888888888888_2",
        "test_sm_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_sm_hsm.py",
            "lineno": 308,
            "message": ""
          },
          {
            "path": "pyemv\\sm.py",
            "lineno": 108,
            "message": "in generate_command_mac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pin = '999999999999', current_pin = b'888888888888'\n\n    @pytest.mark.parametrize(\n        [\"pin\", \"current_pin\"],\n        [\n            (b\"999999999999\", b\"888888888888\"),\n            (b\"999999999999\", \"888888888888\"),\n            (\"999999999999\", b\"888888888888\"),\n            (\"999999999999\", \"888888888888\"),\n        ],\n    )\n    def test_vis_change_current_pin_12(\n        pin: Union[bytes, str], current_pin: Union[bytes, str]\n    ) -> None:\n        \"\"\"\n        Test generation of offline PIN script with VIS PIN block with current PIN\n        Both PINs are 12 digits long.\n    \n        Master Key Derivation = Option A\n        SMI/SMC using Visa Session Key Derivation\n        PIN encipherment with mandatory Visa padding\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk_ac = bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\")\n        assert tools.key_check_digits(iss_mk_ac, 3).hex().upper() == \"7B8358\"\n        iss_mk_smc = bytes.fromhex(\"11111111111111112222222222222222\")\n        assert tools.key_check_digits(iss_mk_smc, 3).hex().upper() == \"D2B91C\"\n        iss_mk_smi = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk_smi, 3).hex().upper() == \"08D7B4\"\n    \n        # Derive ICC master keys\n        pan = \"1234567890123456\"\n        psn = \"01\"\n        icc_mk_ac = kd.derive_icc_mk_a(iss_mk_ac, pan, psn)\n        assert tools.key_check_digits(icc_mk_ac, 3).hex().upper() == \"C5CACD\"\n        icc_mk_smc = kd.derive_icc_mk_a(iss_mk_smc, pan, psn)\n        assert tools.key_check_digits(icc_mk_smc, 3).hex().upper() == \"6B0F76\"\n        icc_mk_smi = kd.derive_icc_mk_a(iss_mk_smi, pan, psn)\n        assert tools.key_check_digits(icc_mk_smi, 3).hex().upper() == \"02396B\"\n    \n        # Verify SMC/SMI session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"FFFF\")\n        sk_smc = kd.derive_visa_sm_sk(icc_mk_smc, r)\n        assert tools.key_check_digits(sk_smc, 3).hex().upper() == \"BD7C46\"\n        sk_smi = kd.derive_visa_sm_sk(icc_mk_smi, r)\n        assert tools.key_check_digits(sk_smi, 3).hex().upper() == \"A41D47\"\n    \n        # Encrypt new PIN\n        pin_block = sm.format_vis_pin_block(icc_mk_ac, pin, current_pin)\n        assert pin_block.hex().upper() == \"841111112A5E67F1\"\n        command_data = sm.encrypt_command_data(sk_smc, pin_block, sm.EncryptionType.VISA)\n        assert command_data.hex().upper() == \"622066A74F1E974AEE671384F0D3A7B9\"\n    \n        # Script MAC generated using Session Key\n        command_header = bytes.fromhex(\"8424000110\")\n>       mac = sm.generate_command_mac(sk_smi, command_header + command_data)\n\ntests\\test_sm_hsm.py:308: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\sm.py:108: in generate_command_mac\n    return _mac.mac_iso9797_3(sk_smi[:8], sk_smi[-8:], command, 2, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\xa7\\xcd\\x8adJ/W\\xd6'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_sm_hsm.py::test_vis_change_current_pin_12[999999999999-888888888888_3]",
      "lineno": 253,
      "outcome": "failed",
      "keywords": [
        "test_vis_change_current_pin_12[999999999999-888888888888_3]",
        "parametrize",
        "pytestmark",
        "999999999999-888888888888_3",
        "test_sm_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_sm_hsm.py",
            "lineno": 308,
            "message": ""
          },
          {
            "path": "pyemv\\sm.py",
            "lineno": 108,
            "message": "in generate_command_mac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pin = '999999999999', current_pin = '888888888888'\n\n    @pytest.mark.parametrize(\n        [\"pin\", \"current_pin\"],\n        [\n            (b\"999999999999\", b\"888888888888\"),\n            (b\"999999999999\", \"888888888888\"),\n            (\"999999999999\", b\"888888888888\"),\n            (\"999999999999\", \"888888888888\"),\n        ],\n    )\n    def test_vis_change_current_pin_12(\n        pin: Union[bytes, str], current_pin: Union[bytes, str]\n    ) -> None:\n        \"\"\"\n        Test generation of offline PIN script with VIS PIN block with current PIN\n        Both PINs are 12 digits long.\n    \n        Master Key Derivation = Option A\n        SMI/SMC using Visa Session Key Derivation\n        PIN encipherment with mandatory Visa padding\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk_ac = bytes.fromhex(\"FEDCBA98765432100123456789ABCDEF\")\n        assert tools.key_check_digits(iss_mk_ac, 3).hex().upper() == \"7B8358\"\n        iss_mk_smc = bytes.fromhex(\"11111111111111112222222222222222\")\n        assert tools.key_check_digits(iss_mk_smc, 3).hex().upper() == \"D2B91C\"\n        iss_mk_smi = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk_smi, 3).hex().upper() == \"08D7B4\"\n    \n        # Derive ICC master keys\n        pan = \"1234567890123456\"\n        psn = \"01\"\n        icc_mk_ac = kd.derive_icc_mk_a(iss_mk_ac, pan, psn)\n        assert tools.key_check_digits(icc_mk_ac, 3).hex().upper() == \"C5CACD\"\n        icc_mk_smc = kd.derive_icc_mk_a(iss_mk_smc, pan, psn)\n        assert tools.key_check_digits(icc_mk_smc, 3).hex().upper() == \"6B0F76\"\n        icc_mk_smi = kd.derive_icc_mk_a(iss_mk_smi, pan, psn)\n        assert tools.key_check_digits(icc_mk_smi, 3).hex().upper() == \"02396B\"\n    \n        # Verify SMC/SMI session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"FFFF\")\n        sk_smc = kd.derive_visa_sm_sk(icc_mk_smc, r)\n        assert tools.key_check_digits(sk_smc, 3).hex().upper() == \"BD7C46\"\n        sk_smi = kd.derive_visa_sm_sk(icc_mk_smi, r)\n        assert tools.key_check_digits(sk_smi, 3).hex().upper() == \"A41D47\"\n    \n        # Encrypt new PIN\n        pin_block = sm.format_vis_pin_block(icc_mk_ac, pin, current_pin)\n        assert pin_block.hex().upper() == \"841111112A5E67F1\"\n        command_data = sm.encrypt_command_data(sk_smc, pin_block, sm.EncryptionType.VISA)\n        assert command_data.hex().upper() == \"622066A74F1E974AEE671384F0D3A7B9\"\n    \n        # Script MAC generated using Session Key\n        command_header = bytes.fromhex(\"8424000110\")\n>       mac = sm.generate_command_mac(sk_smi, command_header + command_data)\n\ntests\\test_sm_hsm.py:308: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\sm.py:108: in generate_command_mac\n    return _mac.mac_iso9797_3(sk_smi[:8], sk_smi[-8:], command, 2, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'\\xa7\\xcd\\x8adJ/W\\xd6'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_sm_hsm.py::test_ccd_pin_change[9999_0]",
      "lineno": 311,
      "outcome": "failed",
      "keywords": [
        "test_ccd_pin_change[9999_0]",
        "parametrize",
        "pytestmark",
        "9999_0",
        "test_sm_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_sm_hsm.py",
            "lineno": 360,
            "message": ""
          },
          {
            "path": "pyemv\\sm.py",
            "lineno": 108,
            "message": "in generate_command_mac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pin = b'9999'\n\n    @pytest.mark.parametrize(\n        \"pin\",\n        [\n            b\"9999\",\n            \"9999\",\n        ],\n    )\n    def test_ccd_pin_change(pin: Union[bytes, str]) -> None:\n        \"\"\"\n        Test generation of offline PIN script with ISO format 2 PIN block'\n        Common Core Definition. Mandatory padding.\n    \n        Master Key Derivation = Option A\n        SMI/SMC using Common Session Key Derivation (EMV SU-46)\n        PIN encipherment with optional padding when block is not\n        multiple of 8. However, no padding takes place because PIN\n        block is 8 bytes long.\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk_smc = bytes.fromhex(\"11111111111111112222222222222222\")\n        assert tools.key_check_digits(iss_mk_smc, 3).hex().upper() == \"D2B91C\"\n        iss_mk_smi = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk_smi, 3).hex().upper() == \"08D7B4\"\n    \n        # Derive ICC master keys\n        pan = \"1234567890123456\"\n        psn = \"01\"\n        icc_mk_smc = kd.derive_icc_mk_a(iss_mk_smc, pan, psn)\n        assert tools.key_check_digits(icc_mk_smc, 3).hex().upper() == \"6B0F76\"\n        icc_mk_smi = kd.derive_icc_mk_a(iss_mk_smi, pan, psn)\n        assert tools.key_check_digits(icc_mk_smi, 3).hex().upper() == \"02396B\"\n    \n        # Verify SMC/SMI session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"ABCDEF1234567890\")\n        sk_smc = kd.derive_common_sk(icc_mk_smc, r)\n        assert tools.key_check_digits(sk_smc, 3).hex().upper() == \"D694B8\"\n        sk_smi = kd.derive_common_sk(icc_mk_smi, r)\n        assert tools.key_check_digits(sk_smi, 3).hex().upper() == \"F088F8\"\n    \n        # Encrypt new PIN\n        pin_block = sm.format_iso9564_2_pin_block(pin)\n        assert pin_block.hex().upper() == \"249999FFFFFFFFFF\"\n        command_data = sm.encrypt_command_data(sk_smc, pin_block, sm.EncryptionType.EMV)\n        assert command_data.hex().upper() == \"28367E05DE3381C29D30A6055A8DEB86\"\n    \n        # Script MAC generated using Session Key\n        command_header = bytes.fromhex(\"8424000210\")\n>       mac = sm.generate_command_mac(sk_smi, command_header + command_data)\n\ntests\\test_sm_hsm.py:360: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\sm.py:108: in generate_command_mac\n    return _mac.mac_iso9797_3(sk_smi[:8], sk_smi[-8:], command, 2, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'8u\\x80\\x97\\xae\\x8c\\x94\\x10'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_sm_hsm.py::test_ccd_pin_change[9999_1]",
      "lineno": 311,
      "outcome": "failed",
      "keywords": [
        "test_ccd_pin_change[9999_1]",
        "parametrize",
        "pytestmark",
        "9999_1",
        "test_sm_hsm.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
          "lineno": 80,
          "message": "ValueError: Not a valid TDES key"
        },
        "traceback": [
          {
            "path": "tests\\test_sm_hsm.py",
            "lineno": 360,
            "message": ""
          },
          {
            "path": "pyemv\\sm.py",
            "lineno": 108,
            "message": "in generate_command_mac"
          },
          {
            "path": "pyemv\\mac.py",
            "lineno": 83,
            "message": "in mac_iso9797_3"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 174,
            "message": "in new"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py",
            "lineno": 79,
            "message": "in _create_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py",
            "lineno": 274,
            "message": "in _create_cbc_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 99,
            "message": "in _create_base_cipher"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py",
            "lineno": 80,
            "message": "ValueError"
          }
        ],
        "longrepr": "pin = '9999'\n\n    @pytest.mark.parametrize(\n        \"pin\",\n        [\n            b\"9999\",\n            \"9999\",\n        ],\n    )\n    def test_ccd_pin_change(pin: Union[bytes, str]) -> None:\n        \"\"\"\n        Test generation of offline PIN script with ISO format 2 PIN block'\n        Common Core Definition. Mandatory padding.\n    \n        Master Key Derivation = Option A\n        SMI/SMC using Common Session Key Derivation (EMV SU-46)\n        PIN encipherment with optional padding when block is not\n        multiple of 8. However, no padding takes place because PIN\n        block is 8 bytes long.\n        \"\"\"\n        # Verify issuer master key check digits\n        iss_mk_smc = bytes.fromhex(\"11111111111111112222222222222222\")\n        assert tools.key_check_digits(iss_mk_smc, 3).hex().upper() == \"D2B91C\"\n        iss_mk_smi = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n        assert tools.key_check_digits(iss_mk_smi, 3).hex().upper() == \"08D7B4\"\n    \n        # Derive ICC master keys\n        pan = \"1234567890123456\"\n        psn = \"01\"\n        icc_mk_smc = kd.derive_icc_mk_a(iss_mk_smc, pan, psn)\n        assert tools.key_check_digits(icc_mk_smc, 3).hex().upper() == \"6B0F76\"\n        icc_mk_smi = kd.derive_icc_mk_a(iss_mk_smi, pan, psn)\n        assert tools.key_check_digits(icc_mk_smi, 3).hex().upper() == \"02396B\"\n    \n        # Verify SMC/SMI session key\n        # Common Session Key Derivation Option\n        r = bytes.fromhex(\"ABCDEF1234567890\")\n        sk_smc = kd.derive_common_sk(icc_mk_smc, r)\n        assert tools.key_check_digits(sk_smc, 3).hex().upper() == \"D694B8\"\n        sk_smi = kd.derive_common_sk(icc_mk_smi, r)\n        assert tools.key_check_digits(sk_smi, 3).hex().upper() == \"F088F8\"\n    \n        # Encrypt new PIN\n        pin_block = sm.format_iso9564_2_pin_block(pin)\n        assert pin_block.hex().upper() == \"249999FFFFFFFFFF\"\n        command_data = sm.encrypt_command_data(sk_smc, pin_block, sm.EncryptionType.EMV)\n        assert command_data.hex().upper() == \"28367E05DE3381C29D30A6055A8DEB86\"\n    \n        # Script MAC generated using Session Key\n        command_header = bytes.fromhex(\"8424000210\")\n>       mac = sm.generate_command_mac(sk_smi, command_header + command_data)\n\ntests\\test_sm_hsm.py:360: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\npyemv\\sm.py:108: in generate_command_mac\n    return _mac.mac_iso9797_3(sk_smi[:8], sk_smi[-8:], command, 2, length)\npyemv\\mac.py:83: in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:174: in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py:79: in _create_cipher\n    return modes[mode](factory, **kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py:274: in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:99: in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nkey_in = b'8u\\x80\\x97\\xae\\x8c\\x94\\x10'\n\n    def adjust_key_parity(key_in):\n        \"\"\"Set the parity bits in a TDES key.\n    \n        :param key_in: the TDES key whose bits need to be adjusted\n        :type key_in: byte string\n    \n        :returns: a copy of ``key_in``, with the parity bits correctly set\n        :rtype: byte string\n    \n        :raises ValueError: if the TDES key is not 16 or 24 bytes long\n        :raises ValueError: if the TDES key degenerates into Single DES\n        \"\"\"\n    \n        def parity_byte(key_byte):\n            parity = 1\n            for i in range(1, 8):\n                parity ^= (key_byte >> i) & 1\n            return (key_byte & 0xFE) | parity\n    \n        if len(key_in) not in key_size:\n>           raise ValueError(\"Not a valid TDES key\")\nE           ValueError: Not a valid TDES key\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py:80: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag[-value0]",
      "lineno": 7,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag[-value0]",
        "parametrize",
        "pytestmark",
        "-value0",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag[9C00-value1]",
      "lineno": 7,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag[9C00-value1]",
        "parametrize",
        "pytestmark",
        "9C00-value1",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag[9C01FF-value2]",
      "lineno": 7,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag[9C01FF-value2]",
        "parametrize",
        "pytestmark",
        "9C01FF-value2",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag[9C8101FF-value3]",
      "lineno": 7,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag[9C8101FF-value3]",
        "parametrize",
        "pytestmark",
        "9C8101FF-value3",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag[9F0200-value4]",
      "lineno": 7,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag[9F0200-value4]",
        "parametrize",
        "pytestmark",
        "9F0200-value4",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag[9F0201FF-value5]",
      "lineno": 7,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag[9F0201FF-value5]",
        "parametrize",
        "pytestmark",
        "9F0201FF-value5",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag[9F820100-value6]",
      "lineno": 7,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag[9F820100-value6]",
        "parametrize",
        "pytestmark",
        "9F820100-value6",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag[9F820101FF-value7]",
      "lineno": 7,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag[9F820101FF-value7]",
        "parametrize",
        "pytestmark",
        "9F820101FF-value7",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag[9C80-value8]",
      "lineno": 7,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag[9C80-value8]",
        "parametrize",
        "pytestmark",
        "9C80-value8",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag[9C8100-value9]",
      "lineno": 7,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag[9C8100-value9]",
        "parametrize",
        "pytestmark",
        "9C8100-value9",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag[9C820000-value10]",
      "lineno": 7,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag[9C820000-value10]",
        "parametrize",
        "pytestmark",
        "9C820000-value10",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag[9C83000000-value11]",
      "lineno": 7,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag[9C83000000-value11]",
        "parametrize",
        "pytestmark",
        "9C83000000-value11",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag[9C8400000000-value12]",
      "lineno": 7,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag[9C8400000000-value12]",
        "parametrize",
        "pytestmark",
        "9C8400000000-value12",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag[9C8101FF-value13]",
      "lineno": 7,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag[9C8101FF-value13]",
        "parametrize",
        "pytestmark",
        "9C8101FF-value13",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag[9C820001FF-value14]",
      "lineno": 7,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag[9C820001FF-value14]",
        "parametrize",
        "pytestmark",
        "9C820001FF-value14",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag[9C83000001FF-value15]",
      "lineno": 7,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag[9C83000001FF-value15]",
        "parametrize",
        "pytestmark",
        "9C83000001FF-value15",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag[9C8400000001FF-value16]",
      "lineno": 7,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag[9C8400000001FF-value16]",
        "parametrize",
        "pytestmark",
        "9C8400000001FF-value16",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[-value0]",
      "lineno": 38,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag_coerce[-value0]",
        "parametrize",
        "pytestmark",
        "-value0",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9C00-value1]",
      "lineno": 38,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag_coerce[9C00-value1]",
        "parametrize",
        "pytestmark",
        "9C00-value1",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9C01FF-value2]",
      "lineno": 38,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag_coerce[9C01FF-value2]",
        "parametrize",
        "pytestmark",
        "9C01FF-value2",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9C8101FF-value3]",
      "lineno": 38,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag_coerce[9C8101FF-value3]",
        "parametrize",
        "pytestmark",
        "9C8101FF-value3",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9F0200-value4]",
      "lineno": 38,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag_coerce[9F0200-value4]",
        "parametrize",
        "pytestmark",
        "9F0200-value4",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9F0201FF-value5]",
      "lineno": 38,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag_coerce[9F0201FF-value5]",
        "parametrize",
        "pytestmark",
        "9F0201FF-value5",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9F820100-value6]",
      "lineno": 38,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag_coerce[9F820100-value6]",
        "parametrize",
        "pytestmark",
        "9F820100-value6",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9F820101FF-value7]",
      "lineno": 38,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag_coerce[9F820101FF-value7]",
        "parametrize",
        "pytestmark",
        "9F820101FF-value7",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9C80-value8]",
      "lineno": 38,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag_coerce[9C80-value8]",
        "parametrize",
        "pytestmark",
        "9C80-value8",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9C8100-value9]",
      "lineno": 38,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag_coerce[9C8100-value9]",
        "parametrize",
        "pytestmark",
        "9C8100-value9",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9C820000-value10]",
      "lineno": 38,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag_coerce[9C820000-value10]",
        "parametrize",
        "pytestmark",
        "9C820000-value10",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9C83000000-value11]",
      "lineno": 38,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag_coerce[9C83000000-value11]",
        "parametrize",
        "pytestmark",
        "9C83000000-value11",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9C8400000000-value12]",
      "lineno": 38,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag_coerce[9C8400000000-value12]",
        "parametrize",
        "pytestmark",
        "9C8400000000-value12",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9C8101FF-value13]",
      "lineno": 38,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag_coerce[9C8101FF-value13]",
        "parametrize",
        "pytestmark",
        "9C8101FF-value13",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9C820001FF-value14]",
      "lineno": 38,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag_coerce[9C820001FF-value14]",
        "parametrize",
        "pytestmark",
        "9C820001FF-value14",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9C83000001FF-value15]",
      "lineno": 38,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag_coerce[9C83000001FF-value15]",
        "parametrize",
        "pytestmark",
        "9C83000001FF-value15",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_tag_coerce[9C8400000001FF-value16]",
      "lineno": 38,
      "outcome": "passed",
      "keywords": [
        "test_decode_tag_coerce[9C8400000001FF-value16]",
        "parametrize",
        "pytestmark",
        "9C8400000001FF-value16",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_nested",
      "lineno": 70,
      "outcome": "passed",
      "keywords": [
        "test_decode_nested",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_nested_flat",
      "lineno": 75,
      "outcome": "passed",
      "keywords": [
        "test_decode_nested_flat",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_simple",
      "lineno": 85,
      "outcome": "passed",
      "keywords": [
        "test_decode_simple",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_exception[9F-9F-0-value0-Tag malformed, expecting more data: tag '9F', offset 0.]",
      "lineno": 91,
      "outcome": "passed",
      "keywords": [
        "test_decode_exception[9F-9F-0-value0-Tag malformed, expecting more data: tag '9F', offset 0.]",
        "parametrize",
        "pytestmark",
        "9F-9F-0-value0-Tag malformed, expecting more data: tag '9F', offset 0.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_exception[9FF0-9FF0-0-value1-Tag malformed, expecting more data: tag '9FF0', offset 0.]",
      "lineno": 91,
      "outcome": "passed",
      "keywords": [
        "test_decode_exception[9FF0-9FF0-0-value1-Tag malformed, expecting more data: tag '9FF0', offset 0.]",
        "parametrize",
        "pytestmark",
        "9FF0-9FF0-0-value1-Tag malformed, expecting more data: tag '9FF0', offset 0.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_exception[9C-9C-1-value2-Tag length malformed, expecting 1 byte(s): tag '9C', offset 1.]",
      "lineno": 91,
      "outcome": "passed",
      "keywords": [
        "test_decode_exception[9C-9C-1-value2-Tag length malformed, expecting 1 byte(s): tag '9C', offset 1.]",
        "parametrize",
        "pytestmark",
        "9C-9C-1-value2-Tag length malformed, expecting 1 byte(s): tag '9C', offset 1.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_exception[9C81-9C-2-value3-Tag length malformed, expecting 1 byte(s): tag '9C', offset 2.]",
      "lineno": 91,
      "outcome": "passed",
      "keywords": [
        "test_decode_exception[9C81-9C-2-value3-Tag length malformed, expecting 1 byte(s): tag '9C', offset 2.]",
        "parametrize",
        "pytestmark",
        "9C81-9C-2-value3-Tag length malformed, expecting 1 byte(s): tag '9C', offset 2.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_exception[9C8200-9C-2-value4-Tag length malformed, expecting 2 byte(s): tag '9C', offset 2.]",
      "lineno": 91,
      "outcome": "passed",
      "keywords": [
        "test_decode_exception[9C8200-9C-2-value4-Tag length malformed, expecting 2 byte(s): tag '9C', offset 2.]",
        "parametrize",
        "pytestmark",
        "9C8200-9C-2-value4-Tag length malformed, expecting 2 byte(s): tag '9C', offset 2.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_exception[9C01-9C-2-value5-Tag value malformed, expecting 1 byte(s): tag '9C', offset 2.]",
      "lineno": 91,
      "outcome": "passed",
      "keywords": [
        "test_decode_exception[9C01-9C-2-value5-Tag value malformed, expecting 1 byte(s): tag '9C', offset 2.]",
        "parametrize",
        "pytestmark",
        "9C01-9C-2-value5-Tag value malformed, expecting 1 byte(s): tag '9C', offset 2.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_exception[9C0200-9C-2-value6-Tag value malformed, expecting 2 byte(s): tag '9C', offset 2.]",
      "lineno": 91,
      "outcome": "passed",
      "keywords": [
        "test_decode_exception[9C0200-9C-2-value6-Tag value malformed, expecting 2 byte(s): tag '9C', offset 2.]",
        "parametrize",
        "pytestmark",
        "9C0200-9C-2-value6-Tag value malformed, expecting 2 byte(s): tag '9C', offset 2.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_exception[E001-E0-2-value7-Tag value malformed, expecting 1 byte(s): tag 'E0', offset 2.]",
      "lineno": 91,
      "outcome": "passed",
      "keywords": [
        "test_decode_exception[E001-E0-2-value7-Tag value malformed, expecting 1 byte(s): tag 'E0', offset 2.]",
        "parametrize",
        "pytestmark",
        "E001-E0-2-value7-Tag value malformed, expecting 1 byte(s): tag 'E0', offset 2.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_exception[E0019F0001FF-9F-2-value8-Tag malformed, expecting more data: tag '9F', offset 2.]",
      "lineno": 91,
      "outcome": "passed",
      "keywords": [
        "test_decode_exception[E0019F0001FF-9F-2-value8-Tag malformed, expecting more data: tag '9F', offset 2.]",
        "parametrize",
        "pytestmark",
        "E0019F0001FF-9F-2-value8-Tag malformed, expecting more data: tag '9F', offset 2.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_exception[E0019C01FF-9C-3-value9-Tag length malformed, expecting 1 byte(s): tag '9C', offset 3.]",
      "lineno": 91,
      "outcome": "passed",
      "keywords": [
        "test_decode_exception[E0019C01FF-9C-3-value9-Tag length malformed, expecting 1 byte(s): tag '9C', offset 3.]",
        "parametrize",
        "pytestmark",
        "E0019C01FF-9C-3-value9-Tag length malformed, expecting 1 byte(s): tag '9C', offset 3.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_exception[E0029C8101FF-9C-4-value10-Tag length malformed, expecting 1 byte(s): tag '9C', offset 4.]",
      "lineno": 91,
      "outcome": "passed",
      "keywords": [
        "test_decode_exception[E0029C8101FF-9C-4-value10-Tag length malformed, expecting 1 byte(s): tag '9C', offset 4.]",
        "parametrize",
        "pytestmark",
        "E0029C8101FF-9C-4-value10-Tag length malformed, expecting 1 byte(s): tag '9C', offset 4.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_exception[E0039C8201FF-9C-4-value11-Tag length malformed, expecting 2 byte(s): tag '9C', offset 4.]",
      "lineno": 91,
      "outcome": "passed",
      "keywords": [
        "test_decode_exception[E0039C8201FF-9C-4-value11-Tag length malformed, expecting 2 byte(s): tag '9C', offset 4.]",
        "parametrize",
        "pytestmark",
        "E0039C8201FF-9C-4-value11-Tag length malformed, expecting 2 byte(s): tag '9C', offset 4.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_exception[E0039C8101C001FF-9C-5-value12-Tag value malformed, expecting 1 byte(s): tag '9C', offset 5.]",
      "lineno": 91,
      "outcome": "passed",
      "keywords": [
        "test_decode_exception[E0039C8101C001FF-9C-5-value12-Tag value malformed, expecting 1 byte(s): tag '9C', offset 5.]",
        "parametrize",
        "pytestmark",
        "E0039C8101C001FF-9C-5-value12-Tag value malformed, expecting 1 byte(s): tag '9C', offset 5.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_exception[E0049C810200C001FF-9C-5-value13-Tag value malformed, expecting 2 byte(s): tag '9C', offset 5.]",
      "lineno": 91,
      "outcome": "passed",
      "keywords": [
        "test_decode_exception[E0049C810200C001FF-9C-5-value13-Tag value malformed, expecting 2 byte(s): tag '9C', offset 5.]",
        "parametrize",
        "pytestmark",
        "E0049C810200C001FF-9C-5-value13-Tag value malformed, expecting 2 byte(s): tag '9C', offset 5.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_exception[9C01FFAA-AA-4-value14-Tag length malformed, expecting 1 byte(s): tag 'AA', offset 4.]",
      "lineno": 91,
      "outcome": "passed",
      "keywords": [
        "test_decode_exception[9C01FFAA-AA-4-value14-Tag length malformed, expecting 1 byte(s): tag 'AA', offset 4.]",
        "parametrize",
        "pytestmark",
        "9C01FFAA-AA-4-value14-Tag length malformed, expecting 1 byte(s): tag 'AA', offset 4.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_decode_exception[E0039C01FFAA-AA-6-value15-Tag length malformed, expecting 1 byte(s): tag 'AA', offset 6.]",
      "lineno": 91,
      "outcome": "passed",
      "keywords": [
        "test_decode_exception[E0039C01FFAA-AA-6-value15-Tag length malformed, expecting 1 byte(s): tag 'AA', offset 6.]",
        "parametrize",
        "pytestmark",
        "E0039C01FFAA-AA-6-value15-Tag length malformed, expecting 1 byte(s): tag 'AA', offset 6.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode[tags0-]",
      "lineno": 139,
      "outcome": "passed",
      "keywords": [
        "test_encode[tags0-]",
        "parametrize",
        "pytestmark",
        "tags0-",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode[tags1-9C00]",
      "lineno": 139,
      "outcome": "passed",
      "keywords": [
        "test_encode[tags1-9C00]",
        "parametrize",
        "pytestmark",
        "tags1-9C00",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode[tags2-9C01FF]",
      "lineno": 139,
      "outcome": "passed",
      "keywords": [
        "test_encode[tags2-9C01FF]",
        "parametrize",
        "pytestmark",
        "tags2-9C01FF",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode[tags3-9F0001FF]",
      "lineno": 139,
      "outcome": "passed",
      "keywords": [
        "test_encode[tags3-9F0001FF]",
        "parametrize",
        "pytestmark",
        "tags3-9F0001FF",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode[tags4-9F800101FF]",
      "lineno": 139,
      "outcome": "passed",
      "keywords": [
        "test_encode[tags4-9F800101FF]",
        "parametrize",
        "pytestmark",
        "tags4-9F800101FF",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode[tags5-9C8180FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF]",
      "lineno": 139,
      "outcome": "passed",
      "keywords": [
        "test_encode[tags5-9C8180FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF]",
        "parametrize",
        "pytestmark",
        "tags5-9C8180FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode[tags6-9C8201FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF]",
      "lineno": 139,
      "outcome": "passed",
      "keywords": [
        "test_encode[tags6-9C8201FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF]",
        "parametrize",
        "pytestmark",
        "tags6-9C8201FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode[tags7-E000]",
      "lineno": 139,
      "outcome": "passed",
      "keywords": [
        "test_encode[tags7-E000]",
        "parametrize",
        "pytestmark",
        "tags7-E000",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode[tags8-E0029C00]",
      "lineno": 139,
      "outcome": "passed",
      "keywords": [
        "test_encode[tags8-E0029C00]",
        "parametrize",
        "pytestmark",
        "tags8-E0029C00",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode[tags9-E0039C01FF]",
      "lineno": 139,
      "outcome": "passed",
      "keywords": [
        "test_encode[tags9-E0039C01FF]",
        "parametrize",
        "pytestmark",
        "tags9-E0039C01FF",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode[tags10-E0049F0001FF]",
      "lineno": 139,
      "outcome": "passed",
      "keywords": [
        "test_encode[tags10-E0049F0001FF]",
        "parametrize",
        "pytestmark",
        "tags10-E0049F0001FF",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode[tags11-E0049F0001FF9C01FF]",
      "lineno": 139,
      "outcome": "passed",
      "keywords": [
        "test_encode[tags11-E0049F0001FF9C01FF]",
        "parametrize",
        "pytestmark",
        "tags11-E0049F0001FF9C01FF",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_str[tags0-]",
      "lineno": 166,
      "outcome": "passed",
      "keywords": [
        "test_encode_str[tags0-]",
        "parametrize",
        "pytestmark",
        "tags0-",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_str[tags1-9C00]",
      "lineno": 166,
      "outcome": "passed",
      "keywords": [
        "test_encode_str[tags1-9C00]",
        "parametrize",
        "pytestmark",
        "tags1-9C00",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_str[tags2-9C01FF]",
      "lineno": 166,
      "outcome": "passed",
      "keywords": [
        "test_encode_str[tags2-9C01FF]",
        "parametrize",
        "pytestmark",
        "tags2-9C01FF",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_str[tags3-9F0001FF]",
      "lineno": 166,
      "outcome": "passed",
      "keywords": [
        "test_encode_str[tags3-9F0001FF]",
        "parametrize",
        "pytestmark",
        "tags3-9F0001FF",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_str[tags4-9F800101FF]",
      "lineno": 166,
      "outcome": "passed",
      "keywords": [
        "test_encode_str[tags4-9F800101FF]",
        "parametrize",
        "pytestmark",
        "tags4-9F800101FF",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_str[tags5-9C8180FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF]",
      "lineno": 166,
      "outcome": "passed",
      "keywords": [
        "test_encode_str[tags5-9C8180FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF]",
        "parametrize",
        "pytestmark",
        "tags5-9C8180FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_str[tags6-9C8201FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF]",
      "lineno": 166,
      "outcome": "passed",
      "keywords": [
        "test_encode_str[tags6-9C8201FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF]",
        "parametrize",
        "pytestmark",
        "tags6-9C8201FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_str[tags7-E000]",
      "lineno": 166,
      "outcome": "passed",
      "keywords": [
        "test_encode_str[tags7-E000]",
        "parametrize",
        "pytestmark",
        "tags7-E000",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_str[tags8-E0029C00]",
      "lineno": 166,
      "outcome": "passed",
      "keywords": [
        "test_encode_str[tags8-E0029C00]",
        "parametrize",
        "pytestmark",
        "tags8-E0029C00",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_str[tags9-E0039C01FF]",
      "lineno": 166,
      "outcome": "passed",
      "keywords": [
        "test_encode_str[tags9-E0039C01FF]",
        "parametrize",
        "pytestmark",
        "tags9-E0039C01FF",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_str[tags10-E0049F0001FF]",
      "lineno": 166,
      "outcome": "passed",
      "keywords": [
        "test_encode_str[tags10-E0049F0001FF]",
        "parametrize",
        "pytestmark",
        "tags10-E0049F0001FF",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_str[tags11-E0049F0001FF9C01FF]",
      "lineno": 166,
      "outcome": "passed",
      "keywords": [
        "test_encode_str[tags11-E0049F0001FF9C01FF]",
        "parametrize",
        "pytestmark",
        "tags11-E0049F0001FF9C01FF",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_simple[tags0-]",
      "lineno": 193,
      "outcome": "passed",
      "keywords": [
        "test_encode_simple[tags0-]",
        "parametrize",
        "pytestmark",
        "tags0-",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_simple[tags1-9C00]",
      "lineno": 193,
      "outcome": "passed",
      "keywords": [
        "test_encode_simple[tags1-9C00]",
        "parametrize",
        "pytestmark",
        "tags1-9C00",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_simple[tags2-9C01FF]",
      "lineno": 193,
      "outcome": "passed",
      "keywords": [
        "test_encode_simple[tags2-9C01FF]",
        "parametrize",
        "pytestmark",
        "tags2-9C01FF",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_simple[tags3-9F0001FF]",
      "lineno": 193,
      "outcome": "passed",
      "keywords": [
        "test_encode_simple[tags3-9F0001FF]",
        "parametrize",
        "pytestmark",
        "tags3-9F0001FF",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_simple[tags4-9F800101FF]",
      "lineno": 193,
      "outcome": "passed",
      "keywords": [
        "test_encode_simple[tags4-9F800101FF]",
        "parametrize",
        "pytestmark",
        "tags4-9F800101FF",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_simple[tags5-9C80FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF]",
      "lineno": 193,
      "outcome": "passed",
      "keywords": [
        "test_encode_simple[tags5-9C80FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF]",
        "parametrize",
        "pytestmark",
        "tags5-9C80FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_simple[tags6-9CFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF]",
      "lineno": 193,
      "outcome": "passed",
      "keywords": [
        "test_encode_simple[tags6-9CFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF]",
        "parametrize",
        "pytestmark",
        "tags6-9CFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_simple[tags7-E000]",
      "lineno": 193,
      "outcome": "passed",
      "keywords": [
        "test_encode_simple[tags7-E000]",
        "parametrize",
        "pytestmark",
        "tags7-E000",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_simple[tags8-E0029C00]",
      "lineno": 193,
      "outcome": "passed",
      "keywords": [
        "test_encode_simple[tags8-E0029C00]",
        "parametrize",
        "pytestmark",
        "tags8-E0029C00",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_simple[tags9-E0039C01FF]",
      "lineno": 193,
      "outcome": "passed",
      "keywords": [
        "test_encode_simple[tags9-E0039C01FF]",
        "parametrize",
        "pytestmark",
        "tags9-E0039C01FF",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_simple[tags10-E0049F0001FF]",
      "lineno": 193,
      "outcome": "passed",
      "keywords": [
        "test_encode_simple[tags10-E0049F0001FF]",
        "parametrize",
        "pytestmark",
        "tags10-E0049F0001FF",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_simple[tags11-E0049F0001FF9C01FF]",
      "lineno": 193,
      "outcome": "passed",
      "keywords": [
        "test_encode_simple[tags11-E0049F0001FF9C01FF]",
        "parametrize",
        "pytestmark",
        "tags11-E0049F0001FF9C01FF",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_exception[tags0-XX-Invalid tag format, expecting hexchar string: tag 'XX'.]",
      "lineno": 220,
      "outcome": "passed",
      "keywords": [
        "test_encode_exception[tags0-XX-Invalid tag format, expecting hexchar string: tag 'XX'.]",
        "parametrize",
        "pytestmark",
        "tags0-XX-Invalid tag format, expecting hexchar string: tag 'XX'.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_exception[tags1-00X-Invalid tag format, expecting hexchar string: tag '00X'.]",
      "lineno": 220,
      "outcome": "passed",
      "keywords": [
        "test_encode_exception[tags1-00X-Invalid tag format, expecting hexchar string: tag '00X'.]",
        "parametrize",
        "pytestmark",
        "tags1-00X-Invalid tag format, expecting hexchar string: tag '00X'.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_exception[tags2-0-Invalid tag format, expecting hexchar string: tag '0'.]",
      "lineno": 220,
      "outcome": "passed",
      "keywords": [
        "test_encode_exception[tags2-0-Invalid tag format, expecting hexchar string: tag '0'.]",
        "parametrize",
        "pytestmark",
        "tags2-0-Invalid tag format, expecting hexchar string: tag '0'.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_exception[tags3-9F-Invalid tag format, expecting more data: tag '9F'.]",
      "lineno": 220,
      "outcome": "passed",
      "keywords": [
        "test_encode_exception[tags3-9F-Invalid tag format, expecting more data: tag '9F'.]",
        "parametrize",
        "pytestmark",
        "tags3-9F-Invalid tag format, expecting more data: tag '9F'.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_exception[tags4-9F0001-Invalid tag format, extra data: tag '9F0001'.]",
      "lineno": 220,
      "outcome": "passed",
      "keywords": [
        "test_encode_exception[tags4-9F0001-Invalid tag format, extra data: tag '9F0001'.]",
        "parametrize",
        "pytestmark",
        "tags4-9F0001-Invalid tag format, extra data: tag '9F0001'.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_exception[tags5-EC-Invalid value type (list) for a constructed tag, expecting a dict: tag 'EC'.]",
      "lineno": 220,
      "outcome": "passed",
      "keywords": [
        "test_encode_exception[tags5-EC-Invalid value type (list) for a constructed tag, expecting a dict: tag 'EC'.]",
        "parametrize",
        "pytestmark",
        "tags5-EC-Invalid value type (list) for a constructed tag, expecting a dict: tag 'EC'.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_exception[tags6-EC-Invalid value type (tuple) for a constructed tag, expecting a dict: tag 'EC'.]",
      "lineno": 220,
      "outcome": "passed",
      "keywords": [
        "test_encode_exception[tags6-EC-Invalid value type (tuple) for a constructed tag, expecting a dict: tag 'EC'.]",
        "parametrize",
        "pytestmark",
        "tags6-EC-Invalid value type (tuple) for a constructed tag, expecting a dict: tag 'EC'.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_exception[tags7-9C-Invalid value type (list) for a primitive tag, expecting bytes or str: tag '9C'.]",
      "lineno": 220,
      "outcome": "passed",
      "keywords": [
        "test_encode_exception[tags7-9C-Invalid value type (list) for a primitive tag, expecting bytes or str: tag '9C'.]",
        "parametrize",
        "pytestmark",
        "tags7-9C-Invalid value type (list) for a primitive tag, expecting bytes or str: tag '9C'.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_exception[tags8-9C-Invalid value type (tuple) for a primitive tag, expecting bytes or str: tag '9C'.]",
      "lineno": 220,
      "outcome": "passed",
      "keywords": [
        "test_encode_exception[tags8-9C-Invalid value type (tuple) for a primitive tag, expecting bytes or str: tag '9C'.]",
        "parametrize",
        "pytestmark",
        "tags8-9C-Invalid value type (tuple) for a primitive tag, expecting bytes or str: tag '9C'.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_exception[tags9-9C-Invalid value format, expecting hexchar string: tag '9C'.]",
      "lineno": 220,
      "outcome": "passed",
      "keywords": [
        "test_encode_exception[tags9-9C-Invalid value format, expecting hexchar string: tag '9C'.]",
        "parametrize",
        "pytestmark",
        "tags9-9C-Invalid value format, expecting hexchar string: tag '9C'.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_exception[tags10-9C-Invalid value format, expecting hexchar string: tag '9C'.]",
      "lineno": 220,
      "outcome": "passed",
      "keywords": [
        "test_encode_exception[tags10-9C-Invalid value format, expecting hexchar string: tag '9C'.]",
        "parametrize",
        "pytestmark",
        "tags10-9C-Invalid value format, expecting hexchar string: tag '9C'.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_simple_exception[tags0-9C-Value length (256) cannot exceed 255 bytes when 'simple' is enabled: tag '9C'.]",
      "lineno": 247,
      "outcome": "passed",
      "keywords": [
        "test_encode_simple_exception[tags0-9C-Value length (256) cannot exceed 255 bytes when 'simple' is enabled: tag '9C'.]",
        "parametrize",
        "pytestmark",
        "tags0-9C-Value length (256) cannot exceed 255 bytes when 'simple' is enabled: tag '9C'.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_tlv.py::test_encode_simple_exception[tags1-9C-Value length (256) cannot exceed 255 bytes when 'simple' is enabled: tag '9C'.]",
      "lineno": 247,
      "outcome": "passed",
      "keywords": [
        "test_encode_simple_exception[tags1-9C-Value length (256) cannot exceed 255 bytes when 'simple' is enabled: tag '9C'.]",
        "parametrize",
        "pytestmark",
        "tags1-9C-Value length (256) cannot exceed 255 bytes when 'simple' is enabled: tag '9C'.",
        "test_tlv.py",
        "tests",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "pyemv/__init__.py::pyemv",
      "lineno": 0,
      "outcome": "passed",
      "keywords": [
        "pyemv",
        "__init__.py",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "pyemv/ac.py::pyemv.ac",
      "lineno": 0,
      "outcome": "failed",
      "keywords": [
        "pyemv.ac",
        "ac.py",
        "pyemv",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "longrepr": "002 Cryptograms (TC, ARQC, or AAC) generated by the ICC and the\n003 Authorisation Response Cryptogram (ARPC) generated by the\n004 issuer and verified by the ICC.\n005 \n006 ARQC:\n007 \n008     >>> import pyemv\n009     >>> session_key = bytes.fromhex('29B33180E567CE38EA4CBC9D753B0E61')\n010     >>> ac_data = bytes.fromhex('0123456789ABCDEF0123456789ABCDEF')\n011     >>> arqc = pyemv.ac.generate_ac(session_key, ac_data)\nUNEXPECTED EXCEPTION: ValueError('Not a valid TDES key')\nTraceback (most recent call last):\n  File \"C:\\Users\\Mohay\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\doctest.py\", line 1368, in __run\n    exec(compile(example.source, filename, \"single\",\n  File \"<doctest pyemv.ac[3]>\", line 1, in <module>\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\pyemv\\ac.py\", line 165, in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\pyemv\\mac.py\", line 83, in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py\", line 174, in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py\", line 79, in _create_cipher\n    return modes[mode](factory, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py\", line 274, in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py\", line 99, in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py\", line 80, in adjust_key_parity\n    raise ValueError(\"Not a valid TDES key\")\nValueError: Not a valid TDES key\nD:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\pyemv\\ac.py:11: UnexpectedException"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "pyemv/ac.py::pyemv.ac.generate_ac",
      "lineno": 54,
      "outcome": "failed",
      "keywords": [
        "pyemv.ac.generate_ac",
        "ac.py",
        "pyemv",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "longrepr": "140     ...     \"000000000000\" + # 9F03\n141     ...     \"0124\" +         # 9F1A\n142     ...     \"0000008000\" +   # 95\n143     ...     \"0124\" +         # 5F2A\n144     ...     \"110309\" +       # 9A\n145     ...     \"00\" +           # 9C\n146     ...     \"3804823E\" +     # 9F37\n147     ...     \"5800\" +         # 82\n148     ...     \"0001\")          # 9F36\n149     >>> arqc = ac.generate_ac(sk_ac, data)\nUNEXPECTED EXCEPTION: ValueError('Not a valid TDES key')\nTraceback (most recent call last):\n  File \"C:\\Users\\Mohay\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\doctest.py\", line 1368, in __run\n    exec(compile(example.source, filename, \"single\",\n  File \"<doctest pyemv.ac.generate_ac[3]>\", line 1, in <module>\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\pyemv\\ac.py\", line 165, in generate_ac\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], data, padding_type.value, length)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\pyemv\\mac.py\", line 83, in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py\", line 174, in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py\", line 79, in _create_cipher\n    return modes[mode](factory, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py\", line 274, in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py\", line 99, in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py\", line 80, in adjust_key_parity\n    raise ValueError(\"Not a valid TDES key\")\nValueError: Not a valid TDES key\nD:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\pyemv\\ac.py:149: UnexpectedException"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "pyemv/ac.py::pyemv.ac.generate_arpc_1",
      "lineno": 168,
      "outcome": "passed",
      "keywords": [
        "pyemv.ac.generate_arpc_1",
        "ac.py",
        "pyemv",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "pyemv/ac.py::pyemv.ac.generate_arpc_2",
      "lineno": 240,
      "outcome": "failed",
      "keywords": [
        "pyemv.ac.generate_arpc_2",
        "ac.py",
        "pyemv",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "longrepr": "285         - EMV 4.3 Book 2 Section 8.2.2 ARPC Method 2\n286         - EMV 4.3 Book 2 Annex A 1.2.1\n287 \n288     Examples\n289     --------\n290     >>> from pyemv import ac\n291     >>> sk_ac = bytes.fromhex(\"AAAAAAAAAAAAAAAABBBBBBBBBBBBBBBB\")\n292     >>> arqc = bytes.fromhex(\"1234567890ABCDEF\")\n293     >>> csu = bytes.fromhex(\"00000000\")\n294     >>> arpc = ac.generate_arpc_2(sk_ac, arqc, csu)\nUNEXPECTED EXCEPTION: ValueError('Not a valid TDES key')\nTraceback (most recent call last):\n  File \"C:\\Users\\Mohay\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\doctest.py\", line 1368, in __run\n    exec(compile(example.source, filename, \"single\",\n  File \"<doctest pyemv.ac.generate_arpc_2[4]>\", line 1, in <module>\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\pyemv\\ac.py\", line 313, in generate_arpc_2\n    return _mac_iso9797_3(sk_ac[:8], sk_ac[-8:], arqc + csu + prop_auth_data, 2, 4)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\pyemv\\mac.py\", line 83, in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py\", line 174, in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py\", line 79, in _create_cipher\n    return modes[mode](factory, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py\", line 274, in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py\", line 99, in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py\", line 80, in adjust_key_parity\n    raise ValueError(\"Not a valid TDES key\")\nValueError: Not a valid TDES key\nD:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\pyemv\\ac.py:294: UnexpectedException"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "pyemv/cvn.py::pyemv.cvn",
      "lineno": 0,
      "outcome": "failed",
      "keywords": [
        "pyemv.cvn",
        "cvn.py",
        "pyemv",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "longrepr": "007     - Authorisation Response Cryptogram calculation method\n008     - Secure Messaging Session Key derivation method\n009     - Secure Messaging Integrity (MAC) data format and padding\n010     - Secure Messaging Confidentiality encryption method and padding\n011 \n012 CVN module combines application cryptogram generation, key derivation and\n013 secure messaging in one class per CVN.\n014 \n015     >>> import pyemv\n016     >>> cvn18 = pyemv.cvn.VisaCVN18(\nUNEXPECTED EXCEPTION: ValueError('Triple DES key degenerates to single DES')\nTraceback (most recent call last):\n  File \"C:\\Users\\Mohay\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\doctest.py\", line 1368, in __run\n    exec(compile(example.source, filename, \"single\",\n  File \"<doctest pyemv.cvn[1]>\", line 1, in <module>\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\pyemv\\cvn.py\", line 406, in __init__\n    self.icc_mk_ac = _kd.derive_icc_mk_b(iss_mk_ac, pan, psn)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\pyemv\\kd.py\", line 149, in derive_icc_mk_b\n    return derive_icc_mk_a(iss_mk, pan, psn)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\pyemv\\kd.py\", line 93, in derive_icc_mk_a\n    icc_mk = _tools.encrypt_tdes_ecb(iss_mk, data_a + data_b)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\pyemv\\tools.py\", line 171, in encrypt_tdes_ecb\n    cipher = DES3.new(key, DES3.MODE_ECB)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py\", line 174, in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py\", line 79, in _create_cipher\n    return modes[mode](factory, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_ecb.py\", line 216, in _create_ecb_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py\", line 99, in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py\", line 85, in adjust_key_parity\n    raise ValueError(\"Triple DES key degenerates to single DES\")\nValueError: Triple DES key degenerates to single DES\nD:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\pyemv\\cvn.py:16: UnexpectedException"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "pyemv/cvv.py::pyemv.cvv.generate_cvc3",
      "lineno": 12,
      "outcome": "failed",
      "keywords": [
        "pyemv.cvv.generate_cvc3",
        "cvv.py",
        "pyemv",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "longrepr": "063     >>> from pyemv.cvv import generate_cvc3\n064     >>> from pyemv.kd import derive_icc_mk_a\n065     >>> iss_cvc3 = bytes.fromhex(\"01234567899876543210012345678998\")\n066     >>> pan = \"5123456789012345\"\n067     >>> psn = \"00\"\n068     >>> icc_cvc3 = derive_icc_mk_a(iss_cvc3, pan, psn)\n069     >>> track2 = bytes.fromhex(\"5123456789012345D35121010000000000000F\")\n070     >>> atc = bytes.fromhex(\"005E\")\n071     >>> un = bytes.fromhex(\"00000899\")\n072     >>> generate_cvc3(icc_cvc3, track2, atc, un)\nUNEXPECTED EXCEPTION: ValueError('Not a valid TDES key')\nTraceback (most recent call last):\n  File \"C:\\Users\\Mohay\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\doctest.py\", line 1368, in __run\n    exec(compile(example.source, filename, \"single\",\n  File \"<doctest pyemv.cvv.generate_cvc3[9]>\", line 1, in <module>\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\pyemv\\cvv.py\", line 86, in generate_cvc3\n    iv_cvc3 = _mac.mac_iso9797_3(icc_cvc3[:8], icc_cvc3[-8:], track_template, 2)[-2:]\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\pyemv\\mac.py\", line 83, in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py\", line 174, in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py\", line 79, in _create_cipher\n    return modes[mode](factory, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py\", line 274, in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py\", line 99, in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py\", line 80, in adjust_key_parity\n    raise ValueError(\"Not a valid TDES key\")\nValueError: Not a valid TDES key\nD:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\pyemv\\cvv.py:72: UnexpectedException"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "pyemv/kd.py::pyemv.kd",
      "lineno": 0,
      "outcome": "passed",
      "keywords": [
        "pyemv.kd",
        "kd.py",
        "pyemv",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "pyemv/kd.py::pyemv.kd.derive_common_sk",
      "lineno": 200,
      "outcome": "passed",
      "keywords": [
        "pyemv.kd.derive_common_sk",
        "kd.py",
        "pyemv",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "pyemv/kd.py::pyemv.kd.derive_emv2000_tree_sk",
      "lineno": 318,
      "outcome": "passed",
      "keywords": [
        "pyemv.kd.derive_emv2000_tree_sk",
        "kd.py",
        "pyemv",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "pyemv/kd.py::pyemv.kd.derive_icc_mk_a",
      "lineno": 33,
      "outcome": "passed",
      "keywords": [
        "pyemv.kd.derive_icc_mk_a",
        "kd.py",
        "pyemv",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "pyemv/kd.py::pyemv.kd.derive_icc_mk_b",
      "lineno": 102,
      "outcome": "passed",
      "keywords": [
        "pyemv.kd.derive_icc_mk_b",
        "kd.py",
        "pyemv",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "pyemv/kd.py::pyemv.kd.derive_visa_sm_sk",
      "lineno": 263,
      "outcome": "passed",
      "keywords": [
        "pyemv.kd.derive_visa_sm_sk",
        "kd.py",
        "pyemv",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "pyemv/mac.py::pyemv.mac.mac_iso9797_3",
      "lineno": 17,
      "outcome": "passed",
      "keywords": [
        "pyemv.mac.mac_iso9797_3",
        "mac.py",
        "pyemv",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "pyemv/mac.py::pyemv.mac.pad_iso9797_1",
      "lineno": 92,
      "outcome": "passed",
      "keywords": [
        "pyemv.mac.pad_iso9797_1",
        "mac.py",
        "pyemv",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "pyemv/mac.py::pyemv.mac.pad_iso9797_2",
      "lineno": 135,
      "outcome": "passed",
      "keywords": [
        "pyemv.mac.pad_iso9797_2",
        "mac.py",
        "pyemv",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "pyemv/sm.py::pyemv.sm",
      "lineno": 0,
      "outcome": "failed",
      "keywords": [
        "pyemv.sm",
        "sm.py",
        "pyemv",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "longrepr": "001 The objectives of secure messaging are to ensure data confidentiality, data\n002 integrity, and authentication of the sender. Data integrity and issuer\n003 authentication are achieved using a MAC. Data confidentiality is achieved\n004 using encipherment of the data field.\n005 \n006 Secure Messaging Integrity (MAC):\n007 \n008     >>> import pyemv\n009     >>> mac = pyemv.sm.generate_command_mac(\nUNEXPECTED EXCEPTION: ValueError('Not a valid TDES key')\nTraceback (most recent call last):\n  File \"C:\\Users\\Mohay\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\doctest.py\", line 1368, in __run\n    exec(compile(example.source, filename, \"single\",\n  File \"<doctest pyemv.sm[1]>\", line 1, in <module>\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\pyemv\\sm.py\", line 108, in generate_command_mac\n    return _mac.mac_iso9797_3(sk_smi[:8], sk_smi[-8:], command, 2, length)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\pyemv\\mac.py\", line 83, in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py\", line 174, in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py\", line 79, in _create_cipher\n    return modes[mode](factory, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py\", line 274, in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py\", line 99, in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py\", line 80, in adjust_key_parity\n    raise ValueError(\"Not a valid TDES key\")\nValueError: Not a valid TDES key\nD:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\pyemv\\sm.py:9: UnexpectedException"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "pyemv/sm.py::pyemv.sm.encrypt_command_data",
      "lineno": 119,
      "outcome": "passed",
      "keywords": [
        "pyemv.sm.encrypt_command_data",
        "sm.py",
        "pyemv",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "pyemv/sm.py::pyemv.sm.format_iso9564_2_pin_block",
      "lineno": 291,
      "outcome": "passed",
      "keywords": [
        "pyemv.sm.format_iso9564_2_pin_block",
        "sm.py",
        "pyemv",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "pyemv/sm.py::pyemv.sm.format_vis_pin_block",
      "lineno": 222,
      "outcome": "passed",
      "keywords": [
        "pyemv.sm.format_vis_pin_block",
        "sm.py",
        "pyemv",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "pyemv/sm.py::pyemv.sm.generate_command_mac",
      "lineno": 46,
      "outcome": "failed",
      "keywords": [
        "pyemv.sm.generate_command_mac",
        "sm.py",
        "pyemv",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "longrepr": "092         - EMV 4.3 Book 2 Annex A 1.2\n093 \n094     Examples\n095     --------\n096     >>> from pyemv import sm\n097     >>> sk_smi = bytes.fromhex(\"0123456789ABCDEFFEDCBA9876543210\")\n098     >>> command = bytes.fromhex(\"8424000008\")\n099     >>> atc = bytes.fromhex(\"FFFF\")\n100     >>> arqc = bytes.fromhex(\"1234567890123456\")\n101     >>> mac = sm.generate_command_mac(sk_smi, command + atc + arqc)\nUNEXPECTED EXCEPTION: ValueError('Not a valid TDES key')\nTraceback (most recent call last):\n  File \"C:\\Users\\Mohay\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\doctest.py\", line 1368, in __run\n    exec(compile(example.source, filename, \"single\",\n  File \"<doctest pyemv.sm.generate_command_mac[5]>\", line 1, in <module>\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\pyemv\\sm.py\", line 108, in generate_command_mac\n    return _mac.mac_iso9797_3(sk_smi[:8], sk_smi[-8:], command, 2, length)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\pyemv\\mac.py\", line 83, in mac_iso9797_3\n    cipher1 = DES3.new(key1, DES3.MODE_CBC, iv=b\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\")\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py\", line 174, in new\n    return _create_cipher(sys.modules[__name__], key, mode, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\__init__.py\", line 79, in _create_cipher\n    return modes[mode](factory, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_cbc.py\", line 274, in _create_cbc_cipher\n    cipher_state = factory._create_base_cipher(kwargs)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py\", line 99, in _create_base_cipher\n    key = adjust_key_parity(bstr(key_in))\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\DES3.py\", line 80, in adjust_key_parity\n    raise ValueError(\"Not a valid TDES key\")\nValueError: Not a valid TDES key\nD:\\repos\\knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome\\pyemv\\sm.py:101: UnexpectedException"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "pyemv/tlv.py::pyemv.tlv",
      "lineno": 0,
      "outcome": "passed",
      "keywords": [
        "pyemv.tlv",
        "tlv.py",
        "pyemv",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "pyemv/tlv.py::pyemv.tlv.decode",
      "lineno": 106,
      "outcome": "passed",
      "keywords": [
        "pyemv.tlv.decode",
        "tlv.py",
        "pyemv",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "pyemv/tlv.py::pyemv.tlv.encode",
      "lineno": 278,
      "outcome": "passed",
      "keywords": [
        "pyemv.tlv.encode",
        "tlv.py",
        "pyemv",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "pyemv/tools.py::pyemv.tools.adjust_key_parity",
      "lineno": 65,
      "outcome": "passed",
      "keywords": [
        "pyemv.tools.adjust_key_parity",
        "tools.py",
        "pyemv",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "pyemv/tools.py::pyemv.tools.encrypt_tdes_cbc",
      "lineno": 120,
      "outcome": "passed",
      "keywords": [
        "pyemv.tools.encrypt_tdes_cbc",
        "tools.py",
        "pyemv",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "pyemv/tools.py::pyemv.tools.encrypt_tdes_ecb",
      "lineno": 149,
      "outcome": "passed",
      "keywords": [
        "pyemv.tools.encrypt_tdes_ecb",
        "tools.py",
        "pyemv",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "pyemv/tools.py::pyemv.tools.key_check_digits",
      "lineno": 94,
      "outcome": "passed",
      "keywords": [
        "pyemv.tools.key_check_digits",
        "tools.py",
        "pyemv",
        "knovichikhin@pyemv__d7df75c3__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    }
  ]
}
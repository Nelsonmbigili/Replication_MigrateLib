{
  "exitcode": 1,
  "summary": {
    "passed": 7,
    "failed": 14,
    "total": 21,
    "collected": 21
  },
  "collectors": [
    {
      "nodeid": "",
      "outcome": "passed",
      "result": [
        {
          "nodeid": ".",
          "type": "Dir"
        }
      ]
    },
    {
      "nodeid": "kling",
      "outcome": "passed",
      "result": []
    },
    {
      "nodeid": "kling_creator.egg-info",
      "outcome": "passed",
      "result": []
    },
    {
      "nodeid": "tests/test_kling.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "tests/test_kling.py::test_base_gen_init",
          "type": "Function",
          "lineno": 33
        },
        {
          "nodeid": "tests/test_kling.py::test_image_gen_init",
          "type": "Function",
          "lineno": 38
        },
        {
          "nodeid": "tests/test_kling.py::test_video_gen_init",
          "type": "Function",
          "lineno": 43
        },
        {
          "nodeid": "tests/test_kling.py::test_parse_cookie_string",
          "type": "Function",
          "lineno": 48
        },
        {
          "nodeid": "tests/test_kling.py::test_get_account_point[ImageGen]",
          "type": "Function",
          "lineno": 59
        },
        {
          "nodeid": "tests/test_kling.py::test_get_account_point[VideoGen]",
          "type": "Function",
          "lineno": 59
        },
        {
          "nodeid": "tests/test_kling.py::test_image_uploader",
          "type": "Function",
          "lineno": 71
        },
        {
          "nodeid": "tests/test_kling.py::test_fetch_metadata",
          "type": "Function",
          "lineno": 89
        },
        {
          "nodeid": "tests/test_kling.py::test_get_content[ImageGen-get_images]",
          "type": "Function",
          "lineno": 113
        },
        {
          "nodeid": "tests/test_kling.py::test_get_content[VideoGen-get_video]",
          "type": "Function",
          "lineno": 113
        },
        {
          "nodeid": "tests/test_kling.py::test_save_content[ImageGen-save_images]",
          "type": "Function",
          "lineno": 136
        },
        {
          "nodeid": "tests/test_kling.py::test_save_content[VideoGen-save_video]",
          "type": "Function",
          "lineno": 136
        },
        {
          "nodeid": "tests/test_kling.py::test_call_for_daily_check",
          "type": "Function",
          "lineno": 159
        },
        {
          "nodeid": "tests/test_kling.py::test_video_gen_get_video",
          "type": "Function",
          "lineno": 172
        },
        {
          "nodeid": "tests/test_kling.py::test_video_gen_save_video",
          "type": "Function",
          "lineno": 195
        },
        {
          "nodeid": "tests/test_kling.py::test_image_gen_get_images",
          "type": "Function",
          "lineno": 217
        },
        {
          "nodeid": "tests/test_kling.py::test_image_gen_save_images",
          "type": "Function",
          "lineno": 237
        },
        {
          "nodeid": "tests/test_kling.py::test_extend_video_completed",
          "type": "Function",
          "lineno": 260
        },
        {
          "nodeid": "tests/test_kling.py::test_extend_video_pending",
          "type": "Function",
          "lineno": 272
        },
        {
          "nodeid": "tests/test_kling.py::test_extend_video_failed",
          "type": "Function",
          "lineno": 283
        },
        {
          "nodeid": "tests/test_kling.py::test_extend_video_no_works",
          "type": "Function",
          "lineno": 294
        }
      ]
    },
    {
      "nodeid": "tests",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "tests/test_kling.py",
          "type": "Module"
        }
      ]
    },
    {
      "nodeid": ".",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "kling",
          "type": "Package"
        },
        {
          "nodeid": "kling_creator.egg-info",
          "type": "Dir"
        },
        {
          "nodeid": "tests",
          "type": "Dir"
        }
      ]
    }
  ],
  "tests": [
    {
      "nodeid": "tests/test_kling.py::test_base_gen_init",
      "lineno": 33,
      "outcome": "passed",
      "keywords": [
        "test_base_gen_init",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__treq",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_image_gen_init",
      "lineno": 38,
      "outcome": "passed",
      "keywords": [
        "test_image_gen_init",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__treq",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_video_gen_init",
      "lineno": 43,
      "outcome": "passed",
      "keywords": [
        "test_video_gen_init",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__treq",
        ""
      ],
      "setup": {
        "outcome": "passed",
        "stderr": "Unhandled error in Deferred:\n\nTraceback (most recent call last):\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\internet\\defer.py\", line 1857, in _inlineCallbacks\n    result = context.run(gen.send, result)\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\kling\\kling.py\", line 25, in call_for_daily_check\n    response = await treq.get(url, headers=client.headers, cookies=client.cookies)\nbuiltins.TypeError: object MagicMock can't be used in 'await' expression\n\nUnhandled error in Deferred:\n\nTraceback (most recent call last):\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\internet\\defer.py\", line 1857, in _inlineCallbacks\n    result = context.run(gen.send, result)\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\kling\\kling.py\", line 25, in call_for_daily_check\n    response = await treq.get(url, headers=client.headers, cookies=client.cookies)\nbuiltins.TypeError: object MagicMock can't be used in 'await' expression\n\n"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_parse_cookie_string",
      "lineno": 48,
      "outcome": "passed",
      "keywords": [
        "test_parse_cookie_string",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__treq",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_get_account_point[ImageGen]",
      "lineno": 59,
      "outcome": "failed",
      "keywords": [
        "test_get_account_point[ImageGen]",
        "parametrize",
        "__wrapped__",
        "pytestmark",
        "ImageGen",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__treq",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\_pytest\\python.py",
          "lineno": 147,
          "message": "Failed: async def functions are not natively supported.\nYou need to install a suitable plugin for your async framework, for example:\n  - anyio\n  - pytest-asyncio\n  - pytest-tornasync\n  - pytest-trio\n  - pytest-twisted"
        },
        "stderr": "Unhandled error in Deferred:\n\nTraceback (most recent call last):\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\internet\\defer.py\", line 1857, in _inlineCallbacks\n    result = context.run(gen.send, result)\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\kling\\kling.py\", line 25, in call_for_daily_check\n    response = await treq.get(url, headers=client.headers, cookies=client.cookies)\nbuiltins.TypeError: object MagicMock can't be used in 'await' expression\n\n",
        "longrepr": "async def functions are not natively supported.\nYou need to install a suitable plugin for your async framework, for example:\n  - anyio\n  - pytest-asyncio\n  - pytest-tornasync\n  - pytest-trio\n  - pytest-twisted"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_get_account_point[VideoGen]",
      "lineno": 59,
      "outcome": "failed",
      "keywords": [
        "test_get_account_point[VideoGen]",
        "parametrize",
        "__wrapped__",
        "pytestmark",
        "VideoGen",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__treq",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\_pytest\\python.py",
          "lineno": 147,
          "message": "Failed: async def functions are not natively supported.\nYou need to install a suitable plugin for your async framework, for example:\n  - anyio\n  - pytest-asyncio\n  - pytest-tornasync\n  - pytest-trio\n  - pytest-twisted"
        },
        "stderr": "Unhandled error in Deferred:\n\nTraceback (most recent call last):\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\internet\\defer.py\", line 1857, in _inlineCallbacks\n    result = context.run(gen.send, result)\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\kling\\kling.py\", line 25, in call_for_daily_check\n    response = await treq.get(url, headers=client.headers, cookies=client.cookies)\nbuiltins.TypeError: object MagicMock can't be used in 'await' expression\n\n",
        "longrepr": "async def functions are not natively supported.\nYou need to install a suitable plugin for your async framework, for example:\n  - anyio\n  - pytest-asyncio\n  - pytest-tornasync\n  - pytest-trio\n  - pytest-twisted"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_image_uploader",
      "lineno": 71,
      "outcome": "failed",
      "keywords": [
        "test_image_uploader",
        "__wrapped__",
        "patchings",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__treq",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\_pytest\\python.py",
          "lineno": 147,
          "message": "Failed: async def functions are not natively supported.\nYou need to install a suitable plugin for your async framework, for example:\n  - anyio\n  - pytest-asyncio\n  - pytest-tornasync\n  - pytest-trio\n  - pytest-twisted"
        },
        "stderr": "Unhandled error in Deferred:\n\nTraceback (most recent call last):\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\internet\\defer.py\", line 1857, in _inlineCallbacks\n    result = context.run(gen.send, result)\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\kling\\kling.py\", line 25, in call_for_daily_check\n    response = await treq.get(url, headers=client.headers, cookies=client.cookies)\nbuiltins.TypeError: object MagicMock can't be used in 'await' expression\n\nUnhandled error in Deferred:\n\nTraceback (most recent call last):\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\internet\\defer.py\", line 1857, in _inlineCallbacks\n    result = context.run(gen.send, result)\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\kling\\kling.py\", line 25, in call_for_daily_check\n    response = await treq.get(url, headers=client.headers, cookies=client.cookies)\nbuiltins.TypeError: object MagicMock can't be used in 'await' expression\n\nUnhandled error in Deferred:\n\nTraceback (most recent call last):\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\internet\\defer.py\", line 1853, in _inlineCallbacks\n    result = context.run(\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\python\\failure.py\", line 467, in throwExceptionIntoGenerator\n    return g.throw(self.value.with_traceback(self.tb))\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\tests\\test_kling.py\", line 68, in test_get_account_point\n    result = yield gen.get_account_point()\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\internet\\defer.py\", line 1857, in _inlineCallbacks\n    result = context.run(gen.send, result)\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\kling\\kling.py\", line 85, in get_account_point\n    bonus_req = await treq.get(self.daily_url, headers=self.headers, cookies=self.cookies)\nbuiltins.TypeError: object MagicMock can't be used in 'await' expression\n\nUnhandled error in Deferred:\n\nTraceback (most recent call last):\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\internet\\defer.py\", line 1853, in _inlineCallbacks\n    result = context.run(\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\python\\failure.py\", line 467, in throwExceptionIntoGenerator\n    return g.throw(self.value.with_traceback(self.tb))\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\tests\\test_kling.py\", line 68, in test_get_account_point\n    result = yield gen.get_account_point()\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\internet\\defer.py\", line 1857, in _inlineCallbacks\n    result = context.run(gen.send, result)\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\kling\\kling.py\", line 85, in get_account_point\n    bonus_req = await treq.get(self.daily_url, headers=self.headers, cookies=self.cookies)\nbuiltins.TypeError: object MagicMock can't be used in 'await' expression\n\n",
        "longrepr": "async def functions are not natively supported.\nYou need to install a suitable plugin for your async framework, for example:\n  - anyio\n  - pytest-asyncio\n  - pytest-tornasync\n  - pytest-trio\n  - pytest-twisted"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_fetch_metadata",
      "lineno": 89,
      "outcome": "failed",
      "keywords": [
        "test_fetch_metadata",
        "__wrapped__",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__treq",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\_pytest\\python.py",
          "lineno": 147,
          "message": "Failed: async def functions are not natively supported.\nYou need to install a suitable plugin for your async framework, for example:\n  - anyio\n  - pytest-asyncio\n  - pytest-tornasync\n  - pytest-trio\n  - pytest-twisted"
        },
        "stderr": "Unhandled error in Deferred:\n\nTraceback (most recent call last):\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\internet\\defer.py\", line 1857, in _inlineCallbacks\n    result = context.run(gen.send, result)\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\kling\\kling.py\", line 25, in call_for_daily_check\n    response = await treq.get(url, headers=client.headers, cookies=client.cookies)\nbuiltins.TypeError: object MagicMock can't be used in 'await' expression\n\n",
        "longrepr": "async def functions are not natively supported.\nYou need to install a suitable plugin for your async framework, for example:\n  - anyio\n  - pytest-asyncio\n  - pytest-tornasync\n  - pytest-trio\n  - pytest-twisted"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_get_content[ImageGen-get_images]",
      "lineno": 113,
      "outcome": "failed",
      "keywords": [
        "test_get_content[ImageGen-get_images]",
        "parametrize",
        "__wrapped__",
        "pytestmark",
        "ImageGen-get_images",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__treq",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\_pytest\\python.py",
          "lineno": 147,
          "message": "Failed: async def functions are not natively supported.\nYou need to install a suitable plugin for your async framework, for example:\n  - anyio\n  - pytest-asyncio\n  - pytest-tornasync\n  - pytest-trio\n  - pytest-twisted"
        },
        "stderr": "Unhandled error in Deferred:\n\nTraceback (most recent call last):\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\internet\\defer.py\", line 1857, in _inlineCallbacks\n    result = context.run(gen.send, result)\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\kling\\kling.py\", line 25, in call_for_daily_check\n    response = await treq.get(url, headers=client.headers, cookies=client.cookies)\nbuiltins.TypeError: object MagicMock can't be used in 'await' expression\n\n",
        "longrepr": "async def functions are not natively supported.\nYou need to install a suitable plugin for your async framework, for example:\n  - anyio\n  - pytest-asyncio\n  - pytest-tornasync\n  - pytest-trio\n  - pytest-twisted"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_get_content[VideoGen-get_video]",
      "lineno": 113,
      "outcome": "failed",
      "keywords": [
        "test_get_content[VideoGen-get_video]",
        "parametrize",
        "__wrapped__",
        "pytestmark",
        "VideoGen-get_video",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__treq",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\_pytest\\python.py",
          "lineno": 147,
          "message": "Failed: async def functions are not natively supported.\nYou need to install a suitable plugin for your async framework, for example:\n  - anyio\n  - pytest-asyncio\n  - pytest-tornasync\n  - pytest-trio\n  - pytest-twisted"
        },
        "longrepr": "async def functions are not natively supported.\nYou need to install a suitable plugin for your async framework, for example:\n  - anyio\n  - pytest-asyncio\n  - pytest-tornasync\n  - pytest-trio\n  - pytest-twisted"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_save_content[ImageGen-save_images]",
      "lineno": 136,
      "outcome": "failed",
      "keywords": [
        "test_save_content[ImageGen-save_images]",
        "parametrize",
        "__wrapped__",
        "patchings",
        "pytestmark",
        "ImageGen-save_images",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__treq",
        ""
      ],
      "setup": {
        "outcome": "passed",
        "stderr": "Unhandled error in Deferred:\n\nTraceback (most recent call last):\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\internet\\defer.py\", line 1857, in _inlineCallbacks\n    result = context.run(gen.send, result)\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\kling\\kling.py\", line 25, in call_for_daily_check\n    response = await treq.get(url, headers=client.headers, cookies=client.cookies)\nbuiltins.TypeError: object MagicMock can't be used in 'await' expression\n\n"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\tests\\test_kling.py",
          "lineno": 144,
          "message": "AttributeError: 'dict' object has no attribute 'post'"
        },
        "traceback": [
          {
            "path": "tests\\test_kling.py",
            "lineno": 144,
            "message": "AttributeError"
          }
        ],
        "longrepr": "mock_mkdir = <MagicMock name='mkdir' id='1619863742992'>\nmock_exists = <MagicMock name='exists' id='1619863781712'>\ngen_class = <class 'kling.kling.ImageGen'>, method_name = 'save_images'\nmock_session = {'get': <MagicMock name='get' id='1619863618704'>, 'post': <MagicMock name='post' id='1619863736080'>}\n\n    @pytest.mark.parametrize(\n        \"gen_class,method_name\", [(ImageGen, \"save_images\"), (VideoGen, \"save_video\")]\n    )\n    @patch(\"os.path.exists\", return_value=False)\n    @patch(\"os.mkdir\")\n    def test_save_content(mock_mkdir, mock_exists, gen_class, method_name, mock_session):\n        gen = gen_class(\"mock_cookie\")\n>       mock_session.post.return_value.json.return_value = {\n        ^^^^^^^^^^^^^^^^^\n            \"data\": {\"task\": {\"id\": \"mock_id\"}}\n        }\nE       AttributeError: 'dict' object has no attribute 'post'\n\ntests\\test_kling.py:144: AttributeError"
      },
      "teardown": {
        "outcome": "passed",
        "stderr": "Unhandled error in Deferred:\n\nTraceback (most recent call last):\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\internet\\defer.py\", line 1857, in _inlineCallbacks\n    result = context.run(gen.send, result)\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\kling\\kling.py\", line 25, in call_for_daily_check\n    response = await treq.get(url, headers=client.headers, cookies=client.cookies)\nbuiltins.TypeError: object MagicMock can't be used in 'await' expression\n\nUnhandled error in Deferred:\n\nTraceback (most recent call last):\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\internet\\defer.py\", line 1857, in _inlineCallbacks\n    result = context.run(gen.send, result)\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\tests\\test_kling.py\", line 95, in test_fetch_metadata\n    result, status = yield base_gen.fetch_metadata(\"mock_task_id\")\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\kling\\kling.py\", line 139, in fetch_metadata\n    response = self.session.get(url)\nbuiltins.AttributeError: 'BaseGen' object has no attribute 'session'\n\nUnhandled error in Deferred:\n\nTraceback (most recent call last):\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\internet\\defer.py\", line 1857, in _inlineCallbacks\n    result = context.run(gen.send, result)\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\tests\\test_kling.py\", line 132, in test_get_content\n    result = yield method(\"mock_prompt\")\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\kling\\kling.py\", line 412, in get_images\n    self.session.headers[\"user-agent\"] = ua.random\nbuiltins.AttributeError: 'ImageGen' object has no attribute 'session'\n\nUnhandled error in Deferred:\n\nTraceback (most recent call last):\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\internet\\defer.py\", line 1857, in _inlineCallbacks\n    result = context.run(gen.send, result)\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\tests\\test_kling.py\", line 132, in test_get_content\n    result = yield method(\"mock_prompt\")\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\kling\\kling.py\", line 263, in get_video\n    self.session.headers[\"user-agent\"] = ua.random\nbuiltins.AttributeError: 'VideoGen' object has no attribute 'session'\n\n"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_save_content[VideoGen-save_video]",
      "lineno": 136,
      "outcome": "failed",
      "keywords": [
        "test_save_content[VideoGen-save_video]",
        "parametrize",
        "__wrapped__",
        "patchings",
        "pytestmark",
        "VideoGen-save_video",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__treq",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\tests\\test_kling.py",
          "lineno": 144,
          "message": "AttributeError: 'dict' object has no attribute 'post'"
        },
        "traceback": [
          {
            "path": "tests\\test_kling.py",
            "lineno": 144,
            "message": "AttributeError"
          }
        ],
        "longrepr": "mock_mkdir = <MagicMock name='mkdir' id='1619864452176'>\nmock_exists = <MagicMock name='exists' id='1619864146512'>\ngen_class = <class 'kling.kling.VideoGen'>, method_name = 'save_video'\nmock_session = {'get': <MagicMock name='get' id='1619864442192'>, 'post': <MagicMock name='post' id='1619864444048'>}\n\n    @pytest.mark.parametrize(\n        \"gen_class,method_name\", [(ImageGen, \"save_images\"), (VideoGen, \"save_video\")]\n    )\n    @patch(\"os.path.exists\", return_value=False)\n    @patch(\"os.mkdir\")\n    def test_save_content(mock_mkdir, mock_exists, gen_class, method_name, mock_session):\n        gen = gen_class(\"mock_cookie\")\n>       mock_session.post.return_value.json.return_value = {\n        ^^^^^^^^^^^^^^^^^\n            \"data\": {\"task\": {\"id\": \"mock_id\"}}\n        }\nE       AttributeError: 'dict' object has no attribute 'post'\n\ntests\\test_kling.py:144: AttributeError"
      },
      "teardown": {
        "outcome": "passed",
        "stderr": "Unhandled error in Deferred:\n\nTraceback (most recent call last):\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\internet\\defer.py\", line 1857, in _inlineCallbacks\n    result = context.run(gen.send, result)\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\kling\\kling.py\", line 25, in call_for_daily_check\n    response = await treq.get(url, headers=client.headers, cookies=client.cookies)\nbuiltins.TypeError: object MagicMock can't be used in 'await' expression\n\n"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_call_for_daily_check",
      "lineno": 159,
      "outcome": "failed",
      "keywords": [
        "test_call_for_daily_check",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__treq",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\tests\\test_kling.py",
          "lineno": 166,
          "message": "assert <coroutine object call_for_daily_check at 0x00000179276A0AE0> == True"
        },
        "traceback": [
          {
            "path": "tests\\test_kling.py",
            "lineno": 166,
            "message": "AssertionError"
          }
        ],
        "longrepr": "def test_call_for_daily_check():\n        mock_session = MagicMock()\n        mock_session.get.return_value.ok = True\n        mock_session.get.return_value.json.return_value = {\"status\": \"success\"}\n    \n        result = call_for_daily_check(mock_session, True)\n>       assert result == True\nE       assert <coroutine object call_for_daily_check at 0x00000179276A0AE0> == True\n\ntests\\test_kling.py:166: AssertionError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_video_gen_get_video",
      "lineno": 172,
      "outcome": "failed",
      "keywords": [
        "test_video_gen_get_video",
        "__wrapped__",
        "patchings",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__treq",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\tests\\test_kling.py",
          "lineno": 176,
          "message": "AttributeError: 'dict' object has no attribute 'post'"
        },
        "traceback": [
          {
            "path": "tests\\test_kling.py",
            "lineno": 176,
            "message": "AttributeError"
          }
        ],
        "stderr": "Unhandled error in Deferred:\n\nTraceback (most recent call last):\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\internet\\defer.py\", line 1857, in _inlineCallbacks\n    result = context.run(gen.send, result)\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\kling\\kling.py\", line 25, in call_for_daily_check\n    response = await treq.get(url, headers=client.headers, cookies=client.cookies)\nbuiltins.TypeError: object MagicMock can't be used in 'await' expression\n\n",
        "longrepr": "mock_uploader = <AsyncMock name='image_uploader' id='1619864011344'>\nmock_file = <MagicMock name='open' id='1619843627472'>\nvideo_gen = <kling.kling.VideoGen object at 0x00000179277363D0>\nmock_session = {'get': <MagicMock name='get' id='1619864486928'>, 'post': <MagicMock name='post' id='1619864501008'>}\n\n    @patch(\"builtins.open\", new_callable=mock_open, read_data=b\"mock_image_data\")\n    @patch.object(VideoGen, \"image_uploader\", return_value=\"mock_image_url\")\n    def test_video_gen_get_video(mock_uploader, mock_file, video_gen, mock_session):\n>       mock_session.post.return_value.json.return_value = {\n        ^^^^^^^^^^^^^^^^^\n            \"data\": {\"task\": {\"id\": \"mock_id\"}}\n        }\nE       AttributeError: 'dict' object has no attribute 'post'\n\ntests\\test_kling.py:176: AttributeError"
      },
      "teardown": {
        "outcome": "passed",
        "stderr": "Unhandled error in Deferred:\n\nTraceback (most recent call last):\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\internet\\defer.py\", line 1853, in _inlineCallbacks\n    result = context.run(\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\python\\failure.py\", line 467, in throwExceptionIntoGenerator\n    return g.throw(self.value.with_traceback(self.tb))\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\tests\\test_kling.py\", line 86, in test_image_uploader\n    result = yield image_gen.image_uploader(\"mock_image_path\")\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\internet\\defer.py\", line 1857, in _inlineCallbacks\n    result = context.run(gen.send, result)\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\kling\\kling.py\", line 102, in image_uploader\n    token_req = await treq.get(upload_url, headers=self.headers, cookies=self.cookies)\nbuiltins.TypeError: object MagicMock can't be used in 'await' expression\n\n"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_video_gen_save_video",
      "lineno": 195,
      "outcome": "failed",
      "keywords": [
        "test_video_gen_save_video",
        "__wrapped__",
        "patchings",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__treq",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\tests\\test_kling.py",
          "lineno": 202,
          "message": "AttributeError: 'dict' object has no attribute 'post'"
        },
        "traceback": [
          {
            "path": "tests\\test_kling.py",
            "lineno": 202,
            "message": "AttributeError"
          }
        ],
        "stderr": "Unhandled error in Deferred:\n\nTraceback (most recent call last):\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\internet\\defer.py\", line 1857, in _inlineCallbacks\n    result = context.run(gen.send, result)\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\kling\\kling.py\", line 25, in call_for_daily_check\n    response = await treq.get(url, headers=client.headers, cookies=client.cookies)\nbuiltins.TypeError: object MagicMock can't be used in 'await' expression\n\n",
        "longrepr": "mock_file = <MagicMock name='open' id='1619864537040'>\nmock_mkdir = <MagicMock name='mkdir' id='1619864562640'>\nmock_exists = <MagicMock name='exists' id='1619864566992'>\nvideo_gen = <kling.kling.VideoGen object at 0x0000017927737F10>\nmock_session = {'get': <MagicMock name='get' id='1619864441104'>, 'post': <MagicMock name='post' id='1619868577104'>}\n\n    @patch(\"os.path.exists\", return_value=False)\n    @patch(\"os.mkdir\")\n    @patch(\"builtins.open\", new_callable=mock_open)\n    def test_video_gen_save_video(\n        mock_file, mock_mkdir, mock_exists, video_gen, mock_session\n    ):\n>       mock_session.post.return_value.json.return_value = {\n        ^^^^^^^^^^^^^^^^^\n            \"data\": {\"task\": {\"id\": \"mock_id\"}}\n        }\nE       AttributeError: 'dict' object has no attribute 'post'\n\ntests\\test_kling.py:202: AttributeError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_image_gen_get_images",
      "lineno": 217,
      "outcome": "failed",
      "keywords": [
        "test_image_gen_get_images",
        "__wrapped__",
        "patchings",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__treq",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\tests\\test_kling.py",
          "lineno": 221,
          "message": "AttributeError: 'dict' object has no attribute 'post'"
        },
        "traceback": [
          {
            "path": "tests\\test_kling.py",
            "lineno": 221,
            "message": "AttributeError"
          }
        ],
        "stderr": "Unhandled error in Deferred:\n\nTraceback (most recent call last):\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\internet\\defer.py\", line 1857, in _inlineCallbacks\n    result = context.run(gen.send, result)\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\kling\\kling.py\", line 25, in call_for_daily_check\n    response = await treq.get(url, headers=client.headers, cookies=client.cookies)\nbuiltins.TypeError: object MagicMock can't be used in 'await' expression\n\n",
        "longrepr": "mock_uploader = <AsyncMock name='image_uploader' id='1619862738512'>\nmock_file = <MagicMock name='open' id='1619862745552'>\nimage_gen = <kling.kling.ImageGen object at 0x0000017927717990>\nmock_session = {'get': <MagicMock name='get' id='1619864405328'>, 'post': <MagicMock name='post' id='1619864414992'>}\n\n    @patch(\"builtins.open\", new_callable=mock_open, read_data=b\"mock_image_data\")\n    @patch.object(ImageGen, \"image_uploader\", return_value=\"mock_image_url\")\n    def test_image_gen_get_images(mock_uploader, mock_file, image_gen, mock_session):\n>       mock_session.post.return_value.json.return_value = {\n        ^^^^^^^^^^^^^^^^^\n            \"data\": {\"task\": {\"id\": \"mock_id\"}}\n        }\nE       AttributeError: 'dict' object has no attribute 'post'\n\ntests\\test_kling.py:221: AttributeError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_image_gen_save_images",
      "lineno": 237,
      "outcome": "failed",
      "keywords": [
        "test_image_gen_save_images",
        "__wrapped__",
        "patchings",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__treq",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\tests\\test_kling.py",
          "lineno": 245,
          "message": "AttributeError: 'dict' object has no attribute 'post'"
        },
        "traceback": [
          {
            "path": "tests\\test_kling.py",
            "lineno": 245,
            "message": "AttributeError"
          }
        ],
        "stderr": "Unhandled error in Deferred:\n\nTraceback (most recent call last):\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\internet\\defer.py\", line 1857, in _inlineCallbacks\n    result = context.run(gen.send, result)\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\kling\\kling.py\", line 25, in call_for_daily_check\n    response = await treq.get(url, headers=client.headers, cookies=client.cookies)\nbuiltins.TypeError: object MagicMock can't be used in 'await' expression\n\n",
        "longrepr": "mock_thread = <MagicMock name='Thread' id='1619864574928'>\nmock_file = <MagicMock name='open' id='1619864568144'>\nmock_mkdir = <MagicMock name='mkdir' id='1619863797712'>\nmock_exists = <MagicMock name='exists' id='1619864107856'>\nimage_gen = <kling.kling.ImageGen object at 0x000001792773BD10>\nmock_session = {'get': <MagicMock name='get' id='1619864414608'>, 'post': <MagicMock name='post' id='1619864566544'>}\n\n    @patch(\"os.path.exists\", return_value=False)\n    @patch(\"os.mkdir\")\n    @patch(\"builtins.open\", new_callable=mock_open)\n    @patch(\"threading.Thread\")\n    def test_image_gen_save_images(\n        mock_thread, mock_file, mock_mkdir, mock_exists, image_gen, mock_session\n    ):\n>       mock_session.post.return_value.json.return_value = {\n        ^^^^^^^^^^^^^^^^^\n            \"data\": {\"task\": {\"id\": \"mock_id\"}}\n        }\nE       AttributeError: 'dict' object has no attribute 'post'\n\ntests\\test_kling.py:245: AttributeError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_extend_video_completed",
      "lineno": 260,
      "outcome": "failed",
      "keywords": [
        "test_extend_video_completed",
        "__wrapped__",
        "patchings",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__treq",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\kling\\kling.py",
          "lineno": 209,
          "message": "AttributeError: 'VideoGen' object has no attribute 'session'"
        },
        "traceback": [
          {
            "path": "tests\\test_kling.py",
            "lineno": 268,
            "message": ""
          },
          {
            "path": "kling\\kling.py",
            "lineno": 206,
            "message": "in extend_video"
          },
          {
            "path": "kling\\kling.py",
            "lineno": 209,
            "message": "AttributeError"
          }
        ],
        "longrepr": "mock_fetch_metadata = <MagicMock name='fetch_metadata' id='1619863041040'>\nvideo_gen = <kling.kling.VideoGen object at 0x0000017927580F10>\n\n    @patch.object(VideoGen, \"fetch_metadata\")\n    def test_extend_video_completed(mock_fetch_metadata, video_gen):\n        mock_fetch_metadata.return_value = (\n            {\"works\": [{\"resource\": {\"resource\": \"mock_resource\"}}]},\n            TaskStatus.COMPLETED,\n        )\n    \n>       result = video_gen.extend_video(123, \"mock_prompt\")\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\ntests\\test_kling.py:268: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\nkling\\kling.py:206: in extend_video\n    return self._get_video_with_payload(payload)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <kling.kling.VideoGen object at 0x0000017927580F10>\npayload = {'arguments': [{'name': 'prompt', 'value': ''}, {'name': 'biz', 'value': 'klingai'}, {'name': '__initialType', 'value'...puts': [{'fromWorkId': None, 'inputType': 'URL', 'name': 'input', 'url': 'mock_resource'}], 'type': 'm2v_extend_video'}\n\n    def _get_video_with_payload(self, payload: dict) -> list:\n>       response = self.session.post(\n                   ^^^^^^^^^^^^\n            self.submit_url,\n            json=payload,\n        )\nE       AttributeError: 'VideoGen' object has no attribute 'session'\n\nkling\\kling.py:209: AttributeError"
      },
      "teardown": {
        "outcome": "passed",
        "stderr": "Unhandled error in Deferred:\n\nTraceback (most recent call last):\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\internet\\defer.py\", line 1857, in _inlineCallbacks\n    result = context.run(gen.send, result)\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\kling\\kling.py\", line 25, in call_for_daily_check\n    response = await treq.get(url, headers=client.headers, cookies=client.cookies)\nbuiltins.TypeError: object MagicMock can't be used in 'await' expression\n\n"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_extend_video_pending",
      "lineno": 272,
      "outcome": "passed",
      "keywords": [
        "test_extend_video_pending",
        "__wrapped__",
        "patchings",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__treq",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_extend_video_failed",
      "lineno": 283,
      "outcome": "passed",
      "keywords": [
        "test_extend_video_failed",
        "__wrapped__",
        "patchings",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__treq",
        ""
      ],
      "setup": {
        "outcome": "passed",
        "stderr": "Unhandled error in Deferred:\n\nTraceback (most recent call last):\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\internet\\defer.py\", line 1857, in _inlineCallbacks\n    result = context.run(gen.send, result)\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\kling\\kling.py\", line 25, in call_for_daily_check\n    response = await treq.get(url, headers=client.headers, cookies=client.cookies)\nbuiltins.TypeError: object MagicMock can't be used in 'await' expression\n\n"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_kling.py::test_extend_video_no_works",
      "lineno": 294,
      "outcome": "passed",
      "keywords": [
        "test_extend_video_no_works",
        "__wrapped__",
        "patchings",
        "test_kling.py",
        "tests",
        "yihong0618@klingcreator__e567c6a1__requests__treq",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed",
        "stdout": "No Video found.\n",
        "stderr": "Unhandled error in Deferred:\n\nTraceback (most recent call last):\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\internet\\defer.py\", line 1857, in _inlineCallbacks\n    result = context.run(gen.send, result)\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\kling\\kling.py\", line 25, in call_for_daily_check\n    response = await treq.get(url, headers=client.headers, cookies=client.cookies)\nbuiltins.TypeError: object MagicMock can't be used in 'await' expression\n\nUnhandled error in Deferred:\n\nTraceback (most recent call last):\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\.venv\\Lib\\site-packages\\twisted\\internet\\defer.py\", line 1857, in _inlineCallbacks\n    result = context.run(gen.send, result)\n  File \"D:\\repos\\yihong0618@klingcreator__e567c6a1__requests__treq\\kling\\kling.py\", line 25, in call_for_daily_check\n    response = await treq.get(url, headers=client.headers, cookies=client.cookies)\nbuiltins.TypeError: object MagicMock can't be used in 'await' expression\n\n"
      },
      "teardown": {
        "outcome": "passed"
      }
    }
  ]
}
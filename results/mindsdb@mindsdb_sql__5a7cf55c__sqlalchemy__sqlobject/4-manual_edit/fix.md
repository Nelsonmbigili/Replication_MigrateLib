The application logic was very complex, could not understand 
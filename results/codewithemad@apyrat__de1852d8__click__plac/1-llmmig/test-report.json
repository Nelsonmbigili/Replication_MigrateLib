{
  "exitcode": 1,
  "summary": {
    "failed": 4,
    "passed": 4,
    "total": 8,
    "collected": 8
  },
  "collectors": [
    {
      "nodeid": "",
      "outcome": "passed",
      "result": [
        {
          "nodeid": ".",
          "type": "Dir"
        }
      ]
    },
    {
      "nodeid": "apyrat",
      "outcome": "passed",
      "result": []
    },
    {
      "nodeid": "apyrat.egg-info",
      "outcome": "passed",
      "result": []
    },
    {
      "nodeid": "tests/cli_test.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "tests/cli_test.py::test_main_download_video_with_quality",
          "type": "Function",
          "lineno": 6
        },
        {
          "nodeid": "tests/cli_test.py::test_main_download_video_without_quality",
          "type": "Function",
          "lineno": 23
        },
        {
          "nodeid": "tests/cli_test.py::test_get_quality_available",
          "type": "Function",
          "lineno": 33
        },
        {
          "nodeid": "tests/cli_test.py::test_get_quality_not_available",
          "type": "Function",
          "lineno": 40
        },
        {
          "nodeid": "tests/cli_test.py::test_get_quality_not_available_no_confirm",
          "type": "Function",
          "lineno": 47
        }
      ]
    },
    {
      "nodeid": "tests/test_apyrat.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "tests/test_apyrat.py::test_get_available_videos_single_video",
          "type": "Function",
          "lineno": 4
        },
        {
          "nodeid": "tests/test_apyrat.py::test_default_quality",
          "type": "Function",
          "lineno": 23
        },
        {
          "nodeid": "tests/test_apyrat.py::test_download_when_file_exists",
          "type": "Function",
          "lineno": 29
        }
      ]
    },
    {
      "nodeid": "tests",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "tests/cli_test.py",
          "type": "Module"
        },
        {
          "nodeid": "tests/test_apyrat.py",
          "type": "Module"
        }
      ]
    },
    {
      "nodeid": ".",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "apyrat",
          "type": "Package"
        },
        {
          "nodeid": "apyrat.egg-info",
          "type": "Dir"
        },
        {
          "nodeid": "tests",
          "type": "Package"
        }
      ]
    }
  ],
  "tests": [
    {
      "nodeid": "tests/cli_test.py::test_main_download_video_with_quality",
      "lineno": 6,
      "outcome": "failed",
      "keywords": [
        "test_main_download_video_with_quality",
        "cli_test.py",
        "tests",
        "codewithemad@apyrat__de1852d8__click__plac",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\codewithemad@apyrat__de1852d8__click__plac\\tests\\cli_test.py",
          "lineno": 20,
          "message": "assert None == 0"
        },
        "traceback": [
          {
            "path": "tests\\cli_test.py",
            "lineno": 20,
            "message": "AssertionError"
          }
        ],
        "stdout": "\u062f\u0631\u06a9 \u0645\u0641\u0627\u0647\u06cc\u0645 \u0634\u0628\u06a9\u0647 \u0628\u0627 \u062c\u0627\u062f\u06cc \u06f0\u06f4 - \u0622\u06cc \u067e\u06cc\u060c \u0646\u062a \u0645\u0633\u06a9 \u0648 \u0633\u0627\u0628&zwnj;\u0646\u062a\u06cc\u0646\u06af\nhttps://as10.cdn.asset.aparat.com/aparat-video/f8c9c5d68b99c8312f986e6a09bd365024968472-360p.mp4?wmsAuthSign=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbiI6ImY5NzliZGRkNzlmOWVkMzBkNTg0NjU2N2E4OWM1MDdjIiwiZXhwIjoxNzQ1MzUyMDEwLCJpc3MiOiJTYWJhIElkZWEgR1NJRyJ9.tUOKR3dpa5Efh7YgmS-8GmaUyJw3Y2eo6r4uFyHZ8bo\n",
        "longrepr": "def test_main_download_video_with_quality():\n        with patch(\n            \"apyrat.apyrat.Downloader._get_available_qualities\",\n            return_value=[\"480\", \"720\", \"1080\"],\n        ) as mock_qualities:\n            result = plac.call(\n                main,\n                [\n                    \"https://www.aparat.com/v/qur3I\",\n                    \"-q\",\n                    \"720\",\n                ],\n            )\n>       assert result == 0\nE       assert None == 0\n\ntests\\cli_test.py:20: AssertionError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/cli_test.py::test_main_download_video_without_quality",
      "lineno": 23,
      "outcome": "failed",
      "keywords": [
        "test_main_download_video_without_quality",
        "cli_test.py",
        "tests",
        "codewithemad@apyrat__de1852d8__click__plac",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "C:\\Users\\Mohay\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\urllib\\request.py",
          "lineno": 276,
          "message": "urllib.error.ContentTooShortError: <urlopen error retrieval incomplete: got only 2954137 out of 40829697 bytes>"
        },
        "traceback": [
          {
            "path": "tests\\cli_test.py",
            "lineno": 30,
            "message": ""
          },
          {
            "path": ".venv\\Lib\\site-packages\\plac_core.py",
            "lineno": 436,
            "message": "in call"
          },
          {
            "path": ".venv\\Lib\\site-packages\\plac_core.py",
            "lineno": 287,
            "message": "in consume"
          },
          {
            "path": "apyrat\\cli.py",
            "lineno": 71,
            "message": "in main"
          },
          {
            "path": "apyrat\\apyrat.py",
            "lineno": 141,
            "message": "in download"
          },
          {
            "path": "apyrat\\apyrat.py",
            "lineno": 156,
            "message": "in _download_video"
          },
          {
            "path": ".venv\\Lib\\site-packages\\wget.py",
            "lineno": 526,
            "message": "in download"
          },
          {
            "path": "C:\\Users\\Mohay\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\urllib\\request.py",
            "lineno": 276,
            "message": "ContentTooShortError"
          }
        ],
        "stdout": "\u062f\u0631\u06a9 \u0645\u0641\u0627\u0647\u06cc\u0645 \u0634\u0628\u06a9\u0647 \u0628\u0627 \u062c\u0627\u062f\u06cc \u06f0\u06f4 - \u0622\u06cc \u067e\u06cc\u060c \u0646\u062a \u0645\u0633\u06a9 \u0648 \u0633\u0627\u0628&zwnj;\u0646\u062a\u06cc\u0646\u06af\nhttps://hw13.cdn.asset.aparat.com/aparat-video/f8c9c5d68b99c8312f986e6a09bd365024968472-360p.mp4?wmsAuthSign=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbiI6IjNlNmExYTAyZjhmYWYwZjM0MDIxMWMyMTI0MjgxNTBhIiwiZXhwIjoxNzQ1MzUyMDgwLCJpc3MiOiJTYWJhIElkZWEgR1NJRyJ9.a176rC-Ca9BGfKz6PbLN5U5jaqPsfWJ5vMBY4pP9pnA\n",
        "longrepr": "def test_main_download_video_without_quality():\n        with patch(\n            \"apyrat.apyrat.Downloader._get_available_qualities\",\n            return_value=[\"480\", \"720\", \"1080\"],\n        ):\n            # Simulate user input by passing the quality directly as an argument\n>           result = plac.call(main, [\"https://www.aparat.com/v/qur3I\", \"-q\", \"720\"])\n\ntests\\cli_test.py:30: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n.venv\\Lib\\site-packages\\plac_core.py:436: in call\n    cmd, result = parser.consume(arglist)\n.venv\\Lib\\site-packages\\plac_core.py:287: in consume\n    return cmd, self.func(*(args + varargs + extraopts), **kwargs)\napyrat\\cli.py:71: in main\n    downloader.download(quality_choice)\napyrat\\apyrat.py:141: in download\n    self._download_video(video)\napyrat\\apyrat.py:156: in _download_video\n    wget.download(url, out=output_file)\n.venv\\Lib\\site-packages\\wget.py:526: in download\n    (tmpfile, headers) = ulib.urlretrieve(binurl, tmpfile, callback)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nurl = 'https://hw13.cdn.asset.aparat.com/aparat-video/f8c9c5d68b99c8312f986e6a09bd365024968472-360p.mp4?wmsAuthSign=eyJhbGci...IxMWMyMTI0MjgxNTBhIiwiZXhwIjoxNzQ1MzUyMDgwLCJpc3MiOiJTYWJhIElkZWEgR1NJRyJ9.a176rC-Ca9BGfKz6PbLN5U5jaqPsfWJ5vMBY4pP9pnA'\nfilename = 'D:\\\\repos\\\\codewithemad@apyrat__de1852d8__click__plac\\\\8f4943de046ac2ecdc06a5d9fc8472dc\u062f\u0631\u06a9 \u0645\u0641\u0627\u0647\u06cc\u0645 \u0634\u0628\u06a9\u0647 \u0628\u0627 \u062c\u0627\u062f\u06cc \u06f0\u06f4 - \u0622\u06cc \u067e\u06cc\u060c \u0646\u062a \u0645\u0633\u06a9 \u0648 \u0633\u0627\u0628&zwnj;\u0646\u062a\u06cc\u0646\u06af.mp4rn18v3zr.tmp'\nreporthook = <function download.<locals>.callback_charged at 0x000001ED22DCA200>\ndata = None\n\n    def urlretrieve(url, filename=None, reporthook=None, data=None):\n        \"\"\"\n        Retrieve a URL into a temporary location on disk.\n    \n        Requires a URL argument. If a filename is passed, it is used as\n        the temporary file location. The reporthook argument should be\n        a callable that accepts a block number, a read size, and the\n        total file size of the URL target. The data argument should be\n        valid URL encoded data.\n    \n        If a filename is passed and the URL points to a local resource,\n        the result is a copy from local file to new file.\n    \n        Returns a tuple containing the path to the newly created\n        data file as well as the resulting HTTPMessage object.\n        \"\"\"\n        url_type, path = _splittype(url)\n    \n        with contextlib.closing(urlopen(url, data)) as fp:\n            headers = fp.info()\n    \n            # Just return the local path and the \"headers\" for file://\n            # URLs. No sense in performing a copy unless requested.\n            if url_type == \"file\" and not filename:\n                return os.path.normpath(path), headers\n    \n            # Handle temporary file setup.\n            if filename:\n                tfp = open(filename, 'wb')\n            else:\n                tfp = tempfile.NamedTemporaryFile(delete=False)\n                filename = tfp.name\n                _url_tempfiles.append(filename)\n    \n            with tfp:\n                result = filename, headers\n                bs = 1024*8\n                size = -1\n                read = 0\n                blocknum = 0\n                if \"content-length\" in headers:\n                    size = int(headers[\"Content-Length\"])\n    \n                if reporthook:\n                    reporthook(blocknum, bs, size)\n    \n                while block := fp.read(bs):\n                    read += len(block)\n                    tfp.write(block)\n                    blocknum += 1\n                    if reporthook:\n                        reporthook(blocknum, bs, size)\n    \n        if size >= 0 and read < size:\n>           raise ContentTooShortError(\n                \"retrieval incomplete: got only %i out of %i bytes\"\n                % (read, size), result)\nE           urllib.error.ContentTooShortError: <urlopen error retrieval incomplete: got only 2954137 out of 40829697 bytes>\n\nC:\\Users\\Mohay\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\urllib\\request.py:276: ContentTooShortError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/cli_test.py::test_get_quality_available",
      "lineno": 33,
      "outcome": "passed",
      "keywords": [
        "test_get_quality_available",
        "cli_test.py",
        "tests",
        "codewithemad@apyrat__de1852d8__click__plac",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/cli_test.py::test_get_quality_not_available",
      "lineno": 40,
      "outcome": "failed",
      "keywords": [
        "test_get_quality_not_available",
        "cli_test.py",
        "tests",
        "codewithemad@apyrat__de1852d8__click__plac",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\codewithemad@apyrat__de1852d8__click__plac\\apyrat\\cli.py",
          "lineno": 22,
          "message": "NameError: name 'sys' is not defined. Did you forget to import 'sys'"
        },
        "traceback": [
          {
            "path": "tests\\cli_test.py",
            "lineno": 45,
            "message": ""
          },
          {
            "path": "apyrat\\cli.py",
            "lineno": 22,
            "message": "NameError"
          }
        ],
        "longrepr": "def test_get_quality_not_available():\n        downloader = Downloader(\"https://www.aparat.com/v/qur3I\")\n        downloader.qualities = [\"480\", \"720\", \"1080\"]\n        # Simulate user input by directly passing the quality\n>       assert get_quality(downloader, \"240\") == \"720\"\n\ntests\\cli_test.py:45: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\ndownloader = <apyrat.apyrat.Downloader object at 0x000001ED22E069C0>\nquality = '240'\n\n    def get_quality(downloader: Downloader, quality: VideoQuality):\n        \"\"\"\n        Prompt the user for video quality if not provided or invalid.\n        \"\"\"\n        if quality and quality not in downloader.qualities:\n>           print(f\"Quality {quality} is not available\", file=sys.stderr)\nE           NameError: name 'sys' is not defined. Did you forget to import 'sys'\n\napyrat\\cli.py:22: NameError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/cli_test.py::test_get_quality_not_available_no_confirm",
      "lineno": 47,
      "outcome": "failed",
      "keywords": [
        "test_get_quality_not_available_no_confirm",
        "cli_test.py",
        "tests",
        "codewithemad@apyrat__de1852d8__click__plac",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\codewithemad@apyrat__de1852d8__click__plac\\apyrat\\cli.py",
          "lineno": 22,
          "message": "NameError: name 'sys' is not defined. Did you forget to import 'sys'"
        },
        "traceback": [
          {
            "path": "tests\\cli_test.py",
            "lineno": 52,
            "message": ""
          },
          {
            "path": "apyrat\\cli.py",
            "lineno": 22,
            "message": "NameError"
          }
        ],
        "longrepr": "def test_get_quality_not_available_no_confirm():\n        downloader = Downloader(\"https://www.aparat.com/v/qur3I\")\n        downloader.qualities = [\"480\", \"720\", \"1080\"]\n        # Simulate user input by directly passing the quality\n>       assert get_quality(downloader, \"240\") == \"480\"\n\ntests\\cli_test.py:52: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\ndownloader = <apyrat.apyrat.Downloader object at 0x000001ED1F2AC980>\nquality = '240'\n\n    def get_quality(downloader: Downloader, quality: VideoQuality):\n        \"\"\"\n        Prompt the user for video quality if not provided or invalid.\n        \"\"\"\n        if quality and quality not in downloader.qualities:\n>           print(f\"Quality {quality} is not available\", file=sys.stderr)\nE           NameError: name 'sys' is not defined. Did you forget to import 'sys'\n\napyrat\\cli.py:22: NameError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_apyrat.py::test_get_available_videos_single_video",
      "lineno": 4,
      "outcome": "passed",
      "keywords": [
        "test_get_available_videos_single_video",
        "__wrapped__",
        "patchings",
        "test_apyrat.py",
        "tests",
        "codewithemad@apyrat__de1852d8__click__plac",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_apyrat.py::test_default_quality",
      "lineno": 23,
      "outcome": "passed",
      "keywords": [
        "test_default_quality",
        "test_apyrat.py",
        "tests",
        "codewithemad@apyrat__de1852d8__click__plac",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_apyrat.py::test_download_when_file_exists",
      "lineno": 29,
      "outcome": "passed",
      "keywords": [
        "test_download_when_file_exists",
        "__wrapped__",
        "patchings",
        "test_apyrat.py",
        "tests",
        "codewithemad@apyrat__de1852d8__click__plac",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed",
        "stdout": "My Video Title\nhttps://link-to-video\n"
      },
      "teardown": {
        "outcome": "passed"
      }
    }
  ]
}
{
  "exitcode": 1,
  "summary": {
    "failed": 2,
    "passed": 14,
    "total": 16,
    "collected": 16
  },
  "collectors": [
    {
      "nodeid": "",
      "outcome": "passed",
      "result": [
        {
          "nodeid": ".",
          "type": "Dir"
        }
      ]
    },
    {
      "nodeid": "encrypt_decrypt_fields/orm",
      "outcome": "passed",
      "result": []
    },
    {
      "nodeid": "encrypt_decrypt_fields/services",
      "outcome": "passed",
      "result": []
    },
    {
      "nodeid": "encrypt_decrypt_fields/tests/test_crypto.py::TestCrypt",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "encrypt_decrypt_fields/tests/test_crypto.py::TestCrypt::test_key_is_str",
          "type": "Function",
          "lineno": 6
        },
        {
          "nodeid": "encrypt_decrypt_fields/tests/test_crypto.py::TestCrypt::test_key_not_str",
          "type": "Function",
          "lineno": 13
        },
        {
          "nodeid": "encrypt_decrypt_fields/tests/test_crypto.py::TestCrypt::test_encrypt_successfully",
          "type": "Function",
          "lineno": 19
        },
        {
          "nodeid": "encrypt_decrypt_fields/tests/test_crypto.py::TestCrypt::test_encrypt_not_successfully[int]",
          "type": "Function",
          "lineno": 25
        },
        {
          "nodeid": "encrypt_decrypt_fields/tests/test_crypto.py::TestCrypt::test_encrypt_not_successfully[tuple]",
          "type": "Function",
          "lineno": 25
        },
        {
          "nodeid": "encrypt_decrypt_fields/tests/test_crypto.py::TestCrypt::test_encrypt_not_successfully[list]",
          "type": "Function",
          "lineno": 25
        },
        {
          "nodeid": "encrypt_decrypt_fields/tests/test_crypto.py::TestCrypt::test_encrypt_not_successfully[dict]",
          "type": "Function",
          "lineno": 25
        },
        {
          "nodeid": "encrypt_decrypt_fields/tests/test_crypto.py::TestCrypt::test_decrypt_empty_value",
          "type": "Function",
          "lineno": 30
        },
        {
          "nodeid": "encrypt_decrypt_fields/tests/test_crypto.py::TestCrypt::test_decrypt_successfully",
          "type": "Function",
          "lineno": 35
        }
      ]
    },
    {
      "nodeid": "encrypt_decrypt_fields/tests/test_crypto.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "encrypt_decrypt_fields/tests/test_crypto.py::TestCrypt",
          "type": "Class"
        }
      ]
    },
    {
      "nodeid": "encrypt_decrypt_fields/tests/test_django_field.py::TestDjangoEncryptField",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "encrypt_decrypt_fields/tests/test_django_field.py::TestDjangoEncryptField::test_passed_empty_value",
          "type": "Function",
          "lineno": 14
        },
        {
          "nodeid": "encrypt_decrypt_fields/tests/test_django_field.py::TestDjangoEncryptField::test_passed_byte_value",
          "type": "Function",
          "lineno": 20
        },
        {
          "nodeid": "encrypt_decrypt_fields/tests/test_django_field.py::TestDjangoEncryptField::test_passed_memoryview_value",
          "type": "Function",
          "lineno": 26
        },
        {
          "nodeid": "encrypt_decrypt_fields/tests/test_django_field.py::TestDjangoEncryptField::test_passed_string_value",
          "type": "Function",
          "lineno": 32
        },
        {
          "nodeid": "encrypt_decrypt_fields/tests/test_django_field.py::TestDjangoEncryptField::test_passed_any_value[1-int]",
          "type": "Function",
          "lineno": 42
        },
        {
          "nodeid": "encrypt_decrypt_fields/tests/test_django_field.py::TestDjangoEncryptField::test_passed_any_value[passed1-dict]",
          "type": "Function",
          "lineno": 42
        },
        {
          "nodeid": "encrypt_decrypt_fields/tests/test_django_field.py::TestDjangoEncryptField::test_passed_any_value[passed2-list]",
          "type": "Function",
          "lineno": 42
        }
      ]
    },
    {
      "nodeid": "encrypt_decrypt_fields/tests/test_django_field.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "encrypt_decrypt_fields/tests/test_django_field.py::TestDjangoEncryptField",
          "type": "Class"
        }
      ]
    },
    {
      "nodeid": "encrypt_decrypt_fields/tests",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "encrypt_decrypt_fields/tests/test_crypto.py",
          "type": "Module"
        },
        {
          "nodeid": "encrypt_decrypt_fields/tests/test_django_field.py",
          "type": "Module"
        }
      ]
    },
    {
      "nodeid": "encrypt_decrypt_fields",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "encrypt_decrypt_fields/orm",
          "type": "Package"
        },
        {
          "nodeid": "encrypt_decrypt_fields/services",
          "type": "Package"
        },
        {
          "nodeid": "encrypt_decrypt_fields/tests",
          "type": "Package"
        }
      ]
    },
    {
      "nodeid": ".",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "encrypt_decrypt_fields",
          "type": "Package"
        }
      ]
    }
  ],
  "tests": [
    {
      "nodeid": "encrypt_decrypt_fields/tests/test_crypto.py::TestCrypt::test_key_is_str",
      "lineno": 6,
      "outcome": "failed",
      "keywords": [
        "test_key_is_str",
        "TestCrypt",
        "test_crypto.py",
        "tests",
        "encrypt_decrypt_fields",
        "alpden550@encrypt-decrypt-fields__a0029320__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\alpden550@encrypt-decrypt-fields__a0029320__cryptography__pycryptodome\\encrypt_decrypt_fields\\tests\\test_crypto.py",
          "lineno": 12,
          "message": "assert b\"+\\xb8\\rS{\\x...e9{\\xf5'\\xa2[\" == b'K7gNU3sdo-O...2ol_pe_Unols='\n  \n  At index 0 diff: b'+' != b'K'\n  Use -v to get more diff"
        },
        "traceback": [
          {
            "path": "encrypt_decrypt_fields\\tests\\test_crypto.py",
            "lineno": 12,
            "message": "AssertionError"
          }
        ],
        "longrepr": "self = <encrypt_decrypt_fields.tests.test_crypto.TestCrypt object at 0x0000014B654B8290>\n\n    def test_key_is_str(self):\n        crypto = Crypto(\"secret\")\n        key = crypto.get_key()\n    \n        assert isinstance(key, bytes)\n>       assert key == b\"K7gNU3sdo-OL0wNhqoVWhr3g6s1xYv72ol_pe_Unols=\"\nE       assert b\"+\\xb8\\rS{\\x...e9{\\xf5'\\xa2[\" == b'K7gNU3sdo-O...2ol_pe_Unols='\nE         \nE         At index 0 diff: b'+' != b'K'\nE         Use -v to get more diff\n\nencrypt_decrypt_fields\\tests\\test_crypto.py:12: AssertionError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "encrypt_decrypt_fields/tests/test_crypto.py::TestCrypt::test_key_not_str",
      "lineno": 13,
      "outcome": "passed",
      "keywords": [
        "test_key_not_str",
        "TestCrypt",
        "test_crypto.py",
        "tests",
        "encrypt_decrypt_fields",
        "alpden550@encrypt-decrypt-fields__a0029320__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "encrypt_decrypt_fields/tests/test_crypto.py::TestCrypt::test_encrypt_successfully",
      "lineno": 19,
      "outcome": "passed",
      "keywords": [
        "test_encrypt_successfully",
        "TestCrypt",
        "test_crypto.py",
        "tests",
        "encrypt_decrypt_fields",
        "alpden550@encrypt-decrypt-fields__a0029320__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "encrypt_decrypt_fields/tests/test_crypto.py::TestCrypt::test_encrypt_not_successfully[int]",
      "lineno": 25,
      "outcome": "passed",
      "keywords": [
        "test_encrypt_not_successfully[int]",
        "parametrize",
        "pytestmark",
        "int",
        "TestCrypt",
        "test_crypto.py",
        "tests",
        "encrypt_decrypt_fields",
        "alpden550@encrypt-decrypt-fields__a0029320__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "encrypt_decrypt_fields/tests/test_crypto.py::TestCrypt::test_encrypt_not_successfully[tuple]",
      "lineno": 25,
      "outcome": "passed",
      "keywords": [
        "test_encrypt_not_successfully[tuple]",
        "parametrize",
        "pytestmark",
        "tuple",
        "TestCrypt",
        "test_crypto.py",
        "tests",
        "encrypt_decrypt_fields",
        "alpden550@encrypt-decrypt-fields__a0029320__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "encrypt_decrypt_fields/tests/test_crypto.py::TestCrypt::test_encrypt_not_successfully[list]",
      "lineno": 25,
      "outcome": "passed",
      "keywords": [
        "test_encrypt_not_successfully[list]",
        "parametrize",
        "pytestmark",
        "list",
        "TestCrypt",
        "test_crypto.py",
        "tests",
        "encrypt_decrypt_fields",
        "alpden550@encrypt-decrypt-fields__a0029320__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "encrypt_decrypt_fields/tests/test_crypto.py::TestCrypt::test_encrypt_not_successfully[dict]",
      "lineno": 25,
      "outcome": "passed",
      "keywords": [
        "test_encrypt_not_successfully[dict]",
        "parametrize",
        "pytestmark",
        "dict",
        "TestCrypt",
        "test_crypto.py",
        "tests",
        "encrypt_decrypt_fields",
        "alpden550@encrypt-decrypt-fields__a0029320__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "encrypt_decrypt_fields/tests/test_crypto.py::TestCrypt::test_decrypt_empty_value",
      "lineno": 30,
      "outcome": "passed",
      "keywords": [
        "test_decrypt_empty_value",
        "TestCrypt",
        "test_crypto.py",
        "tests",
        "encrypt_decrypt_fields",
        "alpden550@encrypt-decrypt-fields__a0029320__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "encrypt_decrypt_fields/tests/test_crypto.py::TestCrypt::test_decrypt_successfully",
      "lineno": 35,
      "outcome": "passed",
      "keywords": [
        "test_decrypt_successfully",
        "TestCrypt",
        "test_crypto.py",
        "tests",
        "encrypt_decrypt_fields",
        "alpden550@encrypt-decrypt-fields__a0029320__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "encrypt_decrypt_fields/tests/test_django_field.py::TestDjangoEncryptField::test_passed_empty_value",
      "lineno": 14,
      "outcome": "passed",
      "keywords": [
        "test_passed_empty_value",
        "TestDjangoEncryptField",
        "test_django_field.py",
        "tests",
        "encrypt_decrypt_fields",
        "alpden550@encrypt-decrypt-fields__a0029320__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "encrypt_decrypt_fields/tests/test_django_field.py::TestDjangoEncryptField::test_passed_byte_value",
      "lineno": 20,
      "outcome": "passed",
      "keywords": [
        "test_passed_byte_value",
        "TestDjangoEncryptField",
        "test_django_field.py",
        "tests",
        "encrypt_decrypt_fields",
        "alpden550@encrypt-decrypt-fields__a0029320__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "encrypt_decrypt_fields/tests/test_django_field.py::TestDjangoEncryptField::test_passed_memoryview_value",
      "lineno": 26,
      "outcome": "passed",
      "keywords": [
        "test_passed_memoryview_value",
        "TestDjangoEncryptField",
        "test_django_field.py",
        "tests",
        "encrypt_decrypt_fields",
        "alpden550@encrypt-decrypt-fields__a0029320__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "encrypt_decrypt_fields/tests/test_django_field.py::TestDjangoEncryptField::test_passed_string_value",
      "lineno": 32,
      "outcome": "failed",
      "keywords": [
        "test_passed_string_value",
        "TestDjangoEncryptField",
        "test_django_field.py",
        "tests",
        "encrypt_decrypt_fields",
        "alpden550@encrypt-decrypt-fields__a0029320__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\alpden550@encrypt-decrypt-fields__a0029320__cryptography__pycryptodome\\.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_gcm.py",
          "lineno": 508,
          "message": "ValueError: MAC check failed"
        },
        "traceback": [
          {
            "path": "encrypt_decrypt_fields\\tests\\test_django_field.py",
            "lineno": 41,
            "message": ""
          },
          {
            "path": "encrypt_decrypt_fields\\services\\crypto.py",
            "lineno": 43,
            "message": "in decrypt_token"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_gcm.py",
            "lineno": 567,
            "message": "in decrypt_and_verify"
          },
          {
            "path": ".venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_gcm.py",
            "lineno": 508,
            "message": "ValueError"
          }
        ],
        "longrepr": "self = <encrypt_decrypt_fields.tests.test_django_field.TestDjangoEncryptField object at 0x0000014B6745E6F0>\nconnection = <Mock id='1423366813312'>\n\n    def test_passed_string_value(self, connection):\n        connection.Database.Binary.return_value = (\n            b\"gAAAAABg1vz2rLbNvztnC8p2hQbBGzrnyuGN772bEY5\" b\"w9c1s6fVmqZm4bkjJPfr2PAWZZ3twsLcajxK5y6g-KpjjeMO5luh0fg==\"\n        )\n        value = self.FIELD.get_db_prep_value(\"password\", connection)\n    \n        connection.Database.Binary.assert_called_once()\n        assert not isinstance(value, str)\n>       assert Crypto(\"secret\").decrypt_token(value) == \"password\"\n\nencrypt_decrypt_fields\\tests\\test_django_field.py:41: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\nencrypt_decrypt_fields\\services\\crypto.py:43: in decrypt_token\n    return cipher.decrypt_and_verify(ciphertext, tag).decode()\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_gcm.py:567: in decrypt_and_verify\n    self.verify(received_mac_tag)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <Crypto.Cipher._mode_gcm.GcmMode object at 0x0000014B674F8350>\nreceived_mac_tag = b'\\xbf;g\\x0b\\xcav\\x85\\x06\\xc1\\x1b:\\xe7\\xca\\xe1\\x8d\\xef'\n\n    def verify(self, received_mac_tag):\n        \"\"\"Validate the *binary* MAC tag.\n    \n        The caller invokes this function at the very end.\n    \n        This method checks if the decrypted message is indeed valid\n        (that is, if the key is correct) and it has not been\n        tampered with while in transit.\n    \n        :Parameters:\n          received_mac_tag : bytes/bytearray/memoryview\n            This is the *binary* MAC, as received from the sender.\n        :Raises ValueError:\n            if the MAC does not match. The message has been tampered with\n            or the key is incorrect.\n        \"\"\"\n    \n        if \"verify\" not in self._next:\n            raise TypeError(\"verify() cannot be called\"\n                            \" when encrypting a message\")\n        self._next = [\"verify\"]\n    \n        secret = get_random_bytes(16)\n    \n        mac1 = BLAKE2s.new(digest_bits=160, key=secret,\n                           data=self._compute_mac())\n        mac2 = BLAKE2s.new(digest_bits=160, key=secret,\n                           data=received_mac_tag)\n    \n        if mac1.digest() != mac2.digest():\n>           raise ValueError(\"MAC check failed\")\nE           ValueError: MAC check failed\n\n.venv\\Lib\\site-packages\\Crypto\\Cipher\\_mode_gcm.py:508: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "encrypt_decrypt_fields/tests/test_django_field.py::TestDjangoEncryptField::test_passed_any_value[1-int]",
      "lineno": 42,
      "outcome": "passed",
      "keywords": [
        "test_passed_any_value[1-int]",
        "parametrize",
        "pytestmark",
        "1-int",
        "TestDjangoEncryptField",
        "test_django_field.py",
        "tests",
        "encrypt_decrypt_fields",
        "alpden550@encrypt-decrypt-fields__a0029320__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "encrypt_decrypt_fields/tests/test_django_field.py::TestDjangoEncryptField::test_passed_any_value[passed1-dict]",
      "lineno": 42,
      "outcome": "passed",
      "keywords": [
        "test_passed_any_value[passed1-dict]",
        "parametrize",
        "pytestmark",
        "passed1-dict",
        "TestDjangoEncryptField",
        "test_django_field.py",
        "tests",
        "encrypt_decrypt_fields",
        "alpden550@encrypt-decrypt-fields__a0029320__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "encrypt_decrypt_fields/tests/test_django_field.py::TestDjangoEncryptField::test_passed_any_value[passed2-list]",
      "lineno": 42,
      "outcome": "passed",
      "keywords": [
        "test_passed_any_value[passed2-list]",
        "parametrize",
        "pytestmark",
        "passed2-list",
        "TestDjangoEncryptField",
        "test_django_field.py",
        "tests",
        "encrypt_decrypt_fields",
        "alpden550@encrypt-decrypt-fields__a0029320__cryptography__pycryptodome",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "passed"
      },
      "teardown": {
        "outcome": "passed"
      }
    }
  ]
}
{
  "exitcode": 1,
  "summary": {
    "failed": 5,
    "total": 5,
    "collected": 5
  },
  "collectors": [
    {
      "nodeid": "",
      "outcome": "passed",
      "result": [
        {
          "nodeid": ".",
          "type": "Dir"
        }
      ]
    },
    {
      "nodeid": "docs/_static",
      "outcome": "passed",
      "result": []
    },
    {
      "nodeid": "docs/stubs",
      "outcome": "passed",
      "result": []
    },
    {
      "nodeid": "docs/tutorials",
      "outcome": "passed",
      "result": []
    },
    {
      "nodeid": "docs",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "docs/_static",
          "type": "Dir"
        },
        {
          "nodeid": "docs/stubs",
          "type": "Dir"
        },
        {
          "nodeid": "docs/tutorials",
          "type": "Dir"
        }
      ]
    },
    {
      "nodeid": "sen2nbar",
      "outcome": "passed",
      "result": []
    },
    {
      "nodeid": "sen2nbar.egg-info",
      "outcome": "passed",
      "result": []
    },
    {
      "nodeid": "tests/test_sen2nbar.py::Test",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "tests/test_sen2nbar.py::Test::test_cubo",
          "type": "TestCaseFunction",
          "lineno": 49
        },
        {
          "nodeid": "tests/test_sen2nbar.py::Test::test_cubo_not_all_angles",
          "type": "TestCaseFunction",
          "lineno": 65
        },
        {
          "nodeid": "tests/test_sen2nbar.py::Test::test_cubo_not_all_angles_duplicated_indices",
          "type": "TestCaseFunction",
          "lineno": 81
        },
        {
          "nodeid": "tests/test_sen2nbar.py::Test::test_stac_c_factor_reprojection",
          "type": "TestCaseFunction",
          "lineno": 97
        },
        {
          "nodeid": "tests/test_sen2nbar.py::Test::test_stackstac",
          "type": "TestCaseFunction",
          "lineno": 14
        }
      ]
    },
    {
      "nodeid": "tests/test_sen2nbar.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "tests/test_sen2nbar.py::Test",
          "type": "UnitTestCase"
        }
      ]
    },
    {
      "nodeid": "tests",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "tests/test_sen2nbar.py",
          "type": "Module"
        }
      ]
    },
    {
      "nodeid": ".",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "docs",
          "type": "Dir"
        },
        {
          "nodeid": "sen2nbar",
          "type": "Package"
        },
        {
          "nodeid": "sen2nbar.egg-info",
          "type": "Dir"
        },
        {
          "nodeid": "tests",
          "type": "Dir"
        }
      ]
    }
  ],
  "tests": [
    {
      "nodeid": "tests/test_sen2nbar.py::Test::test_cubo",
      "lineno": 49,
      "outcome": "failed",
      "keywords": [
        "test_cubo",
        "Test",
        "test_sen2nbar.py",
        "tests",
        "esds-leipzig@sen2nbar__1ecded1e__requests__pycurl",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\esds-leipzig@sen2nbar__1ecded1e__requests__pycurl\\sen2nbar\\c_factor.py",
          "lineno": 95,
          "message": "KeyError: 'proj:epsg'"
        },
        "traceback": [
          {
            "path": "tests\\test_sen2nbar.py",
            "lineno": 52,
            "message": ""
          },
          {
            "path": "sen2nbar\\nbar.py",
            "lineno": 289,
            "message": "in nbar_cubo"
          },
          {
            "path": "sen2nbar\\nbar.py",
            "lineno": 176,
            "message": "in nbar_stac"
          },
          {
            "path": "sen2nbar\\c_factor.py",
            "lineno": 95,
            "message": "KeyError"
          }
        ],
        "stderr": "\rProcessing items: 0it [00:00, ?it/s]\r                                    \r",
        "longrepr": "self = <test_sen2nbar.Test testMethod=test_cubo>\n\n    def test_cubo(self):\n        \"\"\"Test the nbar_cubo\"\"\"\n>       da = nbar_cubo(\n            cubo.create(\n                lat=50,\n                lon=10,\n                collection=\"sentinel-2-l2a\",\n                bands=[\"B02\", \"B03\", \"B04\"],\n                start_date=\"2021-06-01\",\n                end_date=\"2021-06-10\",\n                edge_size=32,\n                resolution=10,\n            )\n        )\n\ntests\\test_sen2nbar.py:52: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\nsen2nbar\\nbar.py:289: in nbar_cubo\n    da = nbar_stac(da, stac, collection, epsg, quiet)\nsen2nbar\\nbar.py:176: in nbar_stac\n    c = c_factor_from_item(item, epsg)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nitem = <Item id=S2A_MSIL2A_20210605T102021_R065_T32UNA_20210606T150833>\nto_epsg = 'epsg:32632'\n\n    def c_factor_from_item(item: pystac.item.Item, to_epsg: str) -> xr.DataArray:\n        \"\"\"Gets the c-factor per band from a Sentinel-2 :code:`pystac.Item`.\n    \n        Parameters\n        ----------\n        item : pystac.item.Item\n            Item to get the c-factor from.\n        to_epsg : str\n            EPSG code to reproject the c-factor to (e.g. \"epsg:3115\")\n    \n        Returns\n        -------\n        xarray.DataArray\n            c-factor.\n        \"\"\"\n        # Retrieve the EPSG from the item\n>       SOURCE_EPSG = item.properties[\"proj:epsg\"]\nE       KeyError: 'proj:epsg'\n\nsen2nbar\\c_factor.py:95: KeyError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_sen2nbar.py::Test::test_cubo_not_all_angles",
      "lineno": 65,
      "outcome": "failed",
      "keywords": [
        "test_cubo_not_all_angles",
        "Test",
        "test_sen2nbar.py",
        "tests",
        "esds-leipzig@sen2nbar__1ecded1e__requests__pycurl",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\esds-leipzig@sen2nbar__1ecded1e__requests__pycurl\\sen2nbar\\c_factor.py",
          "lineno": 95,
          "message": "KeyError: 'proj:epsg'"
        },
        "traceback": [
          {
            "path": "tests\\test_sen2nbar.py",
            "lineno": 68,
            "message": ""
          },
          {
            "path": "sen2nbar\\nbar.py",
            "lineno": 289,
            "message": "in nbar_cubo"
          },
          {
            "path": "sen2nbar\\nbar.py",
            "lineno": 176,
            "message": "in nbar_stac"
          },
          {
            "path": "sen2nbar\\c_factor.py",
            "lineno": 95,
            "message": "KeyError"
          }
        ],
        "stderr": "\rProcessing items: 0it [00:00, ?it/s]\r                                    \r",
        "longrepr": "self = <test_sen2nbar.Test testMethod=test_cubo_not_all_angles>\n\n    def test_cubo_not_all_angles(self):\n        \"\"\"Test the nbar_cubo\"\"\"\n>       da = nbar_cubo(\n            cubo.create(\n                lat=64.25611,\n                lon=19.7745,\n                collection=\"sentinel-2-l2a\",\n                bands=[\"B02\", \"B03\", \"B04\"],\n                start_date=\"2016-01-01\",\n                end_date=\"2016-03-01\",\n                edge_size=512,\n                resolution=10,\n            )\n        )\n\ntests\\test_sen2nbar.py:68: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\nsen2nbar\\nbar.py:289: in nbar_cubo\n    da = nbar_stac(da, stac, collection, epsg, quiet)\nsen2nbar\\nbar.py:176: in nbar_stac\n    c = c_factor_from_item(item, epsg)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nitem = <Item id=S2A_MSIL2A_20160130T101252_R022_T34WDS_20210528T002504>\nto_epsg = 'epsg:32634'\n\n    def c_factor_from_item(item: pystac.item.Item, to_epsg: str) -> xr.DataArray:\n        \"\"\"Gets the c-factor per band from a Sentinel-2 :code:`pystac.Item`.\n    \n        Parameters\n        ----------\n        item : pystac.item.Item\n            Item to get the c-factor from.\n        to_epsg : str\n            EPSG code to reproject the c-factor to (e.g. \"epsg:3115\")\n    \n        Returns\n        -------\n        xarray.DataArray\n            c-factor.\n        \"\"\"\n        # Retrieve the EPSG from the item\n>       SOURCE_EPSG = item.properties[\"proj:epsg\"]\nE       KeyError: 'proj:epsg'\n\nsen2nbar\\c_factor.py:95: KeyError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_sen2nbar.py::Test::test_cubo_not_all_angles_duplicated_indices",
      "lineno": 81,
      "outcome": "failed",
      "keywords": [
        "test_cubo_not_all_angles_duplicated_indices",
        "Test",
        "test_sen2nbar.py",
        "tests",
        "esds-leipzig@sen2nbar__1ecded1e__requests__pycurl",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\esds-leipzig@sen2nbar__1ecded1e__requests__pycurl\\sen2nbar\\c_factor.py",
          "lineno": 95,
          "message": "KeyError: 'proj:epsg'"
        },
        "traceback": [
          {
            "path": "tests\\test_sen2nbar.py",
            "lineno": 84,
            "message": ""
          },
          {
            "path": "sen2nbar\\nbar.py",
            "lineno": 289,
            "message": "in nbar_cubo"
          },
          {
            "path": "sen2nbar\\nbar.py",
            "lineno": 176,
            "message": "in nbar_stac"
          },
          {
            "path": "sen2nbar\\c_factor.py",
            "lineno": 95,
            "message": "KeyError"
          }
        ],
        "stderr": "\rProcessing items: 0it [00:00, ?it/s]\r                                    \r",
        "longrepr": "self = <test_sen2nbar.Test testMethod=test_cubo_not_all_angles_duplicated_indices>\n\n    def test_cubo_not_all_angles_duplicated_indices(self):\n        \"\"\"Test the nbar_cubo\"\"\"\n>       da = nbar_cubo(\n            cubo.create(\n                lat=51.079225,\n                lon=10.452173,\n                collection=\"sentinel-2-l2a\",\n                bands=[\"B02\", \"B03\", \"B04\"],\n                start_date=\"2016-01-01\",\n                end_date=\"2016-03-01\",\n                edge_size=512,\n                resolution=10,\n            )\n        )\n\ntests\\test_sen2nbar.py:84: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\nsen2nbar\\nbar.py:289: in nbar_cubo\n    da = nbar_stac(da, stac, collection, epsg, quiet)\nsen2nbar\\nbar.py:176: in nbar_stac\n    c = c_factor_from_item(item, epsg)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nitem = <Item id=S2A_MSIL2A_20160103T102432_R065_T32UPB_20210527T071833>\nto_epsg = 'epsg:32632'\n\n    def c_factor_from_item(item: pystac.item.Item, to_epsg: str) -> xr.DataArray:\n        \"\"\"Gets the c-factor per band from a Sentinel-2 :code:`pystac.Item`.\n    \n        Parameters\n        ----------\n        item : pystac.item.Item\n            Item to get the c-factor from.\n        to_epsg : str\n            EPSG code to reproject the c-factor to (e.g. \"epsg:3115\")\n    \n        Returns\n        -------\n        xarray.DataArray\n            c-factor.\n        \"\"\"\n        # Retrieve the EPSG from the item\n>       SOURCE_EPSG = item.properties[\"proj:epsg\"]\nE       KeyError: 'proj:epsg'\n\nsen2nbar\\c_factor.py:95: KeyError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_sen2nbar.py::Test::test_stac_c_factor_reprojection",
      "lineno": 97,
      "outcome": "failed",
      "keywords": [
        "test_stac_c_factor_reprojection",
        "Test",
        "test_sen2nbar.py",
        "tests",
        "esds-leipzig@sen2nbar__1ecded1e__requests__pycurl",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\esds-leipzig@sen2nbar__1ecded1e__requests__pycurl\\sen2nbar\\c_factor.py",
          "lineno": 95,
          "message": "KeyError: 'proj:epsg'"
        },
        "traceback": [
          {
            "path": "tests\\test_sen2nbar.py",
            "lineno": 100,
            "message": ""
          },
          {
            "path": "sen2nbar\\nbar.py",
            "lineno": 289,
            "message": "in nbar_cubo"
          },
          {
            "path": "sen2nbar\\nbar.py",
            "lineno": 176,
            "message": "in nbar_stac"
          },
          {
            "path": "sen2nbar\\c_factor.py",
            "lineno": 95,
            "message": "KeyError"
          }
        ],
        "stderr": "\rProcessing items: 0it [00:00, ?it/s]\r                                    \r",
        "longrepr": "self = <test_sen2nbar.Test testMethod=test_stac_c_factor_reprojection>\n\n    def test_stac_c_factor_reprojection(self):\n        \"\"\"Test the nbar_cubo when items have different epsg\"\"\"\n>       da = nbar_cubo(\n            cubo.create(\n                lat=60.64183,\n                lon=23.95952,\n                collection=\"sentinel-2-l2a\",\n                bands=[\"B04\", \"B03\", \"B02\"],\n                start_date=f\"2016-01-01\",\n                end_date=f\"2016-03-31\",\n                edge_size=512,\n                resolution=10,\n            )\n        )\n\ntests\\test_sen2nbar.py:100: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\nsen2nbar\\nbar.py:289: in nbar_cubo\n    da = nbar_stac(da, stac, collection, epsg, quiet)\nsen2nbar\\nbar.py:176: in nbar_stac\n    c = c_factor_from_item(item, epsg)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nitem = <Item id=S2A_MSIL2A_20160121T094312_R036_T35VLH_20210527T211030>\nto_epsg = 'epsg:32634'\n\n    def c_factor_from_item(item: pystac.item.Item, to_epsg: str) -> xr.DataArray:\n        \"\"\"Gets the c-factor per band from a Sentinel-2 :code:`pystac.Item`.\n    \n        Parameters\n        ----------\n        item : pystac.item.Item\n            Item to get the c-factor from.\n        to_epsg : str\n            EPSG code to reproject the c-factor to (e.g. \"epsg:3115\")\n    \n        Returns\n        -------\n        xarray.DataArray\n            c-factor.\n        \"\"\"\n        # Retrieve the EPSG from the item\n>       SOURCE_EPSG = item.properties[\"proj:epsg\"]\nE       KeyError: 'proj:epsg'\n\nsen2nbar\\c_factor.py:95: KeyError"
      },
      "teardown": {
        "outcome": "passed"
      }
    },
    {
      "nodeid": "tests/test_sen2nbar.py::Test::test_stackstac",
      "lineno": 14,
      "outcome": "failed",
      "keywords": [
        "test_stackstac",
        "Test",
        "test_sen2nbar.py",
        "tests",
        "esds-leipzig@sen2nbar__1ecded1e__requests__pycurl",
        ""
      ],
      "setup": {
        "outcome": "passed"
      },
      "call": {
        "outcome": "failed",
        "crash": {
          "path": "D:\\repos\\esds-leipzig@sen2nbar__1ecded1e__requests__pycurl\\.venv\\Lib\\site-packages\\stackstac\\prepare.py",
          "lineno": 190,
          "message": "ValueError: Cannot pick a common CRS, since asset 'B05' of item 0 'S2A_MSIL2A_20190607T213531_R086_T06VVN_20201005T231445' does not have one.\n\nPlease specify a CRS with the `epsg=` argument."
        },
        "traceback": [
          {
            "path": "tests\\test_sen2nbar.py",
            "lineno": 43,
            "message": ""
          },
          {
            "path": ".venv\\Lib\\site-packages\\stackstac\\stack.py",
            "lineno": 290,
            "message": "in stack"
          },
          {
            "path": ".venv\\Lib\\site-packages\\stackstac\\prepare.py",
            "lineno": 190,
            "message": "ValueError"
          }
        ],
        "longrepr": "self = <test_sen2nbar.Test testMethod=test_stackstac>\n\n    def test_stackstac(self):\n        \"\"\"Test the nbar_stackstac with Planetary Computer\"\"\"\n        endpoint = \"https://planetarycomputer.microsoft.com/api/stac/v1\"\n        collection = \"sentinel-2-l2a\"\n        bounds = (-148.565368, 60.800723, -147.443389, 61.183638)\n    \n        catalog = pystac_client.Client.open(endpoint, modifier=pc.sign_inplace)\n    \n        area_of_interest = {\n            \"type\": \"Polygon\",\n            \"coordinates\": [\n                [\n                    [bounds[0], bounds[1]],\n                    [bounds[2], bounds[1]],\n                    [bounds[2], bounds[3]],\n                    [bounds[0], bounds[3]],\n                    [bounds[0], bounds[1]],\n                ]\n            ],\n        }\n    \n        items = catalog.search(\n            collections=[collection],\n            intersects=area_of_interest,\n            datetime=\"2019-06-01/2019-08-01\",\n            query={\"eo:cloud_cover\": {\"lt\": 10}},\n        ).get_all_items()\n    \n>       stack = stackstac.stack(\n            items, assets=[\"B05\", \"B06\", \"B07\"], bounds_latlon=bounds, resolution=20\n        )\n\ntests\\test_sen2nbar.py:43: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n.venv\\Lib\\site-packages\\stackstac\\stack.py:290: in stack\n    asset_table, spec, asset_ids, plain_items = prepare_items(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nitems = [{'assets': {'AOT': {'gsd': 10.0, 'href': 'https://sentinel2l2a01.blob.core.windows.net/sentinel2-l2/06/V/VN/2019/06/0...121331], [-148.51688, 60.9808236], [-148.63188, 60.8404682], [-148.74884, 60.7008454], ...]], 'type': 'Polygon'}, ...}]\nassets = ['B05', 'B06', 'B07'], epsg = None, resolution = (20, 20)\nbounds = None, bounds_latlon = (-148.565368, 60.800723, -147.443389, 61.183638)\nsnap_bounds = True, rescale = True, dtype = dtype('float64')\n\n    def prepare_items(\n        items: ItemSequence,\n        assets: Optional[Union[List[str], AbstractSet[str]]] = frozenset(\n            [\"image/tiff\", \"image/x.geotiff\", \"image/vnd.stac.geotiff\", \"image/jp2\"]\n        ),\n        epsg: Optional[int] = None,\n        resolution: Optional[Union[IntFloat, Resolutions]] = None,\n        bounds: Optional[Bbox] = None,\n        bounds_latlon: Optional[Bbox] = None,\n        snap_bounds: bool = True,\n        rescale: bool = True,\n        dtype: np.dtype = np.dtype(\"float64\"),\n    ) -> Tuple[np.ndarray, RasterSpec, List[str], ItemSequence]:\n        if bounds is not None and bounds_latlon is not None:\n            raise ValueError(\n                f\"Cannot give both `bounds` {bounds} and `bounds_latlon` {bounds_latlon}.\"\n            )\n    \n        out_epsg = epsg\n        out_bounds = bounds\n        if resolution is not None and not isinstance(resolution, tuple):\n            resolution = (resolution, resolution)\n        out_resolutions_xy = resolution\n    \n        if assets is None:\n            # use the keys from the item with the most assets (do this rather than a `set()` to preserve order)\n            asset_ids = list(max((item[\"assets\"] for item in items), key=len))\n        elif isinstance(assets, AbstractSet):\n            allowed_mimetypes = [Mimetype.from_str(t) for t in assets]\n            type_strs_by_id: dict[str, set[Optional[str]]] = collections.defaultdict(set)\n            for item in items:\n                for asset_id, asset in item[\"assets\"].items():\n                    type_strs_by_id[asset_id].add(asset.get(\"type\"))\n    \n            mimetypes_by_id = {\n                id: [Mimetype.from_str(t) for t in types if t is not None]\n                for id, types in type_strs_by_id.items()\n            }\n    \n            ids_without_type = [\n                id for id, mimetypes in mimetypes_by_id.items() if not mimetypes\n            ]\n            if ids_without_type:\n                warnings.warn(\n                    f\"You're filtering for assets that match the mimetype(s) {assets}, but since {len(ids_without_type)} \"\n                    f\"(out of {len(type_strs_by_id)}) asset(s) have no `type` specified on any item, those will be \"\n                    \"dropped. Consider passing a list of asset IDs instead to the `assets=` parameter.\\n\"\n                    f\"Assets with no type: {ids_without_type}\",\n                )\n    \n            asset_ids = [\n                asset_id\n                for asset_id, asset_mimetypes in mimetypes_by_id.items()\n                if asset_mimetypes\n                and all(\n                    any(\n                        asset_mt.is_valid_for(allowed_mt)\n                        for allowed_mt in allowed_mimetypes\n                    )\n                    for asset_mt in asset_mimetypes\n                )\n            ]\n        else:\n            asset_ids = assets\n    \n        asset_table = np.full((len(items), len(asset_ids)), None, dtype=ASSET_TABLE_DT)\n    \n        # TODO support item-assets https://github.com/radiantearth/stac-spec/tree/master/extensions/item-assets\n    \n        if len(items) == 0:\n            raise ValueError(\"No items\")\n        if len(asset_ids) == 0:\n            raise ValueError(\"Zero asset IDs requested\")\n    \n        for item_i, item in enumerate(items):\n            item_epsg = item[\"properties\"].get(\"proj:epsg\")\n            item_bbox = item[\"properties\"].get(\"proj:bbox\")\n            item_shape = item[\"properties\"].get(\"proj:shape\")\n            item_transform = item[\"properties\"].get(\"proj:transform\")\n    \n            item_bbox_proj = None\n            for asset_i, id in enumerate(asset_ids):\n                try:\n                    asset = item[\"assets\"][id]\n                except KeyError:\n                    continue\n    \n                asset_epsg = asset.get(\"proj:epsg\", item_epsg)\n                asset_bbox = asset.get(\"proj:bbox\", item_bbox)\n                asset_shape = asset.get(\"proj:shape\", item_shape)\n                asset_transform = asset.get(\"proj:transform\", item_transform)\n                raster_bands = asset.get(\"raster:bands\")\n    \n                if raster_bands is not None:\n                    if len(raster_bands) != 1:\n                        raise ValueError(\n                            f\"raster:bands has {len(raster_bands)} elements for asset {id!r}. \"\n                            \"Multi-band rasters are not currently supported.\\n\"\n                            \"If you don't care about this asset, you can skip it by giving a list \"\n                            \"of asset IDs you *do* want in `assets=`, and leaving this one out.\"\n                        )\n                    asset_scale = raster_bands[0].get(\"scale\", 1)\n                    asset_offset = raster_bands[0].get(\"offset\", 0)\n                else:\n                    asset_scale = 1\n                    asset_offset = 0\n    \n                if rescale:\n                    if not np.can_cast(type(asset_scale), dtype):\n                        raise ValueError(\n                            f\"`rescale=True`, but safe casting cannot be completed between \"\n                            f\"asset scale value {asset_scale} and output dtype {dtype}.\\n\"\n                            f\"To continue using `{dtype=}`, pass `rescale=False` to retrieve \"\n                            \"data in its raw, unscaled values. Or, if you want rescaled \"\n                            \"values, pass a different `dtype=` (typically `float`).\"\n                        )\n    \n                    if not np.can_cast(type(asset_offset), dtype):\n                        raise ValueError(\n                            f\"`rescale=True`, but safe casting cannot be completed between \"\n                            f\"asset offset value {asset_offset} and output dtype {dtype}.\\n\"\n                            f\"To continue using `{dtype=}`, pass `rescale=False` to retrieve \"\n                            \"data in its raw, unscaled values. Or, if you want rescaled \"\n                            \"values, pass a different `dtype=` (typically `float`).\"\n                        )\n    \n                asset_affine = None\n    \n                # Auto-compute CRS\n                if epsg is None:\n                    if asset_epsg is None:\n>                       raise ValueError(\n                            f\"Cannot pick a common CRS, since asset {id!r} of item \"\n                            f\"{item_i} {item['id']!r} does not have one.\\n\\n\"\n                            \"Please specify a CRS with the `epsg=` argument.\"\n                        )\nE                       ValueError: Cannot pick a common CRS, since asset 'B05' of item 0 'S2A_MSIL2A_20190607T213531_R086_T06VVN_20201005T231445' does not have one.\nE                       \nE                       Please specify a CRS with the `epsg=` argument.\n\n.venv\\Lib\\site-packages\\stackstac\\prepare.py:190: ValueError"
      },
      "teardown": {
        "outcome": "passed"
      }
    }
  ],
  "warnings": [
    {
      "message": "Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/",
      "category": "PydanticDeprecatedSince20",
      "when": "collect",
      "filename": "D:\\repos\\esds-leipzig@sen2nbar__1ecded1e__requests__pycurl\\.venv\\Lib\\site-packages\\pydantic\\_internal\\_config.py",
      "lineno": 323
    },
    {
      "message": "get_all_items() is deprecated, use item_collection() instead.",
      "category": "FutureWarning",
      "when": "runtest",
      "filename": "D:\\repos\\esds-leipzig@sen2nbar__1ecded1e__requests__pycurl\\.venv\\Lib\\site-packages\\pystac_client\\item_search.py",
      "lineno": 896
    }
  ]
}